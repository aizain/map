// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.18/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/unitBezier":function(){define([],function(){var l=function(a,b,c,d){function e(a,b){var c,d,e,k;b=null==b?1E-6:b;e=a;for(d=0;8>d;d++){k=((m*e+h)*e+g)*e-a;if(Math.abs(k)<b)return e;c=(3*m*e+2*h)*e+g;if(1E-6>Math.abs(c))break;e-=k/c}c=0;d=1;e=a;if(e<c)return c;if(e>d)return d;for(;c<d;){k=((m*e+h)*e+g)*e;if(Math.abs(k-a)<b)break;a>k?c=e:d=e;e=0.5*(d-c)+c}return e}var g=3*a,h=3*(c-a)-g,m=1-g-h,k=3*b,n=3*(d-b)-k,p=1-k-n;return function(a,b){var c=e(a,b);return((p*c+n)*c+k)*
c}},f=/^cubic-bezier\((.*)\)/;l.parse=function(a){var b=l[a]||null;if(!b&&(a=f.exec(a)))a=a[1].split(",").map(function(a){return parseFloat(a.trim())}),4===a.length&&!a.some(function(a){return isNaN(a)})&&(b=l.apply(l,a));return b};l.ease=l(0.25,0.1,0.25,1);l.linear=l(0,0,1,1);l.easeIn=l["ease-in"]=l(0.42,0,1,1);l.easeOut=l["ease-out"]=l(0,0,0.58,1);l.easeInOut=l["ease-in-out"]=l(0.42,0,0.58,1);return l})},"esri/layers/vectorTiles/request":function(){define(["require","exports","esri/request","dojo/_base/lang"],
function(l,f,a,b){return function(c,d){var e=b.mixin({},{url:c,failOk:!0},d);"array-buffer"===d.responseType?(e.handleAs="arraybuffer",delete e.responseType):d.responseType&&(e.handleAs=d.responseType,delete e.responseType);null!==d.query&&(e.content=e.query,delete e.query);return a(e).then(function(a){return{data:a}})}})},"esri/layers/vectorTiles/core/promiseUtils":function(){define(["require","exports","dojo/Deferred","./Error"],function(l,f,a,b){f.eachAlways=function(b){var d=new a,e=[],g=b.length;
0===g&&d.resolve(e);b.forEach(function(a){var b={promise:a};e.push(b);a.then(function(a){b.value=a}).otherwise(function(a){b.error=a}).then(function(){--g;0===g&&d.resolve(e)})});return d.promise};f.create=function(b){var d=new a;b(function(a){void 0===a&&(a=null);return d.resolve(a)},d.reject);return d.promise};f.reject=function(b){var d=new a;d.reject(b);return d.promise};f.resolve=function(b){void 0===b&&(b=null);var d=new a;d.resolve(b);return d.promise};f.after=function(b,d){void 0===d&&(d=null);
var e=0,g=new a(function(){e&&(clearTimeout(e),e=0)}),e=setTimeout(function(){g.resolve(d)},b);return g.promise};f.timeout=function(c,d,e){var g=0,h=new a(c.cancel);c.then(function(a){h.isFulfilled()||(h.resolve(a),g&&(clearTimeout(g),g=0))});c.otherwise(function(a){h.isFulfilled()||(h.reject(a),g&&(clearTimeout(g),g=0))});g=setTimeout(function(){var a=e||new b("promiseUtils:timeout","The wrapped promise did not resolve within "+d+" ms");h.reject(a)},d);return h.promise}})},"esri/layers/vectorTiles/core/Error":function(){define(["require",
"exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","./Message"],function(l,f,a,b,c){l=function(b){function c(){b.apply(this,arguments)}a(c,b);return c}(c);l.prototype.type="error";return l})},"esri/layers/vectorTiles/core/tsSupport/extendsHelper":function(){define([],function(){return function(l,f){function a(){this.constructor=l}for(var b in f)f.hasOwnProperty(b)&&(l[b]=f[b]);l.prototype=null===f?Object.create(f):(a.prototype=f.prototype,new a)}})},"esri/layers/vectorTiles/core/tsSupport/decorateHelper":function(){define([],
function(){return function(l,f,a,b){var c=arguments.length,d=3>c?f:null===b?b=Object.getOwnPropertyDescriptor(f,a):b,e;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)d=Reflect.decorate(l,f,a,b);else for(var g=l.length-1;0<=g;g--)if(e=l[g])d=(3>c?e(d):3<c?e(f,a,d):e(f,a))||d;return 3<c&&d&&Object.defineProperty(f,a,d),d}})},"esri/layers/vectorTiles/core/Message":function(){define(["require","exports","./tsSupport/extendsHelper","./tsSupport/decorateHelper","dojo/string"],function(l,
f,a,b,c){return function(){function a(b,d,h){this.name=b;this.message=d&&c.substitute(d,h,function(a){return null==a?"":a})||"";this.details=h}a.prototype.toString=function(){return"["+this.name+"]: "+this.message};return a}()})},"esri/layers/vectorTiles/core/urlUtils":function(){define(["require","exports","esri/urlUtils","dojo/_base/url"],function(l,f,a,b){function c(a){return a&&"/"===a[0]&&"/"===a[1]||m.test(a)}function d(a){if("string"===typeof a)return new b(e(a));a.scheme||(a.scheme=f.appUrl.scheme);
return a}function e(a,b){void 0===b&&(b=f.appBaseUrl);if(a&&"/"===a[0]&&"/"===a[1])return"file"===f.appUrl.scheme?"https:"+a:f.appUrl.scheme+":"+a;if(m.test(a))return a;var c=g,d;if("/"===a[0]){d=b;var e=d.indexOf("//"),e=d.indexOf("/",e+2);d=-1===e?d:d.slice(0,e)}else d=b;return c(d,a)}function g(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];if(a&&a.length){b=[];if(c(a[0])){var d=a[0],e=d.indexOf("//");b.push(d.slice(0,e+1));h.test(a[0])&&(b[0]+="/");a[0]=d.slice(e+2)}else"/"===a[0][0]&&
b.push("");a=a.reduce(function(a,b){return a.concat(b.split("/"))},[]);for(d=0;d<a.length;d++)e=a[d],".."===e&&0<b.length?b.pop():e&&("."!==e||0===b.length)&&b.push(e);return b.join("/")}}f.normalize=function(b){return a.normalize(b)};l=Function("return this")();f.appUrl=new b(l.location);f.appBaseUrl=function(){var a=f.appUrl.path,a=a.substring(0,a.lastIndexOf(a.split("/")[a.split("/").length-1]));return""+(f.appUrl.scheme+"://"+f.appUrl.host+(null!=f.appUrl.port?":"+f.appUrl.port:""))+a}();var h=
/^\s*file:/i,m=/^\s*[a-z][a-z0-9-+.]*:[^0-9]/i;f.isAbsolute=c;f.urlToObject=function(b){return a.urlToObject(b)};f.makeAbsolute=e;f.hasSameOrigin=function(a,b,c){void 0===c&&(c=!1);a=d(a);b=d(b);return!c&&a.scheme!==b.scheme?!1:a.host.toLowerCase()===b.host.toLowerCase()&&a.port===b.port};f.join=g})},"esri/layers/vectorTiles/layers/support/vectorTileLayerLoader":function(){define("require exports dojo/has dojo/_base/lang ../../core/promiseUtils ../../core/urlUtils ../../request".split(" "),function(l,
f,a,b,c,d,e){function g(a,b,c){if(b.hasOwnProperty("tileInfo"))return a.layerDefinition=b,a.serviceUrl=c.path,h(a,b,c);c?-1!==c.path.indexOf("root.json")&&(c.path=c.path.substr(0,c.path.indexOf("root.json"))):(c=b.sprite,c=c.substr(0,c.indexOf("sprites/sprite"))+"styles/",a.url=d.normalize(c),c=a.parsedUrl=d.urlToObject(a.url));a.styleUrl=c.path;a.style=b;return m(a,b,c)}function h(a,b,c){if(p&&!b.hasOwnProperty("defaultStyles"))throw Error("Service definition must have 'defaultStyles' element!");
a.styleUrl=d.normalize(d.join(c.path,b.defaultStyles));return e(d.join(a.styleUrl,"root.json"),{callbackParamName:"callback",responseType:"json"}).then(function(b){return a.style=b.data})}function m(a,b,g){(b=k(b))||c.reject("Source isn't available in the syle object!");if(b.hasOwnProperty("url"))return a.serviceUrl=b.url,d.isAbsolute(a.serviceUrl)||(a.serviceUrl=d.join(g.path,a.serviceUrl)),e(a.serviceUrl,{query:{f:"json"},callbackParamName:"callback",responseType:"json"}).then(function(b){a.layerDefinition=
n(b.data);return a});a.layerDefinition=n(b);return c.resolve(a)}function k(a){if(!a.hasOwnProperty("sources"))return null;a=a.sources;var b=null;if(a.hasOwnProperty("esri"))b=a.esri;else{for(var c=0,d=Object.keys(a);c<d.length;c++){var e=d[c];if(-1!==e.toLocaleLowerCase().indexOf("street")&&"vector"===b.type){b=a[e];break}}if(!b){c=0;for(d=Object.keys(a);c<d.length&&!(e=d[c],b=a[e],"vector"===b.type);c++);}}return b}function n(a){a.hasOwnProperty("fullExtent");if(!a.hasOwnProperty("tileInfo")){for(var b=
this.fullExtent.width/512,c=[],d=a.hasOwnProperty("minzoom")?parseFloat(a.minzoom):0,e=a.hasOwnProperty("maxzoom")?parseFloat(a.maxzoom):16;d<e;d++){var g=b/Math.pow(2,d);c.push({level:d,scale:Math.floor(3779.527559055118*g),resolution:g})}a.tileInfo={rows:512,cols:512,dpi:96,format:"pbf",origin:{x:this.fullExtent.xmin,y:this.fullExtent.ymax,spatialReference:{wkid:102100}},lods:c,spatialReference:{wkid:102100}}}a.hasOwnProperty("capabilities")||(a.capabilities="TilesOnly");if(p&&!a.hasOwnProperty("tiles"))throw Error("Cannot find element tiles!");
return a}var p=a("dojo-debug-messages");f.loadMetadata=function(a){if(!a)return c.reject("invalid input URL!");if("string"!==typeof a){var h=k(a);h&&h.hasOwnProperty("url")&&(h=d.join(h.url,"/resources/styles"),a.hasOwnProperty("sprite")&&!d.isAbsolute(a.sprite)&&(a.sprite=d.join(h,a.sprite)),a.hasOwnProperty("glyphs")&&!d.isAbsolute(a.glyphs)&&(a.glyphs=d.join(h,a.glyphs)))}var m={layerDefinition:null,parsedUrl:null,serviceUrl:null,style:null,styleUrl:null,url:null};if("string"===typeof a){a=m.url=
d.normalize(a);var n=m.parsedUrl=d.urlToObject(a);return e(n.path,{callbackParamName:"callback",responseType:"json",query:b.mixin({f:"json"},n.query)}).then(function(a){return g(m,a.data,n)}).then(function(){return m})}return g(m,a,null).then(function(){return m})}})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleRepository":function(){define(["require","exports","../../../core/urlUtils","./StyleLayer"],function(l,f,a,b){return function(){function c(b,e){void 0===e&&(e="");this.styleJSON=
b;this.version=parseFloat(b.version);this.sprite=b.sprite;a.isAbsolute(this.sprite)||(this.sprite=a.join(e,this.sprite));this.glyphs=b.glyphs;a.isAbsolute(this.glyphs)||(this.glyphs=a.join(e,this.glyphs));this.layers=(b.layers||[]).map(c._create);this._identifyRefLayers()}c.prototype._identifyRefLayers=function(){for(var a=[],b=[],c=0,h=this.layers;c<h.length;c++){var m=h[c];if(1===m.type){var k=m.sourceLayer,k=k+("|"+JSON.stringify(m.minzoom)),k=k+("|"+JSON.stringify(m.maxzoom)),k=k+("|"+JSON.stringify(m.filter));
a.push({key:k,layer:m})}2===m.type&&(k=m.sourceLayer,k+="|"+JSON.stringify(m.minzoom),k+="|"+JSON.stringify(m.maxzoom),k+="|"+JSON.stringify(m.filter),k+="|"+JSON.stringify(m.layout["line-cap"]),k+="|"+JSON.stringify(m.layout["line-join"]),b.push({key:k,layer:m}))}this._assignRefLayers(a);this._assignRefLayers(b)};c.prototype._assignRefLayers=function(a){a.sort(function(a,b){return a.key<b.key?-1:a.key>b.key?1:0});for(var b,c,h=a.length,m=0;m<h;m++){var k=a[m];if(k.key===b)k.layer.refLayerId=c;else if(b=
k.key,c=k.layer.id,1===k.layer.type&&!k.layer.hasPaintProperty("fill-outline-color"))for(var n=m+1;n<h;n++){var p=a[n];if(p.key===b){if(p.layer.hasPaintProperty("fill-outline-color")){a[m]=p;a[n]=k;c=p.layer.id;break}}else break}}};c._create=function(a,c,g){c=1-(1+c)*(1/(g.length+1));switch(a.type){case "background":return new b.StyleLayer(0,a,c);case "fill":return new b.StyleLayer(1,a,c);case "line":return new b.StyleLayer(2,a,c);case "symbol":return new b.StyleLayer(3,a,c);case "raster":throw Error("Unsupported vector tile raster layer");
case "circle":throw Error("Unsupported vector tile circle layer");}throw Error("Unknown vector tile layer");};return c}()})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleLayer":function(){define(["require","exports","./StyleDefinition","./StyleProperty","./Filter"],function(l,f,a,b,c){l=function(){function d(b,c,d){this.type=b;this.id=c.id;this.source=c.source;this.sourceLayer=c["source-layer"];this.minzoom=c.minzoom;this.maxzoom=c.maxzoom;this.filter=c.filter;this.layout=c.layout;this.paint=
c.paint;this.z=d;switch(b){case 0:this._layoutDefinition=a.StyleDefinition.backgroundLayoutDefinition;this._paintDefinition=a.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=a.StyleDefinition.fillLayoutDefinition;this._paintDefinition=a.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=a.StyleDefinition.lineLayoutDefinition;this._paintDefinition=a.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=a.StyleDefinition.symbolLayoutDefinition,
this._paintDefinition=a.StyleDefinition.symbolPaintDefinition}this._layoutProperties=this._parseLayout(this.layout);this._paintProperties=this._parsePaint(this.paint)}d.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=c.createFilter(this.filter)};d.prototype.hasLayoutProperty=function(a){var b=this._layoutProperties;return b&&b[a]?!0:!1};d.prototype.hasPaintProperty=function(a){var b=this._paintProperties;return b?void 0!==b[a]:!1};
d.prototype.getLayoutValue=function(a,b){var c,d=this._layoutProperties;d&&(d=d[a])&&(c=d.getValue(b));d=this._layoutDefinition[a];void 0===c&&(c=d["default"]);"enum"===d.type&&(c=d.values.indexOf(c));return c};d.prototype.getPaintValue=function(a,b){var c,d=this._paintProperties;d&&(d=d[a])&&(c=d.getValue(b));d=this._paintDefinition[a];void 0===c&&(c=d["default"]);"enum"===d.type&&(c=d.values.indexOf(c));return c};d.prototype._parseLayout=function(a){var c={},d;for(d in a)c[d]=new b(this._layoutDefinition[d],
a[d]);return c};d.prototype._parsePaint=function(a){var c={},d;for(d in a)c[d]=new b(this._paintDefinition[d],a[d]);return c};return d}();f.StyleLayer=l;l=function(){return function(a,b){this.cap=a.getLayoutValue("line-cap",b);this.join=a.getLayoutValue("line-join",b);this.miterLimit=a.getLayoutValue("line-miter-limit",b);this.roundLimit=a.getLayoutValue("line-round-limit",b)}}();f.LineLayout=l;l=function(){return function(a,b,c){this.allowOverlap=a.getLayoutValue("icon-allow-overlap",b);this.ignorePlacement=
a.getLayoutValue("icon-ignore-placement",b);this.optional=a.getLayoutValue("icon-optional",b);this.rotationAlignment=a.getLayoutValue("icon-rotation-alignment",b);this.size=a.getLayoutValue("icon-size",b);this.rotate=a.getLayoutValue("icon-rotate",b);this.padding=a.getLayoutValue("icon-padding",b);this.keepUpright=a.getLayoutValue("icon-keep-upright",b);this.offset=a.getLayoutValue("icon-offset",b);c&&(1===this.rotationAlignment&&!a.hasLayoutProperty("icon-rotation-alignment"))&&(this.rotationAlignment=
0)}}();f.IconLayout=l;l=function(){return function(a,b,c){this.allowOverlap=a.getLayoutValue("text-allow-overlap",b);this.ignorePlacement=a.getLayoutValue("text-ignore-placement",b);this.optional=a.getLayoutValue("text-optional",b);this.rotationAlignment=a.getLayoutValue("text-rotation-alignment",b);this.font=a.getLayoutValue("text-font",b);this.maxWidth=a.getLayoutValue("text-max-width",b);this.lineHeight=a.getLayoutValue("text-line-height",b);this.letterSpacing=a.getLayoutValue("text-letter-spacing",
b);this.justify=a.getLayoutValue("text-justify",b);this.anchor=a.getLayoutValue("text-anchor",b);this.maxAngle=a.getLayoutValue("text-max-angle",b);this.size=a.getLayoutValue("text-size",b);this.rotate=a.getLayoutValue("text-rotate",b);this.padding=a.getLayoutValue("text-padding",b);this.keepUpright=a.getLayoutValue("text-keep-upright",b);this.transform=a.getLayoutValue("text-transform",b);this.offset=a.getLayoutValue("text-offset",b);c&&(1===this.rotationAlignment&&!a.hasLayoutProperty("text-rotation-alignment"))&&
(this.rotationAlignment=0)}}();f.TextLayout=l})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleDefinition":function(){define(["require","exports"],function(l,f){var a=function(){function a(){}a.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}};a.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"}};a.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"line-cap":{type:"enum",
values:["butt","round","square"],"default":"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],"default":"miter"},"line-miter-limit":{type:"number","default":2},"line-round-limit":{type:"number","default":1.05}};a.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],"default":"visible"},"symbol-placement":{type:"enum",values:["point","line"],"default":"point"},"symbol-spacing":{type:"number",minimum:1,"default":250},"symbol-avoid-edges":{type:"boolean","default":!1},
"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean","default":!1},"icon-ignore-placement":{type:"boolean","default":!1},"icon-optional":{type:"boolean","default":!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"icon-size":{type:"number",minimum:0,"default":1},"icon-rotate":{type:"number","default":0},"icon-padding":{type:"number",minimum:0,"default":2},"icon-keep-upright":{type:"boolean","default":!0},"icon-offset":{type:"array",value:"number",
length:2,"default":[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport"],"default":"viewport"},"text-font":{type:"array",value:"string","default":["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,"default":16},"text-max-width":{type:"number",minimum:0,"default":10},"text-line-height":{type:"number","default":1.2},"text-letter-spacing":{type:"number","default":0},"text-justify":{type:"enum",values:["left","center",
"right"],"default":"center"},"text-anchor":{type:"enum",values:"center left right top bottom top-left top-right bottom-left bottom-right".split(" "),"default":"center"},"text-max-angle":{type:"number",minimum:0,"default":45},"text-rotate":{type:"number","default":0},"text-padding":{type:"number",minimum:0,"default":2},"text-keep-upright":{type:"boolean","default":!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],"default":"none"},"text-offset":{type:"array",value:"number",
length:2,"default":[0,0]},"text-allow-overlap":{type:"boolean","default":!1},"text-ignore-placement":{type:"boolean","default":!1},"text-optional":{type:"boolean","default":!1}};a.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,"default":1},"background-color":{type:"color","default":[0,0,0,1]},"background-pattern":{type:"string"}};a.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,"default":1},"fill-antialias":{type:"boolean","default":!0},
"fill-color":{type:"color","default":[0,0,0,1]},"fill-outline-color":{type:"color","default":[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,"default":[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"fill-pattern":{type:"string"}};a.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,"default":1},"line-color":{type:"color","default":[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,"default":[0,0]},"line-translate-anchor":{type:"enum",
values:["map","viewport"],"default":"map"},"line-width":{type:"number",minimum:0,"default":1},"line-gap-width":{type:"number",minimum:0,"default":0},"line-offset":{type:"number","default":0},"line-blur":{type:"number",minimum:0,"default":0},"line-dasharray":{type:"array",value:"number","default":[]},"line-pattern":{type:"string"}};a.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,"default":1},"icon-color":{type:"color","default":[0,0,0,1]},"icon-halo-color":{type:"color",
"default":[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,"default":0},"icon-halo-blur":{type:"number",minimum:0,"default":0},"icon-translate":{type:"array",value:"number",length:2,"default":[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"},"text-opacity":{type:"number",minimum:0,maximum:1,"default":1},"text-color":{type:"color","default":[0,0,0,1]},"text-halo-color":{type:"color","default":[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,"default":0},
"text-halo-blur":{type:"number",minimum:0,"default":0},"text-translate":{type:"array",value:"number",length:2,"default":[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],"default":"map"}};a.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,"default":1},"raster-hue-rotate":{type:"number","default":0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,"default":0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,"default":1},"raster-saturation":{type:"number",
minimum:-1,maximum:1,"default":0},"raster-contrast":{type:"number",minimum:-1,maximum:1,"default":0},"raster-fade-duration":{type:"number",minimum:0,"default":300}};a.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,"default":1},"circle-radius":{type:"number",minimum:0,"default":5},"circle-color":{type:"color","default":[0,0,0,1]},"circle-blur":{type:"number",minimum:0,"default":0},"circle-translate":{type:"array",value:"number",length:2,"default":[0,0]},"circle-translate-anchor":{type:"enum",
values:["map","viewport"],"default":"map"}};return a}();f.StyleDefinition=a})},"esri/layers/vectorTiles/views/vectorTiles/style/StyleProperty":function(){define(["require","exports","../../../Color","../GeometryUtils"],function(l,f,a,b){return function(){function c(a,b){var g;switch(a.type){case "number":g=!0;break;case "color":g=!0;b=c._parseColor(b);break;case "array":g="number"===a.value;break;default:g=!1}this.getValue=g?this._interpolate(b):this._piecewise(b)}c.prototype._piecewise=function(a){var b=
a.stops;return b?function(a){var c=b.length;if(0!==c){for(var d=0,k=0;k<c;k++)if(b[k][0]<=a)d=k;else break;return b[d][1]}}:function(){return a}};c.prototype._interpolate=function(a){var c=a.stops;if(c){var g=a.base||1;return function(a){for(var d,k,n=c.length,p=0;p<n;p++){var x=c[p];if(x[0]<=a)d=x;else{k=x;break}}if(d&&k){p=k[0]-d[0];a-=d[0];a=1===g?a/p:(Math.pow(g,a)-1)/(Math.pow(g,p)-1);if(Array.isArray(d[1])){d=d[1];k=k[1];n=[];for(p=0;p<d.length;p++)n.push(b.interpolate(d[p],k[p],a));return n}return b.interpolate(d[1],
k[1],a)}if(d)return d[1];if(k)return k[1]}}return function(){return a}};c._parseColor=function(b){if(Array.isArray(b))return b;if("string"===typeof b){var e=new a(b);if(e)return[e.r/255,e.g/255,e.b/255,e.a||1]}if(b&&b.stops)return b.stops=b.stops.map(function(a){return[a[0],c._parseColor(a[1])]}),b;throw Error("Incorrect color definition "+b);};return c}()})},"esri/layers/vectorTiles/Color":function(){define(["require","exports","esri/Color"],function(l,f,a){return function(){return function(b){return new a(b)}}()})},
"esri/layers/vectorTiles/views/vectorTiles/GeometryUtils":function(){define(["require","exports"],function(l,f){function a(a,b){a%=b;return 0<=a?a:a+b}f.C_INFINITY=Number.POSITIVE_INFINITY;f.C_PI=Math.PI;f.C_2PI=2*f.C_PI;f.C_PI_BY_2=f.C_PI/2;f.C_RAD_TO_256=128/f.C_PI;f.C_256_TO_RAD=f.C_PI/128;f.C_DEG_TO_256=256/360;f.C_DEG_TO_RAD=f.C_PI/180;f.C_SQRT2=1.414213562;f.C_SQRT2_INV=1/f.C_SQRT2;var b=1/Math.LN2;f.positiveMod=a;f.radToByte=function(b){return a(b*f.C_RAD_TO_256,256)};f.degToByte=function(b){return a(b*
f.C_DEG_TO_256,256)};f.log2=function(a){return Math.log(a)*b};f.sqr=function(a){return a*a};f.clamp=function(a,b,e){return Math.min(Math.max(a,b),e)};f.interpolate=function(a,b,e){return a*(1-e)+b*e}})},"esri/layers/vectorTiles/views/vectorTiles/style/Filter":function(){define(["require","exports"],function(l,f){return function(){function a(b,c,d){this._op=b;"$type"===c?(this._val=a._types.indexOf(d),this._op+=11):(this._key=c,this._val=d)}a.prototype.filter=function(a){switch(this._op){case 0:return this._val;
case 1:return a.values[this._key]===this._val;case 2:return a.values[this._key]!==this._val;case 3:return a.values[this._key]<this._val;case 4:return a.values[this._key]>this._val;case 5:return a.values[this._key]>=this._val;case 6:return a.values[this._key]<=this._val;case 7:return-1!==this._val.indexOf(a.values[this._key]);case 8:return-1===this._val.indexOf(a.values[this._key]);case 9:for(var c=0,d=this._val;c<d.length;c++){var e=d[c];if(e.filter(a))return!0}return!1;case 10:c=0;for(d=this._val;c<
d.length;c++)if(e=d[c],!e.filter(a))return!1;return!0;case 11:c=0;for(d=this._val;c<d.length;c++)if(e=d[c],e.filter(a))return!1;return!0;case 12:return a.type===this._val;case 13:return a.type!==this._val;case 14:return a.type<this._val;case 15:return a.type>this._val;case 16:return a.type>=this._val;case 17:return a.type<=this._val;case 18:return-1!==this._val.indexOf(a.type);case 19:return-1===this._val.indexOf(a.type)}};a.createFilter=function(b){if(!b)return new a(0,void 0,!0);var c=b[0];if(1>=
b.length)return new a(0,void 0,"any"!==c);switch(c){case "\x3d\x3d":return new a(1,b[1],b[2]);case "!\x3d":return new a(2,b[1],b[2]);case "\x3e":return new a(4,b[1],b[2]);case "\x3c":return new a(3,b[1],b[2]);case "\x3e\x3d":return new a(6,b[1],b[2]);case "\x3c\x3d":return new a(5,b[1],b[2]);case "in":return new a(7,b[1],b.slice(2));case "!in":return new a(8,b[1],b.slice(2));case "any":return new a(9,void 0,b.slice(1).map(a.createFilter.bind(this)));case "all":return new a(10,void 0,b.slice(1).map(a.createFilter.bind(this)));
case "none":return new a(11,void 0,b.slice(1).map(a.createFilter.bind(this)));default:throw Error("invalid operator: "+c);}};a._types=["Unknown","Point","LineString","Polygon"];return a}()})},"esri/layers/vectorTiles/views/vectorTiles/VectorTileContainer":function(){define("require exports ../../core/tsSupport/extendsHelper dojo/has ../../core/libs/gl-matrix/vec3 ../../core/libs/gl-matrix/mat4 ../2d/engine/Container ./renderers/Renderer ./GeometryUtils ./StencilClipGenerator".split(" "),function(l,
f,a,b,c,d,e,g,h,m){var k=b("dojo-debug-messages");return function(b){function e(){b.call(this);this.isInitialized=!1;this._displayHeight=this._displayWidth=0;this._clip=new m;this._tileCoordinateScale=c.create();this._orientationVec=c.create();this._displayScale=c.create();this._orientationVec.set([0,0,1]);this._defaultTransform=d.create()}a(e,b);e.prototype.initialize=function(a,b,c,d){this._renderer=new g(a,b);this._tileInfoView=d;this._tileInfo=c;this.isInitialized=!0};e.prototype.prepareChildrenRenderParameters=
function(a){var b=a.state;if(!b||!this._tileInfo||!this.isInitialized)return a;a.displayLevel=this._tileInfo.scaleToZoom(b.scale);a.requiredLevel=this._tileInfoView.getClosestInfoForScale(b.scale).level;a.renderer=this._renderer;return a};e.prototype.renderChildren=function(a){if(!(0===this.children.length||!this.isInitialized||!a||!a.state)){this.sortChildren(function(a,b){return b.resolution-a.resolution});this._clip.update(this.children);this._updateTilesTransform(a.state,this._tileInfoView.getClosestInfoForScale(a.state.scale).level);
var c=a.context;c.setDepthWriteEnabled(!0);this._renderer.setStateParams(a.state,a.devicePixelRatio,a.displayLevel);this._renderer.drawClippingMasks(c,this.children);c.setStencilWriteMask(0);c.setBlendFunctionSeparate(770,771,1,771);c.setStencilOp(7680,7680,7681);c.setDepthFunction(515);c.setBlendingEnabled(!1);c.setStencilTestEnabled(!0);c.setDepthTestEnabled(!0);c.setDepthWriteEnabled(!0);a.drawphase=0;b.prototype.renderChildren.call(this,a);c.setDepthWriteEnabled(!1);c.setBlendingEnabled(!0);a.drawphase=
1;b.prototype.renderChildren.call(this,a);a.drawphase=2;b.prototype.renderChildren.call(this,a);c.setStencilTestEnabled(!1);c.setDepthTestEnabled(!1);if(k){a=0;for(var d=this.children;a<d.length;a++){var e=d[a];e.attached&&e.visible&&this._renderer.renderTileInfo(c,e)}}this._renderer.needsRedraw()&&this.requestRender()}};e.prototype.attachChild=function(a,b){return a.attach(b)};e.prototype.detachChild=function(a,b){a.detach(b)};e.prototype.renderChild=function(a,b){a.render(b)};e.prototype._updateTilesTransform=
function(a,b){var c=1/a.width,d=1/a.height,e=[0,0];this._calculateRelativeViewProjMat(this._tileInfo.lods[b].resolution,a.resolution,a.rotation,this._tileInfo.size[1],4096,a.width,a.height,this._defaultTransform);for(var g=0,h=this.children;g<h.length;g++){var k=h[g];a.toScreen(e,k.topLeft);e[1]=a.height-e[1];k.tileTransform.displayCoord[0]=2*e[0]*c-1;k.tileTransform.displayCoord[1]=2*e[1]*d-1;k.key.level===b&&4096===k.coordRange?k.tileTransform.transform.set(this._defaultTransform):this._calculateRelativeViewProjMat(this._tileInfo.lods[k.key.level].resolution,
a.resolution,a.rotation,this._tileInfo.size[1],k.coordRange,a.width,a.height,k.tileTransform.transform)}};e.prototype._calculateRelativeViewProjMat=function(a,b,c,e,g,k,m,n){var p=0.125;512!==e&&4096!==g&&(p=e/g);a=p*(a/b);this._tileCoordinateScale.set([a,a,1]);if(k!==this._displayWidth||m!==this._displayHeight)this._displayScale.set([2/k,-2/m,1]),this._displayWidth=k,this._displayHeight=m;d.identity(n);d.scale(n,n,this._tileCoordinateScale);d.rotate(n,n,-c*h.C_DEG_TO_RAD,this._orientationVec);d.scale(n,
n,this._displayScale);d.transpose(n,n)};return e}(e)})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec3":function(){define(["./common"],function(l){var f={create:function(){var a=new l.ARRAY_TYPE(3);a[0]=0;a[1]=0;a[2]=0;return a},clone:function(a){var b=new l.ARRAY_TYPE(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b},fromValues:function(a,b,c){var d=new l.ARRAY_TYPE(3);d[0]=a;d[1]=b;d[2]=c;return d},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a},set:function(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;
return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];return a}};f.sub=f.subtract;f.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];return a};f.mul=f.multiply;f.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];return a};f.div=f.divide;f.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);return a};f.floor=function(a,b){a[0]=Math.floor(b[0]);
a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);return a};f.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);return a};f.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);return a};f.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);return a};f.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;return a};f.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;
a[2]=b[2]+c[2]*d;return a};f.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)};f.dist=f.distance;f.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e};f.sqrDist=f.squaredDistance;f.length=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};f.len=f.length;f.squaredLength=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};f.sqrLen=f.squaredLength;f.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=
-b[2];return a};f.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];a[2]=1/b[2];return a};f.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],c=c*c+d*d+e*e;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c);return a};f.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};f.cross=function(a,b,c){var d=b[0],e=b[1];b=b[2];var g=c[0],h=c[1];c=c[2];a[0]=e*c-b*h;a[1]=b*g-d*c;a[2]=d*h-e*g;return a};f.lerp=function(a,b,c,d){var e=b[0],g=b[1];b=b[2];a[0]=e+d*(c[0]-e);a[1]=g+d*(c[1]-g);a[2]=b+d*(c[2]-
b);return a};f.hermite=function(a,b,c,d,e,g){var h=g*g,m=h*(2*g-3)+1,k=h*(g-2)+g,n=h*(g-1);g=h*(3-2*g);a[0]=b[0]*m+c[0]*k+d[0]*n+e[0]*g;a[1]=b[1]*m+c[1]*k+d[1]*n+e[1]*g;a[2]=b[2]*m+c[2]*k+d[2]*n+e[2]*g;return a};f.bezier=function(a,b,c,d,e,g){var h=1-g,m=h*h,k=g*g,n=m*h,m=3*g*m,h=3*k*h;g*=k;a[0]=b[0]*n+c[0]*m+d[0]*h+e[0]*g;a[1]=b[1]*n+c[1]*m+d[1]*h+e[1]*g;a[2]=b[2]*n+c[2]*m+d[2]*h+e[2]*g;return a};f.random=function(a,b){b=b||1;var c=2*l.RANDOM()*Math.PI,d=2*l.RANDOM()-1,e=Math.sqrt(1-d*d)*b;a[0]=
Math.cos(c)*e;a[1]=Math.sin(c)*e;a[2]=d*b;return a};f.transformMat4=function(a,b,c){var d=b[0],e=b[1];b=b[2];var g=c[3]*d+c[7]*e+c[11]*b+c[15],g=g||1;a[0]=(c[0]*d+c[4]*e+c[8]*b+c[12])/g;a[1]=(c[1]*d+c[5]*e+c[9]*b+c[13])/g;a[2]=(c[2]*d+c[6]*e+c[10]*b+c[14])/g;return a};f.transformMat3=function(a,b,c){var d=b[0],e=b[1];b=b[2];a[0]=d*c[0]+e*c[3]+b*c[6];a[1]=d*c[1]+e*c[4]+b*c[7];a[2]=d*c[2]+e*c[5]+b*c[8];return a};f.transformQuat=function(a,b,c){var d=b[0],e=b[1],g=b[2];b=c[0];var h=c[1],m=c[2];c=c[3];
var k=c*d+h*g-m*e,n=c*e+m*d-b*g,p=c*g+b*e-h*d,d=-b*d-h*e-m*g;a[0]=k*c+d*-b+n*-m-p*-h;a[1]=n*c+d*-h+p*-b-k*-m;a[2]=p*c+d*-m+k*-h-n*-b;return a};f.rotateX=function(a,b,c,d){var e=[],g=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];g[0]=e[0];g[1]=e[1]*Math.cos(d)-e[2]*Math.sin(d);g[2]=e[1]*Math.sin(d)+e[2]*Math.cos(d);a[0]=g[0]+c[0];a[1]=g[1]+c[1];a[2]=g[2]+c[2];return a};f.rotateY=function(a,b,c,d){var e=[],g=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];g[0]=e[2]*Math.sin(d)+e[0]*Math.cos(d);g[1]=
e[1];g[2]=e[2]*Math.cos(d)-e[0]*Math.sin(d);a[0]=g[0]+c[0];a[1]=g[1]+c[1];a[2]=g[2]+c[2];return a};f.rotateZ=function(a,b,c,d){var e=[],g=[];e[0]=b[0]-c[0];e[1]=b[1]-c[1];e[2]=b[2]-c[2];g[0]=e[0]*Math.cos(d)-e[1]*Math.sin(d);g[1]=e[0]*Math.sin(d)+e[1]*Math.cos(d);g[2]=e[2];a[0]=g[0]+c[0];a[1]=g[1]+c[1];a[2]=g[2]+c[2];return a};f.forEach=function(){var a=f.create();return function(b,c,d,e,g,h){c||(c=3);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],g(a,
a,h),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2];return b}}();f.angle=function(a,b){var c=f.fromValues(a[0],a[1],a[2]),d=f.fromValues(b[0],b[1],b[2]);f.normalize(c,c);f.normalize(d,d);c=f.dot(c,d);return 1<c?0:Math.acos(c)};f.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"};f.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]};f.equals=function(a,b){var c=a[0],d=a[1],e=a[2],g=b[0],h=b[1],m=b[2];return Math.abs(c-g)<=l.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(d-h)<=
l.EPSILON*Math.max(1,Math.abs(d),Math.abs(h))&&Math.abs(e-m)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(m))};return f})},"esri/layers/vectorTiles/core/libs/gl-matrix/common":function(){define([],function(){var l={EPSILON:1E-6};l.ARRAY_TYPE="undefined"!==typeof Float32Array?Float32Array:Array;l.RANDOM=Math.random;l.ENABLE_SIMD=!1;l.SIMD_AVAILABLE=l.ARRAY_TYPE===Float32Array&&"SIMD"in this;l.USE_SIMD=l.ENABLE_SIMD&&l.SIMD_AVAILABLE;l.setMatrixArrayType=function(a){l.ARRAY_TYPE=a};var f=Math.PI/180;
l.toRadian=function(a){return a*f};l.equals=function(a,b){return Math.abs(a-b)<=l.EPSILON*Math.max(1,Math.abs(a),Math.abs(b))};return l})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat4":function(){define(["./common"],function(l){var f={scalar:{},SIMD:{},create:function(){var a=new l.ARRAY_TYPE(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a},clone:function(a){var b=new l.ARRAY_TYPE(16);b[0]=a[0];b[1]=a[1];b[2]=
a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a},fromValues:function(a,b,c,d,e,g,h,m,k,n,p,f,q,r,s,t){var u=new l.ARRAY_TYPE(16);u[0]=a;u[1]=b;u[2]=c;u[3]=d;u[4]=e;u[5]=g;u[6]=h;u[7]=m;u[8]=k;
u[9]=n;u[10]=p;u[11]=f;u[12]=q;u[13]=r;u[14]=s;u[15]=t;return u},set:function(a,b,c,d,e,g,h,m,k,n,p,f,q,r,s,t,u){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=g;a[5]=h;a[6]=m;a[7]=k;a[8]=n;a[9]=p;a[10]=f;a[11]=q;a[12]=r;a[13]=s;a[14]=t;a[15]=u;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a}};f.scalar.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],g=b[6],h=b[7],m=b[11];a[1]=b[4];a[2]=b[8];
a[3]=b[12];a[4]=c;a[6]=b[9];a[7]=b[13];a[8]=d;a[9]=g;a[11]=b[14];a[12]=e;a[13]=h;a[14]=m}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a};f.SIMD.transpose=function(a,b){var c,d,e,g,h,m,k;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);e=SIMD.Float32x4.load(b,8);g=SIMD.Float32x4.load(b,12);h=SIMD.Float32x4.shuffle(c,d,0,1,4,5);m=SIMD.Float32x4.shuffle(e,g,
0,1,4,5);k=SIMD.Float32x4.shuffle(h,m,0,2,4,6);h=SIMD.Float32x4.shuffle(h,m,1,3,5,7);SIMD.Float32x4.store(a,0,k);SIMD.Float32x4.store(a,4,h);h=SIMD.Float32x4.shuffle(c,d,2,3,6,7);m=SIMD.Float32x4.shuffle(e,g,2,3,6,7);c=SIMD.Float32x4.shuffle(h,m,0,2,4,6);d=SIMD.Float32x4.shuffle(h,m,1,3,5,7);SIMD.Float32x4.store(a,8,c);SIMD.Float32x4.store(a,12,d);return a};f.transpose=l.USE_SIMD?f.SIMD.transpose:f.scalar.transpose;f.scalar.invert=function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=b[4],m=b[5],k=b[6],
n=b[7],p=b[8],f=b[9],q=b[10],r=b[11],s=b[12],t=b[13],u=b[14],w=b[15],l=c*m-d*h,y=c*k-e*h,A=c*n-g*h,z=d*k-e*m,B=d*n-g*m,G=e*n-g*k,D=p*t-f*s,E=p*u-q*s,C=p*w-r*s,K=f*u-q*t,J=f*w-r*t,H=q*w-r*u,F=l*H-y*J+A*K+z*C-B*E+G*D;if(!F)return null;F=1/F;a[0]=(m*H-k*J+n*K)*F;a[1]=(e*J-d*H-g*K)*F;a[2]=(t*G-u*B+w*z)*F;a[3]=(q*B-f*G-r*z)*F;a[4]=(k*C-h*H-n*E)*F;a[5]=(c*H-e*C+g*E)*F;a[6]=(u*A-s*G-w*y)*F;a[7]=(p*G-q*A+r*y)*F;a[8]=(h*J-m*C+n*D)*F;a[9]=(d*C-c*J-g*D)*F;a[10]=(s*B-t*A+w*l)*F;a[11]=(f*A-p*B-r*l)*F;a[12]=(m*
E-h*K-k*D)*F;a[13]=(c*K-d*E+e*D)*F;a[14]=(t*y-s*z-u*l)*F;a[15]=(p*z-f*y+q*l)*F;return a};f.SIMD.invert=function(a,b){var c,d,e,g,h,m,k,n,p;m=SIMD.Float32x4.load(b,0);k=SIMD.Float32x4.load(b,4);n=SIMD.Float32x4.load(b,8);p=SIMD.Float32x4.load(b,12);h=SIMD.Float32x4.shuffle(m,k,0,1,4,5);d=SIMD.Float32x4.shuffle(n,p,0,1,4,5);c=SIMD.Float32x4.shuffle(h,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,h,1,3,5,7);h=SIMD.Float32x4.shuffle(m,k,2,3,6,7);g=SIMD.Float32x4.shuffle(n,p,2,3,6,7);e=SIMD.Float32x4.shuffle(h,
g,0,2,4,6);g=SIMD.Float32x4.shuffle(g,h,1,3,5,7);h=SIMD.Float32x4.mul(e,g);h=SIMD.Float32x4.swizzle(h,1,0,3,2);m=SIMD.Float32x4.mul(d,h);k=SIMD.Float32x4.mul(c,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,h),m);k=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,h),k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);h=SIMD.Float32x4.mul(d,e);h=SIMD.Float32x4.swizzle(h,1,0,3,2);m=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,h),m);p=SIMD.Float32x4.mul(c,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);
m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(g,h));p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,h),p);p=SIMD.Float32x4.swizzle(p,2,3,0,1);h=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,3,0,1),g);h=SIMD.Float32x4.swizzle(h,1,0,3,2);e=SIMD.Float32x4.swizzle(e,2,3,0,1);m=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,h),m);n=SIMD.Float32x4.mul(c,h);h=SIMD.Float32x4.swizzle(h,2,3,0,1);m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(e,h));n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,h),n);n=SIMD.Float32x4.swizzle(n,2,3,0,
1);h=SIMD.Float32x4.mul(c,d);h=SIMD.Float32x4.swizzle(h,1,0,3,2);n=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,h),n);p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,h),p);h=SIMD.Float32x4.swizzle(h,2,3,0,1);n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,h),n);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(e,h));h=SIMD.Float32x4.mul(c,g);h=SIMD.Float32x4.swizzle(h,1,0,3,2);k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(e,h));n=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,h),n);h=SIMD.Float32x4.swizzle(h,2,3,0,1);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,
h),k);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(d,h));h=SIMD.Float32x4.mul(c,e);h=SIMD.Float32x4.swizzle(h,1,0,3,2);k=SIMD.Float32x4.add(SIMD.Float32x4.mul(g,h),k);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(d,h));h=SIMD.Float32x4.swizzle(h,2,3,0,1);k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(g,h));p=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,h),p);c=SIMD.Float32x4.mul(c,m);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,2,3,0,1),c);c=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(c,1,0,3,2),c);h=SIMD.Float32x4.reciprocalApproximation(c);
c=SIMD.Float32x4.sub(SIMD.Float32x4.add(h,h),SIMD.Float32x4.mul(c,SIMD.Float32x4.mul(h,h)));c=SIMD.Float32x4.swizzle(c,0,0,0,0);if(!c)return null;SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(c,m));SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(c,k));SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(c,n));SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(c,p));return a};f.invert=l.USE_SIMD?f.SIMD.invert:f.scalar.invert;f.scalar.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=b[4],m=b[5],k=b[6],n=b[7],p=b[8],
f=b[9],q=b[10],r=b[11],s=b[12],t=b[13],u=b[14],l=b[15];a[0]=m*(q*l-r*u)-f*(k*l-n*u)+t*(k*r-n*q);a[1]=-(d*(q*l-r*u)-f*(e*l-g*u)+t*(e*r-g*q));a[2]=d*(k*l-n*u)-m*(e*l-g*u)+t*(e*n-g*k);a[3]=-(d*(k*r-n*q)-m*(e*r-g*q)+f*(e*n-g*k));a[4]=-(h*(q*l-r*u)-p*(k*l-n*u)+s*(k*r-n*q));a[5]=c*(q*l-r*u)-p*(e*l-g*u)+s*(e*r-g*q);a[6]=-(c*(k*l-n*u)-h*(e*l-g*u)+s*(e*n-g*k));a[7]=c*(k*r-n*q)-h*(e*r-g*q)+p*(e*n-g*k);a[8]=h*(f*l-r*t)-p*(m*l-n*t)+s*(m*r-n*f);a[9]=-(c*(f*l-r*t)-p*(d*l-g*t)+s*(d*r-g*f));a[10]=c*(m*l-n*t)-h*(d*
l-g*t)+s*(d*n-g*m);a[11]=-(c*(m*r-n*f)-h*(d*r-g*f)+p*(d*n-g*m));a[12]=-(h*(f*u-q*t)-p*(m*u-k*t)+s*(m*q-k*f));a[13]=c*(f*u-q*t)-p*(d*u-e*t)+s*(d*q-e*f);a[14]=-(c*(m*u-k*t)-h*(d*u-e*t)+s*(d*k-e*m));a[15]=c*(m*q-k*f)-h*(d*q-e*f)+p*(d*k-e*m);return a};f.SIMD.adjoint=function(a,b){var c,d,e,g,h,m,k,n,p;c=SIMD.Float32x4.load(b,0);d=SIMD.Float32x4.load(b,4);e=SIMD.Float32x4.load(b,8);g=SIMD.Float32x4.load(b,12);k=SIMD.Float32x4.shuffle(c,d,0,1,4,5);m=SIMD.Float32x4.shuffle(e,g,0,1,4,5);h=SIMD.Float32x4.shuffle(k,
m,0,2,4,6);m=SIMD.Float32x4.shuffle(m,k,1,3,5,7);k=SIMD.Float32x4.shuffle(c,d,2,3,6,7);d=SIMD.Float32x4.shuffle(e,g,2,3,6,7);c=SIMD.Float32x4.shuffle(k,d,0,2,4,6);d=SIMD.Float32x4.shuffle(d,k,1,3,5,7);k=SIMD.Float32x4.mul(c,d);k=SIMD.Float32x4.swizzle(k,1,0,3,2);e=SIMD.Float32x4.mul(m,k);g=SIMD.Float32x4.mul(h,k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);e=SIMD.Float32x4.sub(SIMD.Float32x4.mul(m,k),e);g=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,k),g);g=SIMD.Float32x4.swizzle(g,2,3,0,1);k=SIMD.Float32x4.mul(m,
c);k=SIMD.Float32x4.swizzle(k,1,0,3,2);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,k),e);p=SIMD.Float32x4.mul(h,k);k=SIMD.Float32x4.swizzle(k,2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(d,k));p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,k),p);p=SIMD.Float32x4.swizzle(p,2,3,0,1);k=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(m,2,3,0,1),d);k=SIMD.Float32x4.swizzle(k,1,0,3,2);c=SIMD.Float32x4.swizzle(c,2,3,0,1);e=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,k),e);n=SIMD.Float32x4.mul(h,k);k=SIMD.Float32x4.swizzle(k,
2,3,0,1);e=SIMD.Float32x4.sub(e,SIMD.Float32x4.mul(c,k));n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,k),n);n=SIMD.Float32x4.swizzle(n,2,3,0,1);k=SIMD.Float32x4.mul(h,m);k=SIMD.Float32x4.swizzle(k,1,0,3,2);n=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,k),n);p=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,k),p);k=SIMD.Float32x4.swizzle(k,2,3,0,1);n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,k),n);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(c,k));k=SIMD.Float32x4.mul(h,d);k=SIMD.Float32x4.swizzle(k,1,0,3,2);g=SIMD.Float32x4.sub(g,
SIMD.Float32x4.mul(c,k));n=SIMD.Float32x4.add(SIMD.Float32x4.mul(m,k),n);k=SIMD.Float32x4.swizzle(k,2,3,0,1);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(c,k),g);n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(m,k));k=SIMD.Float32x4.mul(h,c);k=SIMD.Float32x4.swizzle(k,1,0,3,2);g=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,k),g);p=SIMD.Float32x4.sub(p,SIMD.Float32x4.mul(m,k));k=SIMD.Float32x4.swizzle(k,2,3,0,1);g=SIMD.Float32x4.sub(g,SIMD.Float32x4.mul(d,k));p=SIMD.Float32x4.add(SIMD.Float32x4.mul(m,k),p);SIMD.Float32x4.store(a,
0,e);SIMD.Float32x4.store(a,4,g);SIMD.Float32x4.store(a,8,n);SIMD.Float32x4.store(a,12,p);return a};f.adjoint=l.USE_SIMD?f.SIMD.adjoint:f.scalar.adjoint;f.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],g=a[4],h=a[5],m=a[6],k=a[7],n=a[8],p=a[9],f=a[10],q=a[11],r=a[12],s=a[13],t=a[14];a=a[15];return(b*h-c*g)*(f*a-q*t)-(b*m-d*g)*(p*a-q*s)+(b*k-e*g)*(p*t-f*s)+(c*m-d*h)*(n*a-q*r)-(c*k-e*h)*(n*t-f*r)+(d*k-e*m)*(n*s-p*r)};f.SIMD.multiply=function(a,b,c){var d=SIMD.Float32x4.load(b,0),e=SIMD.Float32x4.load(b,
4),g=SIMD.Float32x4.load(b,8);b=SIMD.Float32x4.load(b,12);var h=SIMD.Float32x4.load(c,0),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),g),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),b))));SIMD.Float32x4.store(a,0,h);h=SIMD.Float32x4.load(c,4);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,
0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),g),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),b))));SIMD.Float32x4.store(a,4,h);h=SIMD.Float32x4.load(c,8);h=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),g),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,
3,3,3,3),b))));SIMD.Float32x4.store(a,8,h);c=SIMD.Float32x4.load(c,12);d=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,2,2,2,2),g),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(c,3,3,3,3),b))));SIMD.Float32x4.store(a,12,d);return a};f.scalar.multiply=function(a,b,c){var d=b[0],e=b[1],g=b[2],h=b[3],m=b[4],k=b[5],n=b[6],p=b[7],f=b[8],q=b[9],
r=b[10],s=b[11],t=b[12],l=b[13],w=b[14];b=b[15];var v=c[0],y=c[1],A=c[2],z=c[3];a[0]=v*d+y*m+A*f+z*t;a[1]=v*e+y*k+A*q+z*l;a[2]=v*g+y*n+A*r+z*w;a[3]=v*h+y*p+A*s+z*b;v=c[4];y=c[5];A=c[6];z=c[7];a[4]=v*d+y*m+A*f+z*t;a[5]=v*e+y*k+A*q+z*l;a[6]=v*g+y*n+A*r+z*w;a[7]=v*h+y*p+A*s+z*b;v=c[8];y=c[9];A=c[10];z=c[11];a[8]=v*d+y*m+A*f+z*t;a[9]=v*e+y*k+A*q+z*l;a[10]=v*g+y*n+A*r+z*w;a[11]=v*h+y*p+A*s+z*b;v=c[12];y=c[13];A=c[14];z=c[15];a[12]=v*d+y*m+A*f+z*t;a[13]=v*e+y*k+A*q+z*l;a[14]=v*g+y*n+A*r+z*w;a[15]=v*h+y*
p+A*s+z*b;return a};f.multiply=l.USE_SIMD?f.SIMD.multiply:f.scalar.multiply;f.mul=f.multiply;f.scalar.translate=function(a,b,c){var d=c[0],e=c[1];c=c[2];var g,h,m,k,n,p,f,q,r,s,l,u;b===a?(a[12]=b[0]*d+b[4]*e+b[8]*c+b[12],a[13]=b[1]*d+b[5]*e+b[9]*c+b[13],a[14]=b[2]*d+b[6]*e+b[10]*c+b[14],a[15]=b[3]*d+b[7]*e+b[11]*c+b[15]):(g=b[0],h=b[1],m=b[2],k=b[3],n=b[4],p=b[5],f=b[6],q=b[7],r=b[8],s=b[9],l=b[10],u=b[11],a[0]=g,a[1]=h,a[2]=m,a[3]=k,a[4]=n,a[5]=p,a[6]=f,a[7]=q,a[8]=r,a[9]=s,a[10]=l,a[11]=u,a[12]=
g*d+n*e+r*c+b[12],a[13]=h*d+p*e+s*c+b[13],a[14]=m*d+f*e+l*c+b[14],a[15]=k*d+q*e+u*c+b[15]);return a};f.SIMD.translate=function(a,b,c){var d=SIMD.Float32x4.load(b,0),e=SIMD.Float32x4.load(b,4),g=SIMD.Float32x4.load(b,8),h=SIMD.Float32x4.load(b,12);c=SIMD.Float32x4(c[0],c[1],c[2],0);b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11]);d=SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0));e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(c,
1,1,1,1));g=SIMD.Float32x4.mul(g,SIMD.Float32x4.swizzle(c,2,2,2,2));b=SIMD.Float32x4.add(d,SIMD.Float32x4.add(e,SIMD.Float32x4.add(g,h)));SIMD.Float32x4.store(a,12,b);return a};f.translate=l.USE_SIMD?f.SIMD.translate:f.scalar.translate;f.scalar.scale=function(a,b,c){var d=c[0],e=c[1];c=c[2];a[0]=b[0]*d;a[1]=b[1]*d;a[2]=b[2]*d;a[3]=b[3]*d;a[4]=b[4]*e;a[5]=b[5]*e;a[6]=b[6]*e;a[7]=b[7]*e;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};f.SIMD.scale=
function(a,b,c){var d;c=SIMD.Float32x4(c[0],c[1],c[2],0);d=SIMD.Float32x4.load(b,0);SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,0,0,0,0)));d=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,1,1,1,1)));d=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(c,2,2,2,2)));a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};f.scale=l.USE_SIMD?f.SIMD.scale:f.scalar.scale;f.rotate=function(a,
b,c,d){var e=d[0],g=d[1];d=d[2];var h=Math.sqrt(e*e+g*g+d*d),m,k,n,p,f,q,r,s,t,u,w,v,y,A,z,B,G,D,E,C;if(Math.abs(h)<l.EPSILON)return null;h=1/h;e*=h;g*=h;d*=h;m=Math.sin(c);k=Math.cos(c);n=1-k;c=b[0];h=b[1];p=b[2];f=b[3];q=b[4];r=b[5];s=b[6];t=b[7];u=b[8];w=b[9];v=b[10];y=b[11];A=e*e*n+k;z=g*e*n+d*m;B=d*e*n-g*m;G=e*g*n-d*m;D=g*g*n+k;E=d*g*n+e*m;C=e*d*n+g*m;e=g*d*n-e*m;g=d*d*n+k;a[0]=c*A+q*z+u*B;a[1]=h*A+r*z+w*B;a[2]=p*A+s*z+v*B;a[3]=f*A+t*z+y*B;a[4]=c*G+q*D+u*E;a[5]=h*G+r*D+w*E;a[6]=p*G+s*D+v*E;a[7]=
f*G+t*D+y*E;a[8]=c*C+q*e+u*g;a[9]=h*C+r*e+w*g;a[10]=p*C+s*e+v*g;a[11]=f*C+t*e+y*g;b!==a&&(a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);return a};f.scalar.rotateX=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[4],g=b[5],h=b[6],m=b[7],k=b[8],n=b[9],p=b[10],f=b[11];b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[4]=e*c+k*d;a[5]=g*c+n*d;a[6]=h*c+p*d;a[7]=m*c+f*d;a[8]=k*c-e*d;a[9]=n*c-g*d;a[10]=p*c-h*d;a[11]=f*c-m*d;return a};f.SIMD.rotateX=
function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var e=SIMD.Float32x4.load(b,4);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(e,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(e,d)));return a};f.rotateX=l.USE_SIMD?f.SIMD.rotateX:f.scalar.rotateX;f.scalar.rotateY=
function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],g=b[1],h=b[2],m=b[3],k=b[8],n=b[9],p=b[10],f=b[11];b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c-k*d;a[1]=g*c-n*d;a[2]=h*c-p*d;a[3]=m*c-f*d;a[8]=e*d+k*c;a[9]=g*d+n*c;a[10]=h*d+p*c;a[11]=m*d+f*c;return a};f.SIMD.rotateY=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],
a[14]=b[14],a[15]=b[15]);var e=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,8);SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,c),SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(e,d),SIMD.Float32x4.mul(b,c)));return a};f.rotateY=l.USE_SIMD?f.SIMD.rotateY:f.scalar.rotateY;f.scalar.rotateZ=function(a,b,c){var d=Math.sin(c);c=Math.cos(c);var e=b[0],g=b[1],h=b[2],m=b[3],k=b[4],n=b[5],p=b[6],f=b[7];b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=
b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);a[0]=e*c+k*d;a[1]=g*c+n*d;a[2]=h*c+p*d;a[3]=m*c+f*d;a[4]=k*c-e*d;a[5]=n*c-g*d;a[6]=p*c-h*d;a[7]=f*c-m*d;return a};f.SIMD.rotateZ=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c));c=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var e=SIMD.Float32x4.load(b,0);b=SIMD.Float32x4.load(b,4);SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(e,c),
SIMD.Float32x4.mul(b,d)));SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(b,c),SIMD.Float32x4.mul(e,d)));return a};f.rotateZ=l.USE_SIMD?f.SIMD.rotateZ:f.scalar.rotateZ;f.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=b[0];a[13]=b[1];a[14]=b[2];a[15]=1;return a};f.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b[1];a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=b[2];a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=
1;return a};f.fromRotation=function(a,b,c){var d=c[0],e=c[1];c=c[2];var g=Math.sqrt(d*d+e*e+c*c),h;if(Math.abs(g)<l.EPSILON)return null;g=1/g;d*=g;e*=g;c*=g;g=Math.sin(b);b=Math.cos(b);h=1-b;a[0]=d*d*h+b;a[1]=e*d*h+c*g;a[2]=c*d*h-e*g;a[3]=0;a[4]=d*e*h-c*g;a[5]=e*e*h+b;a[6]=c*e*h+d*g;a[7]=0;a[8]=d*c*h+e*g;a[9]=e*c*h-d*g;a[10]=c*c*h+b;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};f.fromXRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=d;a[6]=c;a[7]=
0;a[8]=0;a[9]=-c;a[10]=d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};f.fromYRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=0;a[2]=-c;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=c;a[9]=0;a[10]=d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};f.fromZRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=c;a[2]=0;a[3]=0;a[4]=-c;a[5]=d;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};f.fromRotationTranslation=function(a,b,c){var d=
b[0],e=b[1],g=b[2],h=b[3],m=d+d,k=e+e,n=g+g;b=d*m;var p=d*k,d=d*n,f=e*k,e=e*n,g=g*n,m=h*m,k=h*k,h=h*n;a[0]=1-(f+g);a[1]=p+h;a[2]=d-k;a[3]=0;a[4]=p-h;a[5]=1-(b+g);a[6]=e+m;a[7]=0;a[8]=d+k;a[9]=e-m;a[10]=1-(b+f);a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};f.getTranslation=function(a,b){a[0]=b[12];a[1]=b[13];a[2]=b[14];return a};f.getRotation=function(a,b){var c=b[0]+b[5]+b[10],d=0;0<c?(d=2*Math.sqrt(c+1),a[3]=0.25*d,a[0]=(b[6]-b[9])/d,a[1]=(b[8]-b[2])/d,a[2]=(b[1]-b[4])/d):b[0]>b[5]&
b[0]>b[10]?(d=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/d,a[0]=0.25*d,a[1]=(b[1]+b[4])/d,a[2]=(b[8]+b[2])/d):b[5]>b[10]?(d=2*Math.sqrt(1+b[5]-b[0]-b[10]),a[3]=(b[8]-b[2])/d,a[0]=(b[1]+b[4])/d,a[1]=0.25*d,a[2]=(b[6]+b[9])/d):(d=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/d,a[0]=(b[8]+b[2])/d,a[1]=(b[6]+b[9])/d,a[2]=0.25*d);return a};f.fromRotationTranslationScale=function(a,b,c,d){var e=b[0],g=b[1],h=b[2],m=b[3],k=e+e,n=g+g,p=h+h;b=e*k;var f=e*n,e=e*p,q=g*n,g=g*p,h=h*p,k=m*k,n=m*n,m=m*p,
p=d[0],r=d[1];d=d[2];a[0]=(1-(q+h))*p;a[1]=(f+m)*p;a[2]=(e-n)*p;a[3]=0;a[4]=(f-m)*r;a[5]=(1-(b+h))*r;a[6]=(g+k)*r;a[7]=0;a[8]=(e+n)*d;a[9]=(g-k)*d;a[10]=(1-(b+q))*d;a[11]=0;a[12]=c[0];a[13]=c[1];a[14]=c[2];a[15]=1;return a};f.fromRotationTranslationScaleOrigin=function(a,b,c,d,e){var g=b[0],h=b[1],m=b[2],k=b[3],n=g+g,p=h+h,f=m+m;b=g*n;var q=g*p,g=g*f,r=h*p,h=h*f,m=m*f,n=k*n,p=k*p,k=k*f,f=d[0],s=d[1];d=d[2];var l=e[0],u=e[1];e=e[2];a[0]=(1-(r+m))*f;a[1]=(q+k)*f;a[2]=(g-p)*f;a[3]=0;a[4]=(q-k)*s;a[5]=
(1-(b+m))*s;a[6]=(h+n)*s;a[7]=0;a[8]=(g+p)*d;a[9]=(h-n)*d;a[10]=(1-(b+r))*d;a[11]=0;a[12]=c[0]+l-(a[0]*l+a[4]*u+a[8]*e);a[13]=c[1]+u-(a[1]*l+a[5]*u+a[9]*e);a[14]=c[2]+e-(a[2]*l+a[6]*u+a[10]*e);a[15]=1;return a};f.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=c+c,m=d+d,k=e+e,c=c*h,n=d*h,d=d*m,p=e*h,f=e*m,e=e*k,h=g*h,m=g*m,g=g*k;a[0]=1-d-e;a[1]=n+g;a[2]=p-m;a[3]=0;a[4]=n-g;a[5]=1-c-e;a[6]=f+h;a[7]=0;a[8]=p+m;a[9]=f-h;a[10]=1-c-d;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};f.frustum=
function(a,b,c,d,e,g,h){var m=1/(c-b),k=1/(e-d),n=1/(g-h);a[0]=2*g*m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=2*g*k;a[6]=0;a[7]=0;a[8]=(c+b)*m;a[9]=(e+d)*k;a[10]=(h+g)*n;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*(h*g)*n;a[15]=0;return a};f.perspective=function(a,b,c,d,e){b=1/Math.tan(b/2);var g=1/(d-e);a[0]=b/c;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=b;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=(e+d)*g;a[11]=-1;a[12]=0;a[13]=0;a[14]=2*e*d*g;a[15]=0;return a};f.perspectiveFromFieldOfView=function(a,b,c,d){var e=Math.tan(b.upDegrees*
Math.PI/180),g=Math.tan(b.downDegrees*Math.PI/180),h=Math.tan(b.leftDegrees*Math.PI/180);b=Math.tan(b.rightDegrees*Math.PI/180);var m=2/(h+b),k=2/(e+g);a[0]=m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=k;a[6]=0;a[7]=0;a[8]=-(0.5*(h-b)*m);a[9]=0.5*(e-g)*k;a[10]=d/(c-d);a[11]=-1;a[12]=0;a[13]=0;a[14]=d*c/(c-d);a[15]=0;return a};f.ortho=function(a,b,c,d,e,g,h){var m=1/(b-c),k=1/(d-e),n=1/(g-h);a[0]=-2*m;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*k;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*n;a[11]=0;a[12]=(b+c)*m;a[13]=(e+
d)*k;a[14]=(h+g)*n;a[15]=1;return a};f.lookAt=function(a,b,c,d){var e,g,h,m,k,n,p,x,q=b[0],r=b[1];b=b[2];h=d[0];m=d[1];g=d[2];p=c[0];d=c[1];e=c[2];if(Math.abs(q-p)<l.EPSILON&&Math.abs(r-d)<l.EPSILON&&Math.abs(b-e)<l.EPSILON)return f.identity(a);c=q-p;d=r-d;p=b-e;x=1/Math.sqrt(c*c+d*d+p*p);c*=x;d*=x;p*=x;e=m*p-g*d;g=g*c-h*p;h=h*d-m*c;(x=Math.sqrt(e*e+g*g+h*h))?(x=1/x,e*=x,g*=x,h*=x):h=g=e=0;m=d*h-p*g;k=p*e-c*h;n=c*g-d*e;(x=Math.sqrt(m*m+k*k+n*n))?(x=1/x,m*=x,k*=x,n*=x):n=k=m=0;a[0]=e;a[1]=m;a[2]=c;
a[3]=0;a[4]=g;a[5]=k;a[6]=d;a[7]=0;a[8]=h;a[9]=n;a[10]=p;a[11]=0;a[12]=-(e*q+g*r+h*b);a[13]=-(m*q+k*r+n*b);a[14]=-(c*q+d*r+p*b);a[15]=1;return a};f.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};f.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],
2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))};f.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];a[9]=b[9]+c[9];a[10]=b[10]+c[10];a[11]=b[11]+c[11];a[12]=b[12]+c[12];a[13]=b[13]+c[13];a[14]=b[14]+c[14];a[15]=b[15]+c[15];return a};f.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-
c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];a[9]=b[9]-c[9];a[10]=b[10]-c[10];a[11]=b[11]-c[11];a[12]=b[12]-c[12];a[13]=b[13]-c[13];a[14]=b[14]-c[14];a[15]=b[15]-c[15];return a};f.sub=f.subtract;f.multiplyScalar=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;a[9]=b[9]*c;a[10]=b[10]*c;a[11]=b[11]*c;a[12]=b[12]*c;a[13]=b[13]*c;a[14]=b[14]*c;a[15]=b[15]*c;return a};f.multiplyScalarAndAdd=
function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*d;a[8]=b[8]+c[8]*d;a[9]=b[9]+c[9]*d;a[10]=b[10]+c[10]*d;a[11]=b[11]+c[11]*d;a[12]=b[12]+c[12]*d;a[13]=b[13]+c[13]*d;a[14]=b[14]+c[14]*d;a[15]=b[15]+c[15]*d;return a};f.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===
b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]};f.equals=function(a,b){var c=a[0],d=a[1],e=a[2],g=a[3],h=a[4],m=a[5],k=a[6],n=a[7],p=a[8],f=a[9],q=a[10],r=a[11],s=a[12],t=a[13],u=a[14],w=a[15],v=b[0],y=b[1],A=b[2],z=b[3],B=b[4],G=b[5],D=b[6],E=b[7],C=b[8],K=b[9],J=b[10],H=b[11],F=b[12],I=b[13],L=b[14],M=b[15];return Math.abs(c-v)<=l.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(d-y)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(y))&&Math.abs(e-A)<=l.EPSILON*Math.max(1,Math.abs(e),
Math.abs(A))&&Math.abs(g-z)<=l.EPSILON*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(h-B)<=l.EPSILON*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(m-G)<=l.EPSILON*Math.max(1,Math.abs(m),Math.abs(G))&&Math.abs(k-D)<=l.EPSILON*Math.max(1,Math.abs(k),Math.abs(D))&&Math.abs(n-E)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(p-C)<=l.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(f-K)<=l.EPSILON*Math.max(1,Math.abs(f),Math.abs(K))&&Math.abs(q-J)<=l.EPSILON*Math.max(1,Math.abs(q),Math.abs(J))&&
Math.abs(r-H)<=l.EPSILON*Math.max(1,Math.abs(r),Math.abs(H))&&Math.abs(s-F)<=l.EPSILON*Math.max(1,Math.abs(s),Math.abs(F))&&Math.abs(t-I)<=l.EPSILON*Math.max(1,Math.abs(t),Math.abs(I))&&Math.abs(u-L)<=l.EPSILON*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(w-M)<=l.EPSILON*Math.max(1,Math.abs(w),Math.abs(M))};return f})},"esri/layers/vectorTiles/views/2d/engine/Container":function(){define(["require","exports","../../../core/tsSupport/extendsHelper","./DisplayObject"],function(l,f,a,b){var c;(function(a){a[a.BEFORE=
0]="BEFORE";a[a.ATTACHING=1]="ATTACHING";a[a.DETACHING=2]="DETACHING";a[a.RENDERING=3]="RENDERING";a[a.AFTER=4]="AFTER";a[a.DONE=5]="DONE"})(c||(c={}));return function(b){function e(){b.apply(this,arguments);this._childrenToAttach=[];this._childrenToDetach=[];this._renderPhase=c.DONE;this.children=[]}a(e,b);Object.defineProperty(e.prototype,"numChildren",{get:function(){return this.children.length},enumerable:!0,configurable:!0});e.prototype.attach=function(a){return!0};e.prototype.detach=function(a){var b=
this.children;a=this.prepareChildrenRenderParameters(a);for(var c=0,d=b.length;c<d;c++){var e=b[c];e.attached&&(this.detachChild(e,a),e.attached=!1,e.parent=null)}};e.prototype.render=function(a){var b=this.prepareChildrenRenderParameters(a);this._renderPhase=c.BEFORE;this.beforeRenderChildren(a,b);this._renderPhase=c.ATTACHING;this.attachChildren(b)||this.requestRender();this._renderPhase=c.DETACHING;for(var d=this._childrenToDetach;0<d.length;){var e=d.shift();this.detachChild(e,b);e.attached=!1;
e.parent=null}this._renderPhase=c.RENDERING;this.renderChildren(b);this._renderPhase=c.AFTER;this.afterRenderChildren(a,b);this._renderPhase=c.DONE};e.prototype.addChild=function(a){return this.addChildAt(a,this.children.length)};e.prototype.addChildAt=function(a,b){void 0===b&&(b=this.numChildren);if(this.contains(a))return a;var d=a.parent;d&&d!==this&&d.removeChild(a);b>=this.numChildren?this.children.push(a):this.children.splice(b,0,a);d=this._childrenToDetach.indexOf(a);-1<d&&this._childrenToDetach.splice(d,
1);this._childrenToAttach.push(a);this._renderPhase>=c.RENDERING&&this.requestRender();return a};e.prototype.contains=function(a){return-1<this.getChildIndex(a)};e.prototype.getChildIndex=function(a){return this.children.indexOf(a)};e.prototype.getChildAt=function(a){return 0>a||a>this.children.length?null:this.children[a]};e.prototype.removeAllChildren=function(){for(var a=this.numChildren;a--;)this.removeChildAt(0)};e.prototype.removeChild=function(a){var b=this.getChildIndex(a);return-1<b?this.removeChildAt(b):
a};e.prototype.removeChildAt=function(a){if(0>a||a>=this.children.length)return null;a=this.children.splice(a,1)[0];if(a.attached)this._childrenToDetach.push(a),this._renderPhase>=c.RENDERING&&this.requestRender();else{var b=this._childrenToAttach.indexOf(a);-1<b&&this._childrenToAttach.splice(b,1)}return a};e.prototype.requestChildRender=function(a){a&&(a.parent===this&&this._renderPhase>=c.RENDERING)&&this.requestRender()};e.prototype.setChildIndex=function(a,b){var d=this.getChildIndex(a);-1<d&&
(this.children.splice(d,1),this.children.splice(b,0,a),this._renderPhase>=c.RENDERING&&this.requestRender())};e.prototype.sortChildren=function(a){this._renderPhase>c.RENDERING&&this.requestRender();return this.children.sort(a)};e.prototype.attachChildren=function(a){var b=this._childrenToAttach;if(0===b.length)return!0;for(var c=a.budget,d=c.done||0===b.length;!d;)d=b.shift(),this.attachChild(d,a)&&(d.attached=!0,d.parent=this),d=c.done||0===b.length;return 0===b.length};e.prototype.renderChildren=
function(a){for(var b=this.children,c=0,d=b.length;c<d;c++){var e=b[c];e.attached&&e.visible&&this.renderChild(e,a)}};e.prototype.beforeRenderChildren=function(a,b){};e.prototype.afterRenderChildren=function(a,b){};return e}(b)})},"esri/layers/vectorTiles/views/2d/engine/DisplayObject":function(){define(["require","exports","../../../core/tsSupport/extendsHelper"],function(l,f,a){var b=0;return function(){function a(){this.attached=!1;this._visible=!0;Object.defineProperty(this,"uid",{writable:!1,
configurable:!1,value:Date.now().toString(16)+"-do-"+b++})}Object.defineProperty(a.prototype,"visible",{get:function(){return this._visible},set:function(a){this._visible!==a&&(this._visible=a,this.requestRender())},enumerable:!0,configurable:!0});a.prototype.requestRender=function(){this.parent&&this.parent.requestChildRender(this)};return a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/Renderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../GeometryUtils ./BackgroundRenderer ./LineRenderer ./FillRenderer ./SymbolRenderer ./TileInfoRenderer ./FadeRecorder".split(" "),
function(l,f,a,b,c,d,e,g,h,m){return function(){function k(a,b){this._extrudeRotateVector=new Float32Array([0,0,1]);this._extrudeScaleVector=new Float32Array([1,1,1]);this._pixelRatio=1;this._SpriteMosaic=a;this._glyphMosaic=b;this._backgroundRenderer=new c;this._lineRenderer=new d;this._fillRenderer=new e;this._symbolRenderer=new g;this._tileInfoRenderer=new h;this._fadeRecorder=new m.FadeRecorder(300);this._extrudeMatrix=new Float32Array(16);this._extrudeNoRotationMatrix=new Float32Array(16);this._backgroundColor=
new Float32Array([1,0,0,1])}k.prototype.setStateParams=function(c,d,e){this._state=c;this._pixelRatio=d;this._fadeRecorder.recordLevel(e);this._extrudeScaleVector[0]=2/c.width;this._extrudeScaleVector[1]=-2/c.height;a.identity(this._extrudeMatrix);a.rotate(this._extrudeMatrix,this._extrudeMatrix,-c.rotation*b.C_DEG_TO_RAD,this._extrudeRotateVector);a.scale(this._extrudeMatrix,this._extrudeMatrix,this._extrudeScaleVector);a.transpose(this._extrudeMatrix,this._extrudeMatrix);a.identity(this._extrudeNoRotationMatrix);
a.scale(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix,this._extrudeScaleVector);a.transpose(this._extrudeNoRotationMatrix,this._extrudeNoRotationMatrix)};k.prototype.drawClippingMasks=function(a,b){if(0!==b.length){a.setDepthWriteEnabled(!1);a.setDepthTestEnabled(!1);a.setStencilTestEnabled(!0);a.setBlendingEnabled(!1);a.setColorMask(!1,!1,!1,!1);a.setStencilOp(7680,7680,7681);a.setClearStencil(0);a.clear(a.gl.STENCIL_BUFFER_BIT);for(var c=0;c<b.length;c++){var d=b[c];d.attached&&d.visible&&
(a.setStencilFunctionSeparate(1032,519,d.stencilData.reference,d.stencilData.mask),a.setStencilWriteMask(d.stencilData.mask),this._backgroundRenderer.renderSolidColor(a,{u_matrix:d.tileTransform.transform,u_normalized_origin:d.tileTransform.displayCoord,u_coord_range:d.coordRange,u_depth:0,u_color:this._backgroundColor}))}a.setColorMask(!0,!0,!0,!0);a.setBlendingEnabled(!0);a.setStencilWriteMask(255)}};k.prototype.renderDebug=function(a,b){var c=b.key;this._backgroundColor.set([c.col%2,c.row%2,0===
c.col%2&&0===c.row%2?1:0,0.5]);this._backgroundRenderer.renderSolidColor(a,{u_matrix:b.tileTransform.transform,u_normalized_origin:b.tileTransform.displayCoord,u_coord_range:b.coordRange,u_depth:0,u_color:this._backgroundColor})};k.prototype.renderBucket=function(a,b,c,d,e,g,h){switch(b.type){case 0:2!==e&&this._renderBackground(a,c,e,g,h);break;case 1:2!==e&&this._renderFill(a,b,c,e,g,h);break;case 2:1===e&&this._renderLine(a,b,c,g,h);break;case 3:2===e&&this._renderSymbol(a,b,c,d,g,h)}};k.prototype.renderTileInfo=
function(a,b){this._tileInfoRenderer.render(a,b)};k.prototype.needsRedraw=function(){return this._fadeRecorder.needsRedraw()};k.prototype._renderBackground=function(a,b,c,d,e){this._backgroundRenderer.render(a,b,c,d,e,this._SpriteMosaic,this._SpriteMosaic.pixelRatio)};k.prototype._renderLine=function(a,b,c,d,e){this._lineRenderer.render(a,b,c,this._state,d,e,this._extrudeMatrix,this._SpriteMosaic.pixelRatio)};k.prototype._renderFill=function(a,b,c,d,e,g){this._fillRenderer.render(a,b,c,this._state.rotation,
d,e,g,this._SpriteMosaic,this._extrudeMatrix,this._SpriteMosaic.pixelRatio)};k.prototype._renderSymbol=function(a,b,c,d,e,g){var h=!0;d===e.key.level&&(h=!1);a.setStencilTestEnabled(h);this._symbolRenderer.render(a,b,c,this._state.rotation,this._fadeRecorder.getFadeValues(),e,g,this._SpriteMosaic,this._glyphMosaic,this._extrudeMatrix,this._extrudeNoRotationMatrix,this._SpriteMosaic.pixelRatio)};return k}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/BackgroundRenderer":function(){define("require exports dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject".split(" "),
function(l,f,a,b,c,d,e,g,h,m,k){return function(){function f(){this._patternMatrix=e.create();this._color=g.create();this._initialized=!1}f.prototype.renderSolidColor=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._solidVertexArrayObject);a.bindProgram(this._solidProgram);this._solidProgram.setUniformMatrix4fv("u_transformMatrix",b.u_matrix);this._solidProgram.setUniform2fv("u_normalized_origin",b.u_normalized_origin);this._solidProgram.setUniform1f("u_coord_range",b.u_coord_range||
4096);this._solidProgram.setUniform1f("u_depth",b.u_depth||0);this._solidProgram.setUniform4fv("u_color",b.u_color||new Float32Array([1,0,0,1]));a.drawArrays(5,0,4);a.bindVAO()};f.prototype.render=function(a,b,c,d,g,h,k){this._initialized||this._initialize(a);var m=g.getPaintValue("background-color",b),f=g.getPaintValue("background-opacity",b),n=g.getPaintValue("background-pattern",b),l=void 0!==n,z=m[3]*f,B=l||1>z;if(!(B&&0===c)&&(B||1!==c)){if(l){a.bindVAO(this._patternVertexArrayObject);a.bindProgram(this._patternProgram);
c=h.getMosaicItemPosition(n,!0);if(!c)return;b=d.coordRange/512/Math.pow(2,Math.floor(b)-d.key.level)/k;e.identity(this._patternMatrix);k=1/(c.size[1]*b);this._patternMatrix[0]=1/(c.size[0]*b);this._patternMatrix[4]=k;h.bind(a,9729,0);this._patternProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform);this._patternProgram.setUniform2fv("u_normalized_origin",d.tileTransform.displayCoord);this._patternProgram.setUniform1f("u_depth",g.z);this._patternProgram.setUniformMatrix3fv("u_pattern_matrix",
this._patternMatrix);this._patternProgram.setUniform1f("u_opacity",f);this._patternProgram.setUniform2f("u_pattern_tl",c.tl[0],c.tl[1]);this._patternProgram.setUniform2f("u_pattern_br",c.br[0],c.br[1]);this._patternProgram.setUniform1i("u_texture",0)}else this._color[0]=m[0],this._color[1]=m[1],this._color[2]=m[2],this._color[3]=z,a.bindVAO(this._solidVertexArrayObject),a.bindProgram(this._solidProgram),this._solidProgram.setUniformMatrix4fv("u_transformMatrix",d.tileTransform.transform),this._solidProgram.setUniform2fv("u_normalized_origin",
d.tileTransform.displayCoord),this._solidProgram.setUniform1f("u_coord_range",d.coordRange),this._solidProgram.setUniform1f("u_depth",g.z||0),this._solidProgram.setUniform4fv("u_color",this._color);a.drawArrays(5,0,4);a.bindVAO()}};f.prototype._initialize=function(e){if(this._initialized)return!0;var g={a_pos:0},f=new h(e,a,b,g);if(!f)return!1;var n=new h(e,c,d,g);if(!n)return!1;var l={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},t=new Int8Array([0,0,1,0,
0,1,1,1]),u=k.createVertex(e,35044,t),u=new m(e,g,l,{geometry:u}),t=new Int16Array([0,0,4096,0,0,4096,4096,4096]),t=k.createVertex(e,35044,t);e=new m(e,g,{geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]},{geometry:t});this._solidProgram=f;this._patternProgram=n;this._vertexAttributes=l;this._solidVertexArrayObject=u;this._patternVertexArrayObject=e;return this._initialized=!0};return f}()})},"esri/layers/vectorTiles/core/libs/gl-matrix/mat3":function(){define(["./common"],
function(l){var f={create:function(){var a=new l.ARRAY_TYPE(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},fromMat4:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[4];a[4]=b[5];a[5]=b[6];a[6]=b[8];a[7]=b[9];a[8]=b[10];return a},clone:function(a){var b=new l.ARRAY_TYPE(9);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];
a[8]=b[8];return a},fromValues:function(a,b,c,d,e,g,h,m,k){var f=new l.ARRAY_TYPE(9);f[0]=a;f[1]=b;f[2]=c;f[3]=d;f[4]=e;f[5]=g;f[6]=h;f[7]=m;f[8]=k;return f},set:function(a,b,c,d,e,g,h,m,k,f){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=g;a[5]=h;a[6]=m;a[7]=k;a[8]=f;return a},identity:function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a},transpose:function(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3];a[2]=b[6];a[3]=c;a[5]=b[7];a[6]=d;a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],
a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},invert:function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=b[4],m=b[5],k=b[6],f=b[7],p=b[8],l=p*h-m*f,q=-p*g+m*k,r=f*g-h*k,s=c*l+d*q+e*r;if(!s)return null;s=1/s;a[0]=l*s;a[1]=(-p*d+e*f)*s;a[2]=(m*d-e*h)*s;a[3]=q*s;a[4]=(p*c-e*k)*s;a[5]=(-m*c+e*g)*s;a[6]=r*s;a[7]=(-f*c+d*k)*s;a[8]=(h*c-d*g)*s;return a},adjoint:function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=b[4],m=b[5],k=b[6],f=b[7],p=b[8];a[0]=h*p-m*f;a[1]=e*f-d*p;a[2]=d*m-e*h;a[3]=
m*k-g*p;a[4]=c*p-e*k;a[5]=e*g-c*m;a[6]=g*f-h*k;a[7]=d*k-c*f;a[8]=c*h-d*g;return a},determinant:function(a){var b=a[3],c=a[4],d=a[5],e=a[6],g=a[7],h=a[8];return a[0]*(h*c-d*g)+a[1]*(-h*b+d*e)+a[2]*(g*b-c*e)},multiply:function(a,b,c){var d=b[0],e=b[1],g=b[2],h=b[3],m=b[4],k=b[5],f=b[6],p=b[7];b=b[8];var l=c[0],q=c[1],r=c[2],s=c[3],t=c[4],u=c[5],w=c[6],v=c[7];c=c[8];a[0]=l*d+q*h+r*f;a[1]=l*e+q*m+r*p;a[2]=l*g+q*k+r*b;a[3]=s*d+t*h+u*f;a[4]=s*e+t*m+u*p;a[5]=s*g+t*k+u*b;a[6]=w*d+v*h+c*f;a[7]=w*e+v*m+c*p;
a[8]=w*g+v*k+c*b;return a}};f.mul=f.multiply;f.translate=function(a,b,c){var d=b[0],e=b[1],g=b[2],h=b[3],m=b[4],k=b[5],f=b[6],p=b[7];b=b[8];var l=c[0];c=c[1];a[0]=d;a[1]=e;a[2]=g;a[3]=h;a[4]=m;a[5]=k;a[6]=l*d+c*h+f;a[7]=l*e+c*m+p;a[8]=l*g+c*k+b;return a};f.rotate=function(a,b,c){var d=b[0],e=b[1],g=b[2],h=b[3],m=b[4],k=b[5],f=b[6],p=b[7];b=b[8];var l=Math.sin(c);c=Math.cos(c);a[0]=c*d+l*h;a[1]=c*e+l*m;a[2]=c*g+l*k;a[3]=c*h-l*d;a[4]=c*m-l*e;a[5]=c*k-l*g;a[6]=f;a[7]=p;a[8]=b;return a};f.scale=function(a,
b,c){var d=c[0];c=c[1];a[0]=d*b[0];a[1]=d*b[1];a[2]=d*b[2];a[3]=c*b[3];a[4]=c*b[4];a[5]=c*b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};f.fromTranslation=function(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=b[0];a[7]=b[1];a[8]=1;return a};f.fromRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);a[0]=d;a[1]=c;a[2]=0;a[3]=-c;a[4]=d;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};f.fromScaling=function(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=0;a[4]=b[1];a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};f.fromMat2d=function(a,
b){a[0]=b[0];a[1]=b[1];a[2]=0;a[3]=b[2];a[4]=b[3];a[5]=0;a[6]=b[4];a[7]=b[5];a[8]=1;return a};f.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=c+c,f=d+d,k=e+e,c=c*h,n=d*h,d=d*f,p=e*h,l=e*f,e=e*k,h=g*h,f=g*f,g=g*k;a[0]=1-d-e;a[3]=n-g;a[6]=p+f;a[1]=n+g;a[4]=1-c-e;a[7]=l-h;a[2]=p-f;a[5]=l+h;a[8]=1-c-d;return a};f.normalFromMat4=function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=b[4],f=b[5],k=b[6],n=b[7],p=b[8],l=b[9],q=b[10],r=b[11],s=b[12],t=b[13],u=b[14],w=b[15],v=c*f-d*h,y=c*k-e*h,A=c*n-g*
h,z=d*k-e*f,B=d*n-g*f,G=e*n-g*k,D=p*t-l*s,E=p*u-q*s,p=p*w-r*s,C=l*u-q*t,l=l*w-r*t,q=q*w-r*u,r=v*q-y*l+A*C+z*p-B*E+G*D;if(!r)return null;r=1/r;a[0]=(f*q-k*l+n*C)*r;a[1]=(k*p-h*q-n*E)*r;a[2]=(h*l-f*p+n*D)*r;a[3]=(e*l-d*q-g*C)*r;a[4]=(c*q-e*p+g*E)*r;a[5]=(d*p-c*l-g*D)*r;a[6]=(t*G-u*B+w*z)*r;a[7]=(u*A-s*G-w*y)*r;a[8]=(s*B-t*A+w*v)*r;return a};f.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};f.frob=function(a){return Math.sqrt(Math.pow(a[0],
2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))};f.add=function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];a[4]=b[4]+c[4];a[5]=b[5]+c[5];a[6]=b[6]+c[6];a[7]=b[7]+c[7];a[8]=b[8]+c[8];return a};f.subtract=function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];a[4]=b[4]-c[4];a[5]=b[5]-c[5];a[6]=b[6]-c[6];a[7]=b[7]-c[7];a[8]=b[8]-c[8];return a};f.sub=f.subtract;f.multiplyScalar=
function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;a[4]=b[4]*c;a[5]=b[5]*c;a[6]=b[6]*c;a[7]=b[7]*c;a[8]=b[8]*c;return a};f.multiplyScalarAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;a[4]=b[4]+c[4]*d;a[5]=b[5]+c[5]*d;a[6]=b[6]+c[6]*d;a[7]=b[7]+c[7]*d;a[8]=b[8]+c[8]*d;return a};f.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]};f.equals=function(a,
b){var c=a[0],d=a[1],e=a[2],g=a[3],h=a[4],f=a[5],k=a[6],n=a[7],p=a[8],x=b[0],q=b[1],r=b[2],s=b[3],t=b[4],u=b[5],w=a[6],v=b[7],y=b[8];return Math.abs(c-x)<=l.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))&&Math.abs(d-q)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(q))&&Math.abs(e-r)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(r))&&Math.abs(g-s)<=l.EPSILON*Math.max(1,Math.abs(g),Math.abs(s))&&Math.abs(h-t)<=l.EPSILON*Math.max(1,Math.abs(h),Math.abs(t))&&Math.abs(f-u)<=l.EPSILON*Math.max(1,Math.abs(f),Math.abs(u))&&
Math.abs(k-w)<=l.EPSILON*Math.max(1,Math.abs(k),Math.abs(w))&&Math.abs(n-v)<=l.EPSILON*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(p-y)<=l.EPSILON*Math.max(1,Math.abs(p),Math.abs(y))};return f})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec4":function(){define(["./common"],function(l){var f={create:function(){var a=new l.ARRAY_TYPE(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a},clone:function(a){var b=new l.ARRAY_TYPE(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b},fromValues:function(a,b,c,
d){var e=new l.ARRAY_TYPE(4);e[0]=a;e[1]=b;e[2]=c;e[3]=d;return e},copy:function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a},set:function(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];a[2]=b[2]+c[2];a[3]=b[3]+c[3];return a},subtract:function(a,b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];a[2]=b[2]-c[2];a[3]=b[3]-c[3];return a}};f.sub=f.subtract;f.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];a[2]=b[2]*c[2];a[3]=b[3]*c[3];return a};f.mul=
f.multiply;f.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];a[2]=b[2]/c[2];a[3]=b[3]/c[3];return a};f.div=f.divide;f.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);a[2]=Math.ceil(b[2]);a[3]=Math.ceil(b[3]);return a};f.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);a[2]=Math.floor(b[2]);a[3]=Math.floor(b[3]);return a};f.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);a[2]=Math.min(b[2],c[2]);a[3]=Math.min(b[3],c[3]);return a};f.max=function(a,
b,c){a[0]=Math.max(b[0],c[0]);a[1]=Math.max(b[1],c[1]);a[2]=Math.max(b[2],c[2]);a[3]=Math.max(b[3],c[3]);return a};f.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);a[2]=Math.round(b[2]);a[3]=Math.round(b[3]);return a};f.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;a[2]=b[2]*c;a[3]=b[3]*c;return a};f.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;a[2]=b[2]+c[2]*d;a[3]=b[3]+c[3]*d;return a};f.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],g=b[3]-a[3];
return Math.sqrt(c*c+d*d+e*e+g*g)};f.dist=f.distance;f.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],g=b[3]-a[3];return c*c+d*d+e*e+g*g};f.sqrDist=f.squaredDistance;f.length=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};f.len=f.length;f.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};f.sqrLen=f.squaredLength;f.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];a[2]=-b[2];a[3]=-b[3];return a};f.inverse=function(a,b){a[0]=
1/b[0];a[1]=1/b[1];a[2]=1/b[2];a[3]=1/b[3];return a};f.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],g=b[3],h=c*c+d*d+e*e+g*g;0<h&&(h=1/Math.sqrt(h),a[0]=c*h,a[1]=d*h,a[2]=e*h,a[3]=g*h);return a};f.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};f.lerp=function(a,b,c,d){var e=b[0],g=b[1],h=b[2];b=b[3];a[0]=e+d*(c[0]-e);a[1]=g+d*(c[1]-g);a[2]=h+d*(c[2]-h);a[3]=b+d*(c[3]-b);return a};f.random=function(a,b){b=b||1;a[0]=l.RANDOM();a[1]=l.RANDOM();a[2]=l.RANDOM();a[3]=l.RANDOM();f.normalize(a,
a);f.scale(a,a,b);return a};f.transformMat4=function(a,b,c){var d=b[0],e=b[1],g=b[2];b=b[3];a[0]=c[0]*d+c[4]*e+c[8]*g+c[12]*b;a[1]=c[1]*d+c[5]*e+c[9]*g+c[13]*b;a[2]=c[2]*d+c[6]*e+c[10]*g+c[14]*b;a[3]=c[3]*d+c[7]*e+c[11]*g+c[15]*b;return a};f.transformQuat=function(a,b,c){var d=b[0],e=b[1],g=b[2],h=c[0],f=c[1],k=c[2];c=c[3];var n=c*d+f*g-k*e,p=c*e+k*d-h*g,l=c*g+h*e-f*d,d=-h*d-f*e-k*g;a[0]=n*c+d*-h+p*-k-l*-f;a[1]=p*c+d*-f+l*-h-n*-k;a[2]=l*c+d*-k+n*-f-p*-h;a[3]=b[3];return a};f.forEach=function(){var a=
f.create();return function(b,c,d,e,g,h){c||(c=4);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],a[2]=b[d+2],a[3]=b[d+3],g(a,a,h),b[d]=a[0],b[d+1]=a[1],b[d+2]=a[2],b[d+3]=a[3];return b}}();f.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"};f.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]};f.equals=function(a,b){var c=a[0],d=a[1],e=a[2],g=a[3],h=b[0],f=b[1],k=b[2],n=b[3];return Math.abs(c-h)<=l.EPSILON*Math.max(1,
Math.abs(c),Math.abs(h))&&Math.abs(d-f)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(f))&&Math.abs(e-k)<=l.EPSILON*Math.max(1,Math.abs(e),Math.abs(k))&&Math.abs(g-n)<=l.EPSILON*Math.max(1,Math.abs(g),Math.abs(n))};return f})},"esri/layers/vectorTiles/views/webgl/Program":function(){define(["require","exports"],function(l,f){return function(){function a(b,c,d,e,g){this._glName=this._context=null;this._locations={};this._id=void 0;this._initialized=!1;this._fShader=this._vShader=null;this._defines=void 0;
this._nameToUniformLocation={};this._nameToAttribLocation={};this._nameToUniform1={};this._nameToUniform2={};this._nameToUniform3={};this._nameToUniform4={};this._nameToUniformMatrix3={};this._nameToUniformMatrix4={};b||console.error("RenderingContext isn't initialized!");0===c.length&&console.error("Shaders source should not be empty!");this._context=b;this._vertexShaderSource=c;this._fragmentShaderSource=d;this._defines=g;this._id=a._nextId++;this._locations=e}Object.defineProperty(a.prototype,
"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.dispose=function(){var a=this._context.gl;this._vShader&&(a.deleteShader(this._vShader),this._vShader=null);this._fShader&&(a.deleteShader(this._fShader),this._fShader=null);this._glName&&(a.deleteProgram(this._glName),
this._glName=null)};a.prototype.initialize=function(){if(!this._initialized){this._vShader=this._loadShader(35633);this._fShader=this._loadShader(35632);(!this._vShader||!this._fShader)&&console.error("Error loading shaders!");var a=this._context.gl,c=a.createProgram();a.attachShader(c,this._vShader);a.attachShader(c,this._fShader);for(var d in this._locations)a.bindAttribLocation(c,this._locations[d],d);a.linkProgram(c);a.getProgramParameter(c,a.LINK_STATUS)||console.error("Could not initialize shader\nVALIDATE_STATUS: "+
a.getProgramParameter(c,a.VALIDATE_STATUS)+", gl error ["+a.getError()+"]infoLog: "+a.getProgramInfoLog(c));this._glName=c;this._initialized=!0}};a.prototype.getUniformLocation=function(a){this.initialize();void 0===this._nameToUniformLocation[a]&&(this._nameToUniformLocation[a]=this._context.gl.getUniformLocation(this._glName,a));return this._nameToUniformLocation[a]};a.prototype.hasUniform=function(a){return null!==this.getUniformLocation(a)};a.prototype.getAttribLocation=function(a){this.initialize();
void 0===this._nameToAttribLocation[a]&&(this._nameToAttribLocation[a]=this._context.gl.getAttribLocation(this._glName,a));return this._nameToAttribLocation[a]};a.prototype.setUniform1i=function(a,c){var d=this._nameToUniform1[a];if(void 0===d||c!==d)this._context.bindProgram(this),this._context.gl.uniform1i(this.getUniformLocation(a),c),this._nameToUniform1[a]=c};a.prototype.setUniform1f=function(a,c){var d=this._nameToUniform1[a];if(void 0===d||c!==d)this._context.bindProgram(this),this._context.gl.uniform1f(this.getUniformLocation(a),
c),this._nameToUniform1[a]=c};a.prototype.setUniform2f=function(a,c,d){var e=this._nameToUniform2[a];if(void 0===e||c!==e[0]||d!==e[1])this._context.bindProgram(this),this._context.gl.uniform2f(this.getUniformLocation(a),c,d),void 0===e?this._nameToUniform2[a]=new Float32Array([c,d]):(e[0]=c,e[1]=d)};a.prototype.setUniform2fv=function(b,c){0!==c.length%2&&console.error("Value array must have even number of elements!");var d=this._nameToUniform2[b];if(void 0===d||!a._arraysEqual(c,d))this._context.bindProgram(this),
this._context.gl.uniform2fv(this.getUniformLocation(b),c),void 0===d?this._nameToUniform2[b]=new Float32Array(c):d.set(c)};a.prototype.setUniform3f=function(a,c,d,e){var g=this._nameToUniform3[a];if(void 0===g||c!==g[0]||d!==g[1]||e!==g[2])this._context.bindProgram(this),this._context.gl.uniform3f(this.getUniformLocation(a),c,d,e),void 0===g?this._nameToUniform3[a]=new Float32Array([c,d,e]):(g[0]=c,g[1]=d,g[2]=e)};a.prototype.setUniform3fv=function(b,c){0!==c.length%3&&console.error("Value array must contain sets of three values!");
var d=this._nameToUniform3[b];if(void 0===d||!a._arraysEqual(c,d))this._context.bindProgram(this),this._context.gl.uniform3fv(this.getUniformLocation(b),c),void 0===d?this._nameToUniform3[b]=new Float32Array(c):d.set(c)};a.prototype.setUniform4f=function(a,c,d,e,g){var h=this._nameToUniform4[a];if(void 0===h||c!==h[0]||d!==h[1]||e!==h[2]||g!==h[3])this._context.bindProgram(this),this._context.gl.uniform4f(this.getUniformLocation(a),c,d,e,g),void 0===h?this._nameToUniform4[a]=new Float32Array([c,d,
e,g]):(h[0]=c,h[1]=d,h[2]=e,h[3]=g)};a.prototype.setUniform4fv=function(b,c){0!==c.length%4&&console.error("Value array must contain sets of four values!");var d=this._nameToUniform4[b];if(void 0===d||!a._arraysEqual(c,d))this._context.bindProgram(this),this._context.gl.uniform4fv(this.getUniformLocation(b),c),void 0===d?this._nameToUniform4[b]=new Float32Array(c):d.set(c)};a.prototype.setUniformMatrix3fv=function(b,c,d){void 0===d&&(d=!1);0!==c.length%9&&console.error("Matrix array must contain sets ot 9 elements!");
var e=this._nameToUniformMatrix3[b];if(void 0===e||(9===e.length?!a._matrix3Equal(e,c):!a._arraysEqual(c,e)))this._context.bindProgram(this),this._context.gl.uniformMatrix3fv(this.getUniformLocation(b),d,c),void 0===e?this._nameToUniformMatrix3[b]=new Float32Array(c):e.set(c)};a.prototype.setUniformMatrix4fv=function(b,c,d){void 0===d&&(d=!1);0!==c.length%16&&console.error("Matrix array must contain sets ot 16 elements!");var e=this._nameToUniformMatrix4[b];if(void 0===e||(16===e.length?!a._matrix4Equal(e,
c):!a._arraysEqual(c,e)))this._context.bindProgram(this),this._context.gl.uniformMatrix4fv(this.getUniformLocation(b),d,c),void 0===e?this._nameToUniformMatrix4[b]=new Float32Array(c):e.set(c)};a._padToThree=function(a){var c=a.toString();1E3>a&&(c=("  "+a).slice(-3));return c};a.prototype._addLineNumbers=function(b){var c=2;return b.replace(/\n/g,function(){return"\n"+a._padToThree(c++)+":"})};a.prototype._loadShader=function(a){var c=35633===a?this._vertexShaderSource:this._fragmentShaderSource;
if(void 0!==this._defines){var d="";if(Array.isArray(this._defines))for(var e=0,g=this._defines;e<g.length;e++)var h=g[e],d=d+("#define "+h+"\n");else for(h in this._defines)d+="#define "+h+"\n";c=d+c}d=this._context.gl;a=d.createShader(a);d.shaderSource(a,c);d.compileShader(a);d.getShaderParameter(a,d.COMPILE_STATUS)||(console.error(d.getShaderInfoLog(a)),console.error(this._addLineNumbers(c)));return a};a._matrix4Equal=function(a,c){(16!==a.length||16!==c.length)&&console.error("Matrix object must contain 16 elements!");
return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]&&a[9]===c[9]&&a[10]===c[10]&&a[11]===c[11]&&a[12]===c[12]&&a[13]===c[13]&&a[14]===c[14]&&a[15]===c[15]};a._matrix3Equal=function(a,c){(9!==a.length||9!==c.length)&&console.error("Matrix object must contain 16 elements!");return a[0]===c[0]&&a[1]===c[1]&&a[2]===c[2]&&a[3]===c[3]&&a[4]===c[4]&&a[5]===c[5]&&a[6]===c[6]&&a[7]===c[7]&&a[8]===c[8]};a._arraysEqual=function(a,c){if(a.length!==
c.length)return!1;for(var d=0;d<a.length;++d)if(a[d]!==c[d])return!1;return!0};a._nextId=0;return a}()})},"esri/layers/vectorTiles/views/webgl/VertexArrayObject":function(){define(["require","exports"],function(l,f){return function(){function a(b,c,d,e,g){this._locations=this._layout=this._glName=this._context=null;this._indexBuffer=this._buffers=void 0;this._initialized=!1;this._context=b;this._layout=d;this._buffers=e;this._locations=c;g&&(this._indexBuffer=g);this._id=a._nextId++}Object.defineProperty(a.prototype,
"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"vertexBuffers",{get:function(){return this._buffers},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexBuffer",{get:function(){return this._indexBuffer},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"layout",{get:function(){return this._layout},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"locations",{get:function(){return this._locations},enumerable:!0,configurable:!0});a.prototype.dispose=function(a){void 0===a&&(a=!0);var c=this._context.extensions.vao;c&&this._glName&&(c.deleteVertexArrayOES(this._glName),this._glName=null);this._context.getBoundVAO()===this&&this._context.bindVAO(null);if(a){for(var d in this._buffers)this._buffers[d].dispose(),delete this._buffers[d];this._indexBuffer&&(this._indexBuffer.dispose(),
this._indexBuffer=null)}};a.prototype.initialize=function(){if(!this._initialized){var a=this._context.extensions.vao;if(a){var c=a.createVertexArrayOES();a.bindVertexArrayOES(c);this._bindLayout();a.bindVertexArrayOES(null);this._glName=c}this._initialized=!0}};a.prototype.bind=function(){this.initialize();var a=this._context.extensions.vao;a?a.bindVertexArrayOES(this.glName):(this._context.bindVAO(null),this._bindLayout())};a.prototype._bindLayout=function(){var a=this._buffers,c=this._context.extensions.vao,
d=this._layout,e=this._indexBuffer;a||console.error("Vertex buffer dictionary is empty!");var g=this._context.gl,h,f,k=0,n;for(n in a){(h=a[n])||console.error("Vertex buffer is uninitialized!");(f=d[n])||console.error("Vertex element descriptor is empty!");this._context.bindBuffer(h);for(k=0;k<f.length;++k){h=f[k];var p=this._locations[h.name];void 0===p&&console.error("There is no location for vertex attribute '"+h.name+" defined.");if(4>=h.count){if(g.enableVertexAttribArray(p),g.vertexAttribPointer(p,
h.count,h.type,h.normalized,h.stride,h.offset),h.divisor&&0<h.divisor){var l=this._context.extensions.angleInstancedArrays;l&&l.vertexAttribDivisorANGLE(p,h.divisor)}}else if(16===h.count&&5126===h.type)for(var q=0;4>q;q++)g.enableVertexAttribArray(p+q),g.vertexAttribPointer(p+q,4,h.type,h.normalized,h.stride,h.offset+16*q),h.divisor&&0<h.divisor&&(l=this._context.extensions.angleInstancedArrays)&&l.vertexAttribDivisorANGLE(p+q,h.divisor);else console.error("Unsupported vertex attribute element count: "+
h.count)}}e&&(c?g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,e.glName):this._context.bindBuffer(e))};a.prototype.unbind=function(){this.initialize();var a=this._context.extensions.vao;a?a.bindVertexArrayOES(null):this._unbindLayout()};a.prototype._unbindLayout=function(){var a=this._buffers,c=this._layout,d=this._locations,e=this._context;a||console.error("Vertex buffer dictionary is empty!");var g=e.gl,h,f,k,n=0,p=0,l;for(l in a){(h=a[l])||console.error("Vertex buffer is uninitialized!");f=c[l];n=0;for(p=
f.length;n<p;++n)k=f[n],g.disableVertexAttribArray(d[k.name]);e.unbindBuffer(h.bufferType)}(a=this._indexBuffer)&&e.unbindBuffer(a.bufferType)};a._nextId=0;return a}()})},"esri/layers/vectorTiles/views/webgl/BufferObject":function(){define(["require","exports"],function(l,f){return function(){function a(b,c,d,e){this._glName=this._context=null;this._bufferType=void 0;this._usage=35044;this._size=-1;this._indexType=void 0;this._context=b;this._bufferType=c;this._usage=d;this._id=a._nextId++;this._glName=
this._context.gl.createBuffer();e&&this.setData(e)}a.createIndex=function(b,c,d){return new a(b,34963,c,d)};a.createVertex=function(b,c,d){return new a(b,34962,c,d)};Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,
"usage",{get:function(){return this._usage},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"bufferType",{get:function(){return this._bufferType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"indexType",{get:function(){return this._indexType},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"byteSize",{get:function(){return 34962===this._bufferType?this._size:5125===this._indexType?4*this._size:2*this._size},enumerable:!0,configurable:!0});a.prototype.dispose=
function(){this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null)};a.prototype.setData=function(a){if(a){if("number"===typeof a)0>a&&console.error("Buffer size cannot be negative!"),this._size=a;else{var c=a.byteLength;a instanceof Uint16Array&&(c/=2,this._indexType=5123);a instanceof Uint32Array&&(c/=4,this._indexType=5125);this._size=c}c=this._context.getBoundVAO();this._context.bindVAO(null);this._context.bindBuffer(this);this._context.gl.bufferData(this._bufferType,a,this._usage);
this._context.bindVAO(c)}};a.prototype.setSubData=function(a,c,d,e){void 0===c&&(c=0);void 0===d&&(d=0);if(a){(0>c||c>=this._size)&&console.error("offset is out of range!");var g=c,h=d,f=e,k=a.byteLength;a instanceof Uint16Array&&(k/=2,g*=2,h*=2,f*=2);a instanceof Uint32Array&&(k/=4,g*=4,h*=4,f*=2);void 0===e&&(e=k-1);d>=e&&console.error("end must be bigger than start!");c+d-e>this._size&&console.error("An attempt to write beyond the end of the buffer!");c=this._context.getBoundVAO();this._context.bindVAO(null);
this._context.bindBuffer(this);this._context.gl.bufferSubData(this._bufferType,g,(a instanceof ArrayBuffer?a:a.buffer).slice(h,f));this._context.bindVAO(c)}};a._nextId=0;return a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/LineRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 ../../../core/libs/gl-matrix/vec2 dojo/text!./shaders/lineShader.vs.glsl dojo/text!./shaders/lineShader.fs.glsl dojo/text!./shaders/lineJoinShader.vs.glsl dojo/text!./shaders/lineJoinShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(l,f,a,b,c,d,e,g,h,m,k,n,p){return function(){function f(){this._joinAttributeLocations={a_pos:0,a_vertexOffset:1};this._triangleAttributeLocations={a_pos:0,a_offset:1,a_accumulatedDistance:2};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=c.create();this._screenSize=d.create();this._color=b.create();this._dashArray=d.create()}f.prototype.render=function(b,c,d,e,g,h,k,f){if(0!==c.triangleElementCount){this._initialized||this._initialize(b);var m=g.tileTransform.transform,
n=g.coordRange/512,l=h.getPaintValue("line-translate",d);if(0!==l[0]||0!==l[1]){a.copy(this._viewProjMat,g.tileTransform.transform);var m=l[0],l=l[1],x=0,D=0,D=(1<<g.key.level)/Math.pow(2,d)*n,x=e.rotation;if(1===h.getPaintValue("line-translate-anchor",d))var E=Math.sin(p.C_DEG_TO_RAD*-x),C=Math.cos(p.C_DEG_TO_RAD*-x),x=D*(m*C-l*E),D=D*(m*E+l*C);else x=D*m,D*=l;this._offsetVector[0]=x;this._offsetVector[1]=D;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);
m=this._viewProjMat}x=1/f;l=h.getPaintValue("line-blur",d)+x;D=h.getPaintValue("line-width",d);x=0.5*(D+x);E=h.getPaintValue("line-opacity",d);C=h.getPaintValue("line-color",d);this._color[0]=C[0];this._color[1]=C[1];this._color[2]=C[2];this._color[3]=C[3]*E;if(1<x&&0<c.joinCount&&(this._screenSize[0]=0.5*e.width,this._screenSize[1]=0.5*e.height,e=Math.ceil(2*x),E=x-0.25,C=this._getJoinsVAO(b,g)))b.bindVAO(C),b.bindProgram(this._joinProgram),C=1/(0<f?f:1),this._joinProgram.setUniformMatrix4fv("u_transformMatrix",
m),this._joinProgram.setUniform2fv("u_normalized_origin",g.tileTransform.displayCoord),this._joinProgram.setUniform1f("u_depth",h.z),this._joinProgram.setUniform2fv("u_screen",this._screenSize),this._joinProgram.setUniform1f("u_size",e),this._joinProgram.setUniform4fv("u_color",this._color),this._joinProgram.setUniform1f("u_lineHalfWidth",E),this._joinProgram.setUniform1f("u_pixelRatio",f),this._joinProgram.setUniform1f("u_oneOverPixelRatio",C),b.drawArrays(0,c.joinStart,c.joinCount),b.bindVAO();
d=h.getPaintValue("line-dasharray",d);2>d.length&&(d=[1,-1]);n*=D;this._dashArray[0]=n*d[0];this._dashArray[1]=n*d[1];if(n=this._getTrianglesVAO(b,g))b.bindVAO(n),b.bindProgram(this._triangleslProgram),this._triangleslProgram.setUniformMatrix4fv("u_transformMatrix",m),this._triangleslProgram.setUniformMatrix4fv("u_extrudeMatrix",k),this._triangleslProgram.setUniform2fv("u_normalized_origin",g.tileTransform.displayCoord),this._triangleslProgram.setUniform1f("u_depth",h.z),this._triangleslProgram.setUniform4fv("u_color",
this._color),this._triangleslProgram.setUniform1f("u_lineHalfWidth",x),this._triangleslProgram.setUniform2fv("u_dasharray",this._dashArray),this._triangleslProgram.setUniform1f("u_blur",l),b.drawElements(4,c.triangleElementCount,5125,12*c.triangleElementStart),b.bindVAO()}};f.prototype._initialize=function(a){if(this._initialized)return!0;var b=new k(a,e,g,this._triangleAttributeLocations);a=new k(a,h,m,this._joinAttributeLocations);this._triangleslProgram=b;this._trianglesVertexAttributes={geometry:[{name:"a_pos",
count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_accumulatedDistance",count:1,type:5122,offset:6,stride:8,normalized:!1,divisor:0}]};this._joinProgram=a;this._joinVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};return this._initialized=!0};f.prototype._getTrianglesVAO=function(a,b){if(b.lineTrianglesVertexArrayObject)return b.lineTrianglesVertexArrayObject;
var c=b.lineVertexBuffer,d=b.lineTrianglesIndexBuffer;if(!c||!d)return null;b.lineTrianglesVertexArrayObject=new n(a,this._triangleAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d);return b.lineTrianglesVertexArrayObject};f.prototype._getJoinsVAO=function(a,b){if(b.lineJoinsVertexArrayObject)return b.lineJoinsVertexArrayObject;var c=b.lineJoinVertexBuffer;if(!c)return null;b.lineJoinsVertexArrayObject=new n(a,this._joinAttributeLocations,this._joinVertexAttributes,{geometry:c});return b.lineJoinsVertexArrayObject};
return f}()})},"esri/layers/vectorTiles/core/libs/gl-matrix/vec2":function(){define(["./common"],function(l){var f={create:function(){var a=new l.ARRAY_TYPE(2);a[0]=0;a[1]=0;return a},clone:function(a){var b=new l.ARRAY_TYPE(2);b[0]=a[0];b[1]=a[1];return b},fromValues:function(a,b){var c=new l.ARRAY_TYPE(2);c[0]=a;c[1]=b;return c},copy:function(a,b){a[0]=b[0];a[1]=b[1];return a},set:function(a,b,c){a[0]=b;a[1]=c;return a},add:function(a,b,c){a[0]=b[0]+c[0];a[1]=b[1]+c[1];return a},subtract:function(a,
b,c){a[0]=b[0]-c[0];a[1]=b[1]-c[1];return a}};f.sub=f.subtract;f.multiply=function(a,b,c){a[0]=b[0]*c[0];a[1]=b[1]*c[1];return a};f.mul=f.multiply;f.divide=function(a,b,c){a[0]=b[0]/c[0];a[1]=b[1]/c[1];return a};f.div=f.divide;f.ceil=function(a,b){a[0]=Math.ceil(b[0]);a[1]=Math.ceil(b[1]);return a};f.floor=function(a,b){a[0]=Math.floor(b[0]);a[1]=Math.floor(b[1]);return a};f.min=function(a,b,c){a[0]=Math.min(b[0],c[0]);a[1]=Math.min(b[1],c[1]);return a};f.max=function(a,b,c){a[0]=Math.max(b[0],c[0]);
a[1]=Math.max(b[1],c[1]);return a};f.round=function(a,b){a[0]=Math.round(b[0]);a[1]=Math.round(b[1]);return a};f.scale=function(a,b,c){a[0]=b[0]*c;a[1]=b[1]*c;return a};f.scaleAndAdd=function(a,b,c,d){a[0]=b[0]+c[0]*d;a[1]=b[1]+c[1]*d;return a};f.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)};f.dist=f.distance;f.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d};f.sqrDist=f.squaredDistance;f.length=function(a){var b=a[0];a=a[1];return Math.sqrt(b*
b+a*a)};f.len=f.length;f.squaredLength=function(a){var b=a[0];a=a[1];return b*b+a*a};f.sqrLen=f.squaredLength;f.negate=function(a,b){a[0]=-b[0];a[1]=-b[1];return a};f.inverse=function(a,b){a[0]=1/b[0];a[1]=1/b[1];return a};f.normalize=function(a,b){var c=b[0],d=b[1],c=c*c+d*d;0<c&&(c=1/Math.sqrt(c),a[0]=b[0]*c,a[1]=b[1]*c);return a};f.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]};f.cross=function(a,b,c){b=b[0]*c[1]-b[1]*c[0];a[0]=a[1]=0;a[2]=b;return a};f.lerp=function(a,b,c,d){var e=b[0];b=b[1];
a[0]=e+d*(c[0]-e);a[1]=b+d*(c[1]-b);return a};f.random=function(a,b){b=b||1;var c=2*l.RANDOM()*Math.PI;a[0]=Math.cos(c)*b;a[1]=Math.sin(c)*b;return a};f.transformMat2=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b;a[1]=c[1]*d+c[3]*b;return a};f.transformMat2d=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[2]*b+c[4];a[1]=c[1]*d+c[3]*b+c[5];return a};f.transformMat3=function(a,b,c){var d=b[0];b=b[1];a[0]=c[0]*d+c[3]*b+c[6];a[1]=c[1]*d+c[4]*b+c[7];return a};f.transformMat4=function(a,b,c){var d=
b[0];b=b[1];a[0]=c[0]*d+c[4]*b+c[12];a[1]=c[1]*d+c[5]*b+c[13];return a};f.forEach=function(){var a=f.create();return function(b,c,d,e,g,h){c||(c=2);d||(d=0);for(e=e?Math.min(e*c+d,b.length):b.length;d<e;d+=c)a[0]=b[d],a[1]=b[d+1],g(a,a,h),b[d]=a[0],b[d+1]=a[1];return b}}();f.str=function(a){return"vec2("+a[0]+", "+a[1]+")"};f.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]};f.equals=function(a,b){var c=a[0],d=a[1],e=b[0],g=b[1];return Math.abs(c-e)<=l.EPSILON*Math.max(1,Math.abs(c),Math.abs(e))&&
Math.abs(d-g)<=l.EPSILON*Math.max(1,Math.abs(d),Math.abs(g))};return f})},"esri/layers/vectorTiles/views/vectorTiles/renderers/FillRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/mat3 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/solidFillShader.vs.glsl dojo/text!./shaders/solidFillShader.fs.glsl dojo/text!./shaders/patternFillShader.vs.glsl dojo/text!./shaders/patternFillShader.fs.glsl dojo/text!./shaders/fillOutlineShader.vs.glsl dojo/text!./shaders/fillOutlineShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(l,f,a,b,c,d,e,g,h,m,k,n,p,x,q){var r=1/65536;return function(){function f(){this._outlineAttributeLocations={a_pos:0,a_offset:1,a_xnormal:2};this._fillAttributeLocations={a_pos:0};this._initialized=!1;this._viewProjMat=a.create();this._offsetVector=d.create();this._patternMatrix=b.create();this._color=c.create();this._outlineColor=c.create()}f.prototype.render=function(c,d,e,g,h,k,f,m,n,p){this._initialized||this._initialize(c);var l=f.getPaintValue("fill-pattern",e),x=void 0!==l;if(!(x&&
0===h)){var s=f.getPaintValue("fill-antialias",e)&&!x,J=f.getPaintValue("fill-opacity",e),H=f.getPaintValue("fill-color",e),F=!1;if(!x){var I=H[3]*J;1===I&&0===h&&(F=!0);1>I&&1===h&&(F=!0)}if(F||0!==h){var I=k.tileTransform.transform,L=k.coordRange/512,M=f.getPaintValue("fill-translate",e);if(0!==M[0]||0!==M[1]){a.copy(this._viewProjMat,k.tileTransform.transform);var I=M[0],M=M[1],O=0,N=0,L=(1<<k.key.level)/Math.pow(2,e)*L;1===f.getPaintValue("fill-translate-anchor",e)?(N=Math.sin(q.C_DEG_TO_RAD*
-g),g=Math.cos(q.C_DEG_TO_RAD*-g),O=L*(I*g-M*N),N=L*(I*N+M*g)):(O=L*I,N=L*M);this._offsetVector[0]=O;this._offsetVector[1]=N;this._offsetVector[2]=0;a.translate(this._viewProjMat,this._viewProjMat,this._offsetVector);I=this._viewProjMat}if(g=this._getTrianglesVAO(c,k)){c.bindVAO(g);if(x){if(1===h&&(l=m.getMosaicItemPosition(l,!0)))L=k.coordRange/512/Math.pow(2,Math.round(e)-k.key.level)/p,b.identity(this._patternMatrix),x=1/(l.size[1]*L),this._patternMatrix[0]=1/(l.size[0]*L),this._patternMatrix[4]=
x,m.bind(c,9729,0),c.bindProgram(this._patternFillProgram),this._patternFillProgram.setUniformMatrix4fv("u_transformMatrix",I),this._patternFillProgram.setUniform2fv("u_normalized_origin",k.tileTransform.displayCoord),this._patternFillProgram.setUniform1f("u_depth",f.z),this._patternFillProgram.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix),this._patternFillProgram.setUniform1f("u_opacity",J),this._patternFillProgram.setUniform2f("u_pattern_tl",l.tl[0],l.tl[1]),this._patternFillProgram.setUniform2f("u_pattern_br",
l.br[0],l.br[1]),this._patternFillProgram.setUniform1i("u_texture",0),c.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart)}else F&&(this._color[0]=H[0],this._color[1]=H[1],this._color[2]=H[2],this._color[3]=H[3]*J,c.bindProgram(this._solidFillProgram),this._solidFillProgram.setUniformMatrix4fv("u_transformMatrix",I),this._solidFillProgram.setUniform2fv("u_normalized_origin",k.tileTransform.displayCoord),this._solidFillProgram.setUniform1f("u_depth",f.z+r),this._solidFillProgram.setUniform4fv("u_color",
this._color),c.drawElements(4,d.triangleElementCount,5125,12*d.triangleElementStart)),c.bindVAO();if(s&&0<d.outlineElementCount&&1===h){e=f.getPaintValue("fill-outline-color",e);if(0===e[3]){if(1!==this._color[3])return;e=H}p=0.75/p;this._outlineColor[0]=e[0];this._outlineColor[1]=e[1];this._outlineColor[2]=e[2];this._outlineColor[3]=e[3]*J;if(J=this._getOutlineVAO(c,k))c.bindVAO(J),c.bindProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",I),this._outlineProgram.setUniformMatrix4fv("u_extrudeMatrix",
n),this._outlineProgram.setUniform2fv("u_normalized_origin",k.tileTransform.displayCoord),this._outlineProgram.setUniform1f("u_depth",f.z),this._outlineProgram.setUniform1f("u_outline_width",p),this._outlineProgram.setUniform4fv("u_color",this._outlineColor),c.drawElements(4,d.outlineElementCount,5125,12*d.outlineElementStart),c.bindVAO()}}}}};f.prototype._initialize=function(a){if(this._initialized)return!0;var b=new p(a,e,g,{a_pos:0});if(!b)return!1;var c=new p(a,h,m,this._fillAttributeLocations);
if(!c)return!1;a=new p(a,k,n,this._outlineAttributeLocations);this._solidFillProgram=b;this._patternFillProgram=c;this._trianglesVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:4,normalized:!1,divisor:0}]};this._outlineProgram=a;this._outlineVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:8,normalized:!1,divisor:0},{name:"a_offset",count:2,type:5120,offset:4,stride:8,normalized:!1,divisor:0},{name:"a_xnormal",count:2,type:5120,offset:6,stride:8,
normalized:!1,divisor:0}]};return this._initialized=!0};f.prototype._getTrianglesVAO=function(a,b){if(b.polygonTrianglesVertexArrayObject)return b.polygonTrianglesVertexArrayObject;var c=b.polygonTrianglesVertexBuffer,d=b.polygonTrianglesIndexBuffer;if(!c||!d)return null;b.polygonTrianglesVertexArrayObject=new x(a,this._fillAttributeLocations,this._trianglesVertexAttributes,{geometry:c},d);return b.polygonTrianglesVertexArrayObject};f.prototype._getOutlineVAO=function(a,b){if(b.polygonOutlineVertexArrayObject)return b.polygonOutlineVertexArrayObject;
var c=b.polygonOutlinesVertexBuffer,d=b.polygonOutlinesIndexBuffer;if(!c||!d)return null;b.polygonOutlineVertexArrayObject=new x(a,this._outlineAttributeLocations,this._outlineVertexAttributes,{geometry:c},d);return b.polygonOutlineVertexArrayObject};return f}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/SymbolRenderer":function(){define(["require","exports","./IconRenderer","./SDFRenderer"],function(l,f,a,b){return function(){function c(){this._iconRenderer=new a;this._sdfRenderer=new b}
c.prototype.render=function(a,b,c,h,f,k,n,p,l,q,r,s){b.hasData()&&(0<b.marketElementCount&&!b.isSDF&&this._iconRenderer.render(a,b,c,h,f,k,n,p,q,r),0<b.textElementCount&&this._sdfRenderer.render(a,b,c,h,f,k,n,l,q,r,s))};return c}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/IconRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/iconShader.vs.glsl dojo/text!./shaders/iconShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(l,f,a,b,c,d,e,g,h){return function(){function f(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._spritesTextureSize=new Float32Array(2);this._initialized=!1;this._extrudeMat=a.create();this._scaleVec=b.create()}f.prototype.render=function(b,c,d,e,g,f,m,l,u,w){this._initialized||this._initialize(b);var v=m.getPaintValue("icon-opacity",d),y=m.getLayoutValue("icon-rotation-alignment",d);1===y&&1===m.getLayoutValue("symbol-placement",d)&&!m.hasLayoutProperty("icon-rotation-alignment")&&
(y=0);var A=0===y,y=m.getLayoutValue("icon-keep-upright",d)&&A,z=m.getLayoutValue("icon-size",d);e=h.degToByte(e);this._spritesTextureSize[0]=l.width/4;this._spritesTextureSize[1]=l.height/4;A?a.copy(this._extrudeMat,u):a.copy(this._extrudeMat,w);1!==z&&(this._scaleVec[0]=z,this._scaleVec[1]=z,this._scaleVec[2]=1,a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec));l.bind(b,9728,0);b.bindProgram(this._iconProgram);if(l=this._getIconVAO(b,f))b.bindVAO(l),this._iconProgram.setUniformMatrix4fv("u_transformMatrix",
f.tileTransform.transform),this._iconProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._iconProgram.setUniform2fv("u_normalized_origin",f.tileTransform.displayCoord),this._iconProgram.setUniform1f("u_depth",m.z),this._iconProgram.setUniform2fv("u_mosaicSize",this._spritesTextureSize),this._iconProgram.setUniform1f("u_mapRotation",e),this._iconProgram.setUniform1f("u_keepUpright",y?1:0),this._iconProgram.setUniform1f("u_level",10*d),this._iconProgram.setUniform1f("u_fadeSpeed",10*
g.fadeSpeed),this._iconProgram.setUniform1f("u_minfadeLevel",10*g.minfadeLevel),this._iconProgram.setUniform1f("u_maxfadeLevel",10*g.maxfadeLevel),this._iconProgram.setUniform1f("u_fadeChange",10*(d+g.fadeChange)),this._iconProgram.setUniform1f("u_opacity",v),this._iconProgram.setUniform1i("u_texture",0),b.drawElements(4,c.marketElementCount,5125,12*c.markerElementStart),b.bindVAO()};f.prototype._initialize=function(a){if(this._initialized)return!0;this._iconProgram=new e(a,c,d,this._attributeLocations);
this._iconVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return this._initialized=!0};f.prototype._getIconVAO=function(a,b){if(b.iconVertexArrayObject)return b.iconVertexArrayObject;var c=b.iconVertexBuffer,
d=b.iconIndexBuffer;if(!c||!d)return null;b.iconVertexArrayObject=new g(a,this._attributeLocations,this._iconVertexAttributes,{geometry:c},d);return b.iconVertexArrayObject};return f}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/SDFRenderer":function(){define("require exports ../../../core/libs/gl-matrix/mat4 ../../../core/libs/gl-matrix/vec4 ../../../core/libs/gl-matrix/vec3 dojo/text!./shaders/sdfShader.vs.glsl dojo/text!./shaders/sdfShader.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../GeometryUtils".split(" "),
function(l,f,a,b,c,d,e,g,h,m){return function(){function k(){this._attributeLocations={a_pos:0,a_vertexOffset:1,a_tex:2,a_levelInfo:3};this._initialized=!1;this._extrudeMat=a.create();this._haloColor=b.create();this._sdfColor=b.create();this._scaleVec=c.create()}k.prototype.render=function(b,c,d,e,g,h,k,f,l,v,y){this._initialized||this._initialize(b);var A=k.getLayoutValue("text-size",d),z=A/24;e=m.degToByte(e);var B=k.getLayoutValue("text-rotation-alignment",d);1===B&&1===k.getLayoutValue("symbol-placement",
d)&&!k.hasLayoutProperty("text-rotation-alignment")&&(B=0);var G=0===B,B=k.getLayoutValue("text-keep-upright",d)&&G;y=0.1*24/A/y;A=k.getPaintValue("text-opacity",d);this._glyphTextureSize||(this._glyphTextureSize=new Float32Array([f.width/4,f.height/4]));G?a.copy(this._extrudeMat,l):a.copy(this._extrudeMat,v);this._scaleVec[0]=z;this._scaleVec[1]=z;this._scaleVec[2]=1;a.scale(this._extrudeMat,this._extrudeMat,this._scaleVec);f.bind(b,9729,0);b.bindProgram(this._sdfProgram);if(f=this._getSDFVAO(b,
h))b.bindVAO(f),this._sdfProgram.setUniformMatrix4fv("u_transformMatrix",h.tileTransform.transform),this._sdfProgram.setUniformMatrix4fv("u_extrudeMatrix",this._extrudeMat),this._sdfProgram.setUniform2fv("u_normalized_origin",h.tileTransform.displayCoord),this._sdfProgram.setUniform1f("u_depth",k.z),this._sdfProgram.setUniform2fv("u_mosaicSize",this._glyphTextureSize),this._sdfProgram.setUniform1f("u_mapRotation",e),this._sdfProgram.setUniform1f("u_keepUpright",B?1:0),this._sdfProgram.setUniform1f("u_level",
10*d),this._sdfProgram.setUniform1f("u_fadeSpeed",10*g.fadeSpeed),this._sdfProgram.setUniform1f("u_minfadeLevel",10*g.minfadeLevel),this._sdfProgram.setUniform1f("u_maxfadeLevel",10*g.maxfadeLevel),this._sdfProgram.setUniform1f("u_fadeChange",10*(d+g.fadeChange)),this._sdfProgram.setUniform1f("u_opacity",A),this._sdfProgram.setUniform1i("u_texture",0),g=k.getPaintValue("text-halo-color",d),0<g[3]&&(this._haloColor[0]=g[0],this._haloColor[1]=g[1],this._haloColor[2]=g[2],this._haloColor[3]=g[3]*A,g=
y+k.getPaintValue("text-halo-blur",d)/z/8,z=0.75-k.getPaintValue("text-halo-width",d)/z/8,this._sdfProgram.setUniform4fv("u_color",this._haloColor),this._sdfProgram.setUniform1f("u_edgeDistance",z),this._sdfProgram.setUniform1f("u_edgeWidth",g),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart)),d=k.getPaintValue("text-color",d),0<d[3]&&(this._sdfColor[0]=d[0],this._sdfColor[1]=d[1],this._sdfColor[2]=d[2],this._sdfColor[3]=d[3]*A,this._sdfProgram.setUniform4fv("u_color",this._sdfColor),
this._sdfProgram.setUniform1f("u_edgeDistance",0.75),this._sdfProgram.setUniform1f("u_edgeWidth",y),b.drawElements(4,c.textElementCount,5125,12*c.textElementStart),b.bindVAO())};k.prototype._initialize=function(a){if(this._initialized)return!0;this._sdfProgram=new g(a,d,e,this._attributeLocations);this._sdfVertexAttributes={geometry:[{name:"a_pos",count:2,type:5122,offset:0,stride:16,normalized:!1,divisor:0},{name:"a_vertexOffset",count:2,type:5122,offset:4,stride:16,normalized:!1,divisor:0},{name:"a_tex",
count:4,type:5121,offset:8,stride:16,normalized:!1,divisor:0},{name:"a_levelInfo",count:4,type:5121,offset:12,stride:16,normalized:!1,divisor:0}]};return this._initialized=!0};k.prototype._getSDFVAO=function(a,b){if(b.textVertexArrayObject)return b.textVertexArrayObject;var c=b.textVertexBuffer,d=b.textIndexBuffer;if(!c||!d)return null;b.textVertexArrayObject=new h(a,this._attributeLocations,this._sdfVertexAttributes,{geometry:c},d);return b.textVertexArrayObject};return k}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/TileInfoRenderer":function(){define("require exports dojo/text!./shaders/background.vs.glsl dojo/text!./shaders/background.fs.glsl dojo/text!./shaders/tileInfo.vs.glsl dojo/text!./shaders/tileInfo.fs.glsl ../../webgl/Program ../../webgl/VertexArrayObject ../../webgl/BufferObject ../../webgl/Texture ../GeometryUtils".split(" "),
function(l,f,a,b,c,d,e,g,h,m,k){return function(){function f(){this._initialized=!1;this._maxWidth=0;this._color=new Float32Array([1,0,0,1])}f.prototype.render=function(a,b){this._initialized||this._initialize(a);a.bindVAO(this._outlineVertexArrayObject);a.bindProgram(this._outlineProgram);this._outlineProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform);this._outlineProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord);this._outlineProgram.setUniform1f("u_coord_range",
b.coordRange);this._outlineProgram.setUniform1f("u_depth",0);this._outlineProgram.setUniform4fv("u_color",this._color);a.setLineWidth(2);a.drawArrays(3,0,4);a.bindVAO();var c=this._getTexture(a,b);c&&(a.bindVAO(this._tileInfoVertexArrayObject),a.bindProgram(this._tileInfoProgram),a.bindTexture(c,0),this._tileInfoProgram.setUniformMatrix4fv("u_transformMatrix",b.tileTransform.transform),this._tileInfoProgram.setUniform2fv("u_normalized_origin",b.tileTransform.displayCoord),this._tileInfoProgram.setUniform1f("u_depth",
0),this._tileInfoProgram.setUniform1f("u_coord_ratio",b.coordRange/512),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",c.descriptor.width,c.descriptor.height),a.drawArrays(5,0,4),a.bindVAO())};f.prototype._initialize=function(k){if(this._initialized)return!0;var f={a_pos:0},m=new e(k,a,b,f),n=new e(k,c,d,f),l={geometry:[{name:"a_pos",count:2,type:5120,offset:0,stride:2,normalized:!1,divisor:0}]},t=new Int8Array([0,0,1,0,1,1,0,1]),t=h.createVertex(k,
35044,t),t=new g(k,f,l,{geometry:t}),u=new Int8Array([0,0,1,0,0,1,1,1]),u=h.createVertex(k,35044,u);k=new g(k,f,l,{geometry:u});this._outlineProgram=m;this._tileInfoProgram=n;this._vertexAttributes=l;this._outlineVertexArrayObject=t;this._tileInfoVertexArrayObject=k;return this._initialized=!0};f.prototype._getTexture=function(a,b){if(b.texture)return b.texture;this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","canvas2d"),this._canvas.setAttribute("width",
"256"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));var c=b.key.id,d=this._canvas.getContext("2d");d.font="24px sans-serif";d.textAlign="left";d.textBaseline="middle";var e=d.measureText(c),e=Math.pow(2,Math.ceil(k.log2(e.width+2)));e>this._maxWidth&&(this._maxWidth=e);d.clearRect(0,0,this._maxWidth,32);d.fillStyle=b.key.level>b.refKey.level?"red":"blue";d.fillText(c,0,16);b.texture=new m(a,{target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728},
this._canvas);return b.texture};return f}()})},"esri/layers/vectorTiles/views/webgl/Texture":function(){define(["require","exports"],function(l,f){return function(){function a(b,c,d){this._glName=this._context=null;this._id=-1;this._desc=void 0;this._wrapModeDirty=this._samplingModeDirty=!1;this._context=b;this._desc={pixelFormat:c.pixelFormat,dataType:c.dataType,target:c.target?c.target:3553,samplingMode:c.samplingMode?c.samplingMode:9729,wrapMode:c.wrapMode?c.wrapMode:10497,maxAnisotropy:c.maxAnisotropy,
flipped:void 0!==c.flipped?c.flipped:!1,hasMipmap:void 0!==c.hasMipmap?c.hasMipmap:!1,level:void 0!==c.level?c.level:0,unpackAlignment:c.unpackAlignment?c.unpackAlignment:4,width:c.width,height:c.height};this._id=++a._nextId;this.setData(d)}Object.defineProperty(a.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"descriptor",
{get:function(){return this._desc},enumerable:!0,configurable:!0});a.prototype.dispose=function(){this._context&&this._glName&&(this._context.gl.deleteTexture(this._glName),this._glName=null)};a.prototype.resize=function(a,c){var d=this._desc;d.width===a&&d.height===c||(d.width=a,d.height=c,this.setData(null))};a.prototype.setData=function(b){var c=this._context.gl;this._glName||(this._glName=c.createTexture());void 0===b&&(b=null);null===b&&(this._desc.width=this._desc.width||4,this._desc.height=
this._desc.height||4);var d=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var e=this._desc;a._validateTexture(e);c.pixelStorei(c.UNPACK_ALIGNMENT,e.unpackAlignment);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,e.flipped?1:0);b instanceof ImageData||b instanceof HTMLImageElement||b instanceof HTMLCanvasElement||b instanceof HTMLVideoElement?(e.width&&e.height&&console.assert(b.width===e.width&&b.height===e.height),c.texImage2D(c.TEXTURE_2D,e.level,e.pixelFormat,e.pixelFormat,e.dataType,
b),void 0===this._desc.width&&(this._desc.width=b.width),void 0===this._desc.height&&(this._desc.height=b.height)):((null==e.width||null==e.height)&&console.error("Width and height must be specified!"),c.texImage2D(c.TEXTURE_2D,e.level,e.pixelFormat,e.width,e.height,0,e.pixelFormat,e.dataType,b));e.hasMipmap&&this.generateMipmap();a._applySamplingMode(c,this._desc);a._applyWrapMode(c,this._desc);a._applyAnisotropicFilteringParameters(this._context,this._desc);this._context.bindTexture(d,0)};a.prototype.updateData=
function(a,c,d,e,g,h){h||console.error("An attempt to use uninitialized data!");this._glName||console.error("An attempt to update uninitialized texture!");var f=this._context.gl,k=this._desc;this._context.bindTexture(this);(0>c||0>d||e>k.width||g>k.height||c+e>k.width||d+g>k.height)&&console.error("An attempt to update out of bounds of the texture!");h instanceof ImageData||h instanceof HTMLImageElement||h instanceof HTMLCanvasElement||h instanceof HTMLVideoElement?(console.assert(h.width===e&&h.height===
g),f.texSubImage2D(f.TEXTURE_2D,a,c,d,k.pixelFormat,k.dataType,h)):f.texSubImage2D(f.TEXTURE_2D,a,c,d,e,g,k.pixelFormat,k.dataType,h)};a.prototype.generateMipmap=function(){var b=this._desc;b.hasMipmap||(b.hasMipmap=!0,a._validateTexture(b));9729===b.samplingMode?(this._samplingModeDirty=!0,b.samplingMode=9985):9728===b.samplingMode&&(this._samplingModeDirty=!0,b.samplingMode=9984);b=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var c=this._context.gl;c.generateMipmap(c.TEXTURE_2D);
this._context.bindTexture(b,0)};a.prototype.setSamplingMode=function(b){b!==this._desc.samplingMode&&(this._desc.samplingMode=b,a._validateTexture(this._desc),this._samplingModeDirty=!0)};a.prototype.setWrapMode=function(b){b!==this._desc.wrapMode&&(this._desc.wrapMode=b,a._validateTexture(this._desc),this._wrapModeDirty=!0)};a.prototype.applyChanges=function(){var b=this._context.gl,c=this._desc;this._samplingModeDirty&&(a._applySamplingMode(b,c),this._samplingModeDirty=!1);this._wrapModeDirty&&
(a._applyWrapMode(b,c),this._wrapModeDirty=!1)};a._isPowerOfTwo=function(a){return 0===(a&a-1)};a._validateTexture=function(b){(0>b.width||0>b.height)&&console.error("Negative dimension parameters are not allowed!");if(!a._isPowerOfTwo(b.width)||!a._isPowerOfTwo(b.height))33071!==b.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),b.hasMipmap&&console.error("Mipmapping requires power-of-two textures!")};a._applySamplingMode=function(a,c){var d=c.samplingMode;
if(9985===d||9987===d)d=9729;else if(9984===d||9986===d)d=9728;a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,d);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,c.samplingMode)};a._applyWrapMode=function(a,c){a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,c.wrapMode);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,c.wrapMode)};a._applyAnisotropicFilteringParameters=function(a,c){if(null!=c.maxAnisotropy){var d=a.extensions.textureFilterAnisotropic;if(d){var e=a.gl;e.texParameterf(e.TEXTURE_2D,d.TEXTURE_MAX_ANISOTROPY_EXT,
c.maxAnisotropy)}}};a._nextId=0;return a}()})},"esri/layers/vectorTiles/views/vectorTiles/renderers/FadeRecorder":function(){define(["require","exports","../../../core/now"],function(l,f,a){(function(){return function(a,c){this.level=a;this.now=c}})();l=function(){return function(a,c,d,e){this.fadeSpeed=a;this.minfadeLevel=c;this.maxfadeLevel=d;this.fadeChange=e}}();f.FadeProperties=l;l=function(){function b(a){void 0===a&&(a=300);this._levelSnapshots=[];this._duration=a}b.prototype.recordLevel=function(b){var d=
a(),e=this._levelSnapshots;0===e.length&&(e.push({level:b,now:0}),e.push({level:b,now:0}));(2===e.length||e[0].level!==b)&&e.push({level:b,now:d})};b.prototype.needsRedraw=function(){if(0===this._levelSnapshots.length)return!1;for(var a=this._duration,b=this._levelSnapshots,e=b.length,g=b[e-1],h=-1;e>h+1&&b[h+1].now+a<g.now;)h++;for(0>h&&(h=0);h<e;h++)if(b[h].level!==g.level)return!0;return!1};b.prototype.getFadeValues=function(){for(var b=this._duration,d=a(),e=this._levelSnapshots;3<e.length&&e[1].now+
b<d;)e.shift();e[1].now+b<d&&(e[0].level=e[1].level);var g=e[0].level,h=e[e.length-1],f=h.level,k=Math.min(g,f),g=Math.max(g,f),e=(h.level-e[1].level)/((h.now-e[1].now)/b);return{fadeSpeed:e,minfadeLevel:k,maxfadeLevel:g,fadeChange:(d-h.now)/b*e}};return b}();f.FadeRecorder=l})},"esri/layers/vectorTiles/core/now":function(){define(["require","exports"],function(l,f){var a=Function("return this")();return function(){var b=a.performance||{};if(b.now)return function(){return b.now()};if(b.webkitNow)return function(){return b.webkitNow()};
if(b.mozNow)return function(){return b.mozNow()};if(b.msNow)return function(){return b.msNow()};if(b.oNow)return function(){return b.oNow()};var c;c=b.timing&&b.timing.navigationStart?b.timing.navigationStart:Date.now();return function(){return Date.now()-c}}()})},"esri/layers/vectorTiles/views/vectorTiles/StencilClipGenerator":function(){define(["require","exports","./GeometryUtils"],function(l,f,a){var b=function(){function a(b){this.children=[];this.stageTile=b}a.prototype.tryAdd=function(b){if(a.isChildOf(b,
this.stageTile.key)){for(var e=0,g=this.children;e<g.length;e++)if(a.isChildOf(b,g[e]))return;this.children.push(b)}};a.prototype.equals=function(a){if(this.stageTile.key.id!==a.stageTile.key.id||this.children.length!==a.children.length)return!1;for(var b=0;b<this.children.length;b++)if(this.children[b].id!==a.children[b].id)return!1;return!0};a.isChildOf=function(a,b){if(a.level<=b.level)return!1;var c=a.level-b.level,h=a.col>>c;return a.row>>c===b.row&&h===b.col};return a}();return function(){function c(){this._tileGroups=
[];this._bitOffset=0}c.prototype.update=function(c){this._tileGroups=[];this._bitOffset=0;if(0!==c.length){for(var e=[],g=c.length,h=0;h<g;h++)if(c[h].attached&&c[h].visible){for(var f=new b(c[h]),k=h+1;k<g;k++)f.tryAdd(c[k].key);f.children.sort(function(a,b){return a.level<b.level?-1:1});this._reuseExisting(f)||e.push(f)}if(0<e.length){c=Math.ceil(a.log2(e.length+1));g=(1<<c)-1<<this._bitOffset;h=1;f=void 0;for(k=0;k<e.length;k++){var n=e[k],f=h++<<this._bitOffset;n.stageTile.stencilData.mask=g;
n.stageTile.stencilData.reference=f}this._bitOffset+=c;this._tileGroups.push(e)}}};c.prototype._reuseExisting=function(a){for(var b=0,c=this._tileGroups;b<c.length;b++)for(var h=0,f=c[b];h<f.length;h++){var k=f[h];if(k.equals(a)&&k.stageTile.stencilData.mask===a.stageTile.stencilData.mask&&k.stageTile.stencilData.reference===a.stageTile.stencilData.reference)return!0}return!1};return c}()})},"esri/layers/vectorTiles/views/vectorTiles/TileHandler":function(){define("require exports module dojo/Deferred dojo/promise/all ../../core/workers ../../core/promiseUtils ../../core/requireUtils ../../request ../2d/layers/support/TileKey ./TileIndex ./SpriteMosaic ./SpriteSource ./GlyphMosaic ./GlyphSource ./VectorTileDisplayObject ./GeometryUtils".split(" "),
function(l,f,a,b,c,d,e,g,h,m,k,n,p,x,q,r,s){return function(){function f(a,b){this._tileIndex=this._connection=this._glyphMosaic=this._spriteMosaic=null;this._vectorTileLayer=a;this._requestUpdate=b;this.devicePixelRatio=window.devicePixelRatio||1}f.prototype.destroy=function(){this.stop();this._vectorTileLayer=this._requestUpdate=null};Object.defineProperty(f.prototype,"spriteMosaic",{get:function(){return this._spriteMosaic},enumerable:!0,configurable:!0});Object.defineProperty(f.prototype,"glyphMosaic",
{get:function(){return this._glyphMosaic},enumerable:!0,configurable:!0});f.prototype.start=function(){var e=this;this.stop();var h=this._vectorTileLayer.styleRepository,f=new p(h.sprite,this.devicePixelRatio);f.devicePixelRatio=devicePixelRatio;var k=f.load().then(function(){e._spriteMosaic=new n(1024,1024);e._spriteMosaic.setSpriteSource(f)}),m=new q(h.glyphs);this._glyphMosaic=new x(1024,1024,m);var r=this._fetchTileMap(this._vectorTileLayer.tileIndexUrl),s=d.open(this,g.getAbsMid("./WorkerTileHandler",
l,a)).then(function(a){e._connection=a}),t=new b(function(a){k.isFulfilled()||k.cancel();r.isFulfilled()||r.cancel();s.isFulfilled()||s.cancel()});c([k,r,s]).then(function(a){c(e._connection.broadcast("setLayers",h.styleJSON)).then(function(){t.resolve()})});return this._broadcastPromise=t.promise};f.prototype.stop=function(){this._broadcastPromise&&!this._broadcastPromise.isFulfilled()&&this._broadcastPromise.cancel();this._connection&&(this._connection.close(),this._connection=null)};f.prototype.updateTile=
function(a,b){if(!this._broadcastPromise.isFulfilled()||!this._connection)return e.reject(Error("no connection"));var c=Math.round(s.degToByte(b.state.rotation));if(a.rotation===c)return null;a.rotation=c;return this._connection.invoke("update",{key:a.id,rotation:c},[],{id:a.workerID}).then(function(b){a.updateSymbolData(b);return a})};f.prototype.getVectorTile=function(a,b){var c=this;if(!this._broadcastPromise.isFulfilled()||!this._connection)return e.reject(Error("no connection"));var d=this._vectorTileLayer.tileInfo,
g=Math.round(b.state.rotation);if(d.lods.length<=a.level)return e.reject("Cannot create tile for the requested level");var h=this._tileIndex?this._tileIndex.dataKey(a):a;return!h?e.reject(Error("no data")):this._getTileData(this._connection,a,h,g).then(function(e){var g=d.size[0]*d.lods[a.level].resolution,f=d.origin,k=f.x+a.col*g+a.world*c._vectorTileLayer.fullExtent.width,m=k+g,f=f.y-a.row*g,g=f-g;c._requestUpdate();return new r(a,h,[k,f,m,g],c._vectorTileLayer.tileInfo.size[1],4096,Math.round(s.degToByte(b.state.rotation)),
e.tileData,c._vectorTileLayer.styleRepository,c._glyphMosaic,e.workerId,c._connection)}).otherwise(function(a){return e.reject(a)})};f.prototype.fetchTileData=function(a){a=m.fromId(a);a=this._vectorTileLayer.getTileUrl(a.level,a.row,a.col);return h(a,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){return{data:{protobuff:a.data},buffers:[a.data]}})};f.prototype.getSprites=function(a){return e.resolve({data:{spriteItems:this._spriteMosaic.getSpriteItems(a.sprites)}})};
f.prototype.getGlyphs=function(a){return this._glyphMosaic.getGlyphItems(a.tileID,a.font,a.codePoints).then(function(a){return{data:{glyphItems:a}}})};f.prototype.getStyleRepository=function(){return this._vectorTileLayer.styleRepository};f.prototype.getTileIndex=function(){return this._tileIndex};f.prototype._getTileData=function(a,b,c,d){var e={id:null};return this._connection.invoke("getTile",{key:b.id,refKey:c.id,rotation:d},[],e).then(function(a){return{tileData:a,workerId:e.id}})};f.prototype._fetchTileMap=
function(a){var b=this;return!a?null:h(a,{callbackParamName:"callback",responseType:"json"}).then(function(a){b._tileIndex=new k(a.data)})};return f}()})},"esri/layers/vectorTiles/core/workers":function(){define("require exports dojo/Deferred dojo/promise/all ./promiseUtils ./workers/Connection ./workers/JobProxy".split(" "),function(l,f,a,b,c,d,e){function g(a,c){for(var d=[],e=0,g=p.length;e<g;e++)d.push(p[e].openConnection(a,c));return b(d).then(function(a){})}function h(a){x[a]=!0;if(!n&&x.every(function(a){return a})){for(var b in t)(a=
s[b])&&t[b].resolve(a);t={};n=!0}}function m(b){var c=r++;b=new d(b,c);var e=new a;s[c]=b;n?e.resolve(b):t[c]=e;return e.promise}var k=Math.max((navigator.hardwareConcurrency||2)-1,2),n=!1,p=[],x=[],q=0,r=0,s={},t={},u=!1;f.open=function(a,b){if(!1===u){for(var d=0;d<k;++d){var f=new e(s,d,h);p.push(f);x.push(!1)}u=!0}return m(a).then(function(a){return g(b,a.id).then(function(){return a}).otherwise(function(a){return c.reject(a)})})};f.terminate=function(){for(var a=0,b=p.length;a<b;a++)p[a].terminate();
p=[];x=[];n=!1};f.closeConnection=function(a){if(a)if(s[a.id]&&delete s[a.id],n)for(var b=0,c=p.length;b<c;b++)p[b].closeConnection(a.id);else if(b=t[a.id])b.promise.cancel(),delete t[a.id]};f.invoke=function(a,b,d,e,g){var h=null;e&&(h=e.id);if(null===h&&(h=q=(q+1)%p.length,!x[h]&&!p.some(function(a,b,c){h=(h+1)%c.length;return x[h]})))return c.reject(Error("No worker available"));a=p[h].invoke(a,b,d,g);e&&(e.id=h);return a};f.broadcast=function(a,b,c,d){for(var e=[],g=0,h=p.length;g<h;g++)x[g]&&
e.push(p[g].invoke(a,b,c,d));return e}})},"esri/layers/vectorTiles/core/workers/Connection":function(){define(["require","exports","../workers"],function(l,f,a){return function(){function b(a,b){this.client=a;this.id=b}b.prototype.invoke=function(b,d,e,g){return a.invoke(b,d,e,g,this.id)};b.prototype.broadcast=function(b,d,e){return a.broadcast(b,d,e,this.id)};b.prototype.close=function(){a.closeConnection(this)};return b}()})},"esri/layers/vectorTiles/core/workers/JobProxy":function(){define("require exports dojo/_base/kernel dojo/_base/url dojo/Deferred ../../kernel ../../config ../../request ../urlUtils".split(" "),
function(l,f,a,b,c,d,e,g,h){function m(){if(!x){var a=new c,d=new Worker(k);d.onerror=function(a){a.preventDefault()};a.resolve(d);return a.promise}q||(a=new b(k),e.defaults?e.defaults.io.corsEnabledServers.push(a.host):e.request.corsEnabledServers.push(a.host),q=g(k,{responseType:"text"}));return q.then(function(a){a=new Worker(URL.createObjectURL(new Blob([a.data],{type:"text/javascript"})));a.onerror=function(a){a.preventDefault()};return a})}var k=h.makeAbsolute(l.toUrl("./worker.js")),n=h.makeAbsolute(l.toUrl("./worker-init.js")),
p=h.makeAbsolute("../../../../../../",n)+"/",x=!h.hasSameOrigin(k,location.href),q=null;return function(){function b(a,c,d){var e=this;this.connections=a;this.index=c;this.workerInitCallback=d;this.msgCount=0;this.outgoingJobs={};this.incomingJobs={};this.incomingStaticJobs={};m().then(function(a){e.worker=a;e.worker.addEventListener("message",e.message.bind(e),!1)})}b.prototype.terminate=function(){this.worker.terminate()};b.prototype.openConnection=function(a,b){return this.invoke("\x3copen-connection\x3e",
{path:a},void 0,b)};b.prototype.closeConnection=function(a){this.invoke("\x3cclose-connection\x3e",void 0,void 0,a)};b.prototype.postConfigMessage=function(b){b=JSON.parse(JSON.stringify(b));this.worker.postMessage({type:"\x3cconfigure\x3e",configure:{esriConfig:b,dojoConfig:{async:!0,baseUrl:p,locale:a.locale,has:{"esri-cors":1,"dojo-test-sniff":0,"config-deferredInstrumentation":0},paths:{esri:"esri",dojo:"dojo",dojox:"dojox",dstore:"dstore",moment:"moment"}},loaderUrl:n}})};b.prototype.invoke=
function(a,b,d,e){var g=this,h=++this.msgCount,f=new c(function(a){g.worker.postMessage({type:"\x3ccancel\x3e",id:h,connection:e,data:{reason:a}});g.outgoingJobs[h]&&delete g.outgoingJobs[h]});this.outgoingJobs[h]=f;this.worker.postMessage({type:a,id:h,connection:e,data:b},d);return f.promise};b.prototype.message=function(a){var b=this;if(a&&a.data){var c=a.data.type;if(c){var g=a.data,h=a.data.id;if("\x3cresponse\x3e"===c&&h){if(a=this.outgoingJobs[h])delete this.outgoingJobs[h],g.error?a.reject(g.error):
a.resolve(g.data)}else if("\x3cworker-loaded\x3e"===c)this.postConfigMessage(e);else if("\x3cworker-configured\x3e"===c)this.workerInitCallback&&("function"===typeof this.workerInitCallback&&"number"===typeof this.index)&&this.workerInitCallback(this.index);else if("\x3ccancel\x3e"===c&&h)(a=this.incomingJobs[h])&&a.cancel(g.data.reason),g.staticMsg&&(a=this.incomingStaticJobs[h])&&a.cancel(g.data.reason);else if("\x3cstatic-message\x3e"===c){var f=g.staticMsg;a=d.workerMessages[f];!a||"function"!==
typeof a?this.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:f,id:h,error:a+" message type is not available on the kernel!"}):(g=a.call(this,g.data),this.incomingStaticJobs[h]=g,g.then(function(a){b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:f,id:h,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+f);(!a.dojoType||"cancel"!==a.dojoType)&&b.worker.postMessage({type:"\x3cstatic-message\x3e",staticMsg:f,id:h,error:a})}).always(function(){delete b.incomingStaticJobs[h]}))}else{var k=
g.connection;if(a=this.connections[k])if(a=a.client){var m=a[c];"function"===typeof m&&(g=m.call(a,g.data),this.incomingJobs[h]=g,g.then(function(a){b.worker.postMessage({type:"\x3cresponse\x3e",id:h,connection:k,error:a.error,data:a.data},a.buffers)}).otherwise(function(a){a||(a="Error encountered at method"+c);(!a.dojoType||"cancel"!==a.dojoType)&&b.worker.postMessage({type:"\x3cresponse\x3e",id:h,connection:k,error:a})}).always(function(){delete b.incomingJobs[h]}))}}}}};return b}()})},"esri/layers/vectorTiles/kernel":function(){define(["require",
"exports"],function(l,f){f.workerMessages={}})},"esri/layers/vectorTiles/config":function(){define(["require","exports","esri/config"],function(l,f,a){return a})},"esri/layers/vectorTiles/core/requireUtils":function(){define(["require","exports","dojo/Deferred"],function(l,f,a){function b(c,d){if(Array.isArray(d)){var e=new a;c(d,function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];e.resolve(a)});return e.promise}return b(c,[d]).then(function(a){return a[0]})}f.when=b;f.getAbsMid=
function(a,b,e){return b.toAbsMid?b.toAbsMid(a):e.id.replace(/\/[^\/]*$/ig,"/")+a}})},"esri/layers/vectorTiles/views/2d/layers/support/TileKey":function(){define(["require","exports"],function(l,f){return function(){function a(a,c,d,e){this.level=a;this.row=c;this.col=d;this.world=e}a.from=function(b,c,d,e){var g=typeof b;return"object"===g?b:"string"===g?a.fromId(b):new a(b,c,d,e)};a.fromId=function(b){b=b.split("/");var c=b[1],d=b[2],e=b[3];return new a(parseFloat(b[0]),parseFloat(c),parseFloat(d),
parseFloat(e))};a.getId=function(a,c,d,e){return"object"===typeof a?a.level+"/"+a.row+"/"+a.col+"/"+a.world:a+"/"+c+"/"+d+"/"+e};Object.defineProperty(a.prototype,"id",{get:function(){return a.getId(this)},enumerable:!0,configurable:!0});return a}()})},"esri/layers/vectorTiles/views/vectorTiles/TileIndex":function(){define(["require","exports","../2d/layers/support/TileKey"],function(l,f,a){return function(){function b(a){this._tilemap=a.index}b.prototype.dataKey=function(b){for(var d=[b];0!==b.level;)b=
new a(b.level-1,b.row>>1,b.col>>1,b.world),d.push(b);b=this._tilemap;for(var e=d.pop(),g,h;d.length;){g=d.pop();h=e.level+1;var f=2*e.row,k=2*e.col;h=[a.getId(h,f,k,g.world),a.getId(h,f,k+1,g.world),a.getId(h,f+1,k,g.world),a.getId(h,f+1,k+1,g.world)].indexOf(g.id);if(b)if(0===b[h]){e=null;break}else if(1===b[h]){e=g;break}else e=g,b=b[h]}return e};b.prototype.forEach=function(a,b,e,g,h){this._callback=h;this._maxLevel=b+a;this._forEach(this._tilemap,b,e,g)};b.prototype._forEach=function(a,b,e,g){0!==
a&&(this._callback(b,e,g),b!==this._maxLevel&&"object"===typeof a&&(this._forEach(a[0],b+1,2*e,2*g),this._forEach(a[1],b+1,2*e,2*g+1),this._forEach(a[2],b+1,2*e+1,2*g),this._forEach(a[3],b+1,2*e+1,2*g+1)))};return b}()})},"esri/layers/vectorTiles/views/vectorTiles/SpriteMosaic":function(){define(["require","exports","./Rect","./RectangleBinPack","../webgl/Texture"],function(l,f,a,b,c){return function(){function d(a,c){this._height=this._width=0;this._mosaicRects={};this._dirty=!1;this.pixelRatio=
1;(0>=a||0>=c)&&console.error("Sprites mosaic width and height must be greater than zero!");this._width=a;this._height=c;this._binPack=new b(a,c)}Object.defineProperty(d.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0});Object.defineProperty(d.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0});d.prototype.setSpriteSource=function(a){this._dispose();this.pixelRatio=a.devicePixelRatio;this._mosaicData||(this._binPack=new b(this._width,
this._height),this._mosaicData=new Uint32Array(Math.floor(this._width)*Math.floor(this._height)));this._sprites=a};d.prototype.getSpriteItem=function(a,b){void 0===b&&(b=!1);var c=this._mosaicRects[a];if(c)return c;if(!this._sprites||"loaded"!==this._sprites.loadStatus)return null;var d=this._sprites.getSpritePosition(a);if(!d||!d.width||!d.height)return null;var f=this._allocateImage(d.width,d.height);if(0>=f.width)return null;c={rect:f,width:d.width,height:d.height,sdf:d.sdf,pixelRatio:d.pixelRatio};
this._copy(f,d,b);return this._mosaicRects[a]=c};d.prototype.getSpriteItems=function(a){for(var b={},c=0;c<a.length;c++){var d=a[c];b[d]=this.getSpriteItem(d)}return b};d.prototype.getMosaicItemPosition=function(a,b){var c=this.getSpriteItem(a,b),d=c&&c.rect;if(!d)return null;d.width=c.width;d.height=c.height;return{size:[c.width,c.height],tl:[(d.x+1)/this._width,(d.y+1)/this._height],br:[(d.x+1+c.width)/this._width,(d.y+1+c.height)/this._height]}};d.prototype.bind=function(a,b,d){void 0===d&&(d=
0);this._texture||(this._texture=new c(a,{pixelFormat:6408,dataType:5121,width:this._width,height:this._height},new Uint8Array(this._mosaicData.buffer)));this._texture.setSamplingMode(b);a.bindTexture(this._texture,d);this._dirty&&this._texture.updateData(0,0,0,this._width,this._height,new Uint8Array(this._mosaicData.buffer));this._dirty=!1};d._copyBits=function(a,b,c,d,f,n,p,l,q,r){c=d*b+c;p=l*n+p;for(l=0;l<r;l++){for(d=0;d<q;d++)f[p+d]=a[c+d];c+=b;p+=n}};d.prototype._copy=function(a,b,c){if(this._sprites&&
"loaded"===this._sprites.loadStatus){c=new Uint32Array(this._sprites.image.buffer);var f=this._mosaicData;(!f||!c)&&console.error("Source or target images are uninitialized!");d._copyBits(c,this._sprites.width,b.x,b.y,f,this._width,a.x+1,a.y+1,b.width,b.height);this._dirty=!0}};d.prototype._allocateImage=function(b,c){b+=2;c+=2;var d=this._binPack.allocate(b+(b%4?4-b%4:0),c+(c%4?4-c%4:0));0>=d.width&&(console.warn("Out of sprite mosaic space!"),d=new a(0,0,0,0));return d};d.prototype._dispose=function(){this._binPack=
this._mosaicData=null;this._mosaicRects={};this._dirty=!0};return d}()})},"esri/layers/vectorTiles/views/vectorTiles/Rect":function(){define(["require","exports"],function(l,f){return function(){function a(a,c,d,e){void 0===a&&(a=0);void 0===c&&(c=0);void 0===d&&(d=0);void 0===e&&(e=0);this.x=a;this.y=c;this.width=d;this.height=e}Object.defineProperty(a.prototype,"isEmpty",{get:function(){return 0>=this.width||0>=this.height},enumerable:!0,configurable:!0});return a}()})},"esri/layers/vectorTiles/views/vectorTiles/RectangleBinPack":function(){define(["require",
"exports","./Rect"],function(l,f,a){return function(){function b(b,d){this._height=this._width=0;this._free=[];this._width=b;this._height=d;this._free.push(new a(0,0,b,d))}b.prototype.allocate=function(b,d){for(var e=null,g=-1,h=0;h<this._free.length;++h){var f=this._free[h];if(b<=f.width&&d<=f.height&&(null===e||f.y<=e.y&&f.x<=e.x))e=f,g=h}if(null===e)return new a;this._free.splice(g,1);e.width<e.height?(e.width>b&&this._free.push(new a(e.x+b,e.y,e.width-b,d)),e.height>d&&this._free.push(new a(e.x,
e.y+d,e.width,e.height-d))):(e.width>b&&this._free.push(new a(e.x+b,e.y,e.width-b,e.height)),e.height>d&&this._free.push(new a(e.x,e.y+d,b,e.height-d)));return new a(e.x,e.y,b,d)};b.prototype.release=function(a){for(var b=this._free.length,e=0;e<b;++e){var g=this._free[e];if(g.y===a.y&&g.height===a.height&&g.x+g.width===a.x)g.width+=a.width;else if(g.x===a.x&&g.width===a.width&&g.y+g.height===a.y)g.height+=a.height;else if(a.y===g.y&&a.height===g.height&&a.x+a.width===g.x)g.x=a.x,g.width+=a.width;
else if(a.x===g.x&&a.width===g.width&&a.y+a.height===g.y)g.y=a.y,g.height+=a.height;else continue;this._free.splice(e,1);this.release(a)}this._free.push(a)};return b}()})},"esri/layers/vectorTiles/views/vectorTiles/SpriteSource":function(){define("require exports ../../core/tsSupport/extendsHelper ../../core/tsSupport/decorateHelper dojo/Deferred dojo/promise/all ../../request ../../identity/IdentityManager ../../core/promiseUtils".split(" "),function(l,f,a,b,c,d,e,g,h){return function(){function a(b,
c){this.baseURL=b;this.devicePixelRatio=c;this._isRetina=!1;this._spritesData={};this.height=this.width=this.image=null;this.loadStatus="not-loaded"}a.prototype.getSpritePosition=function(a){return this._spritesData[a]};a.prototype.load=function(){var a=this;this.loadStatus="loading";return this._loadSprites().then(function(){a.loadStatus="loaded";return a}).otherwise(function(b){a.loadStatus="failed";return h.reject(b)})};a.prototype._loadSprites=function(){var a=this;this._isRetina=1.15<this.devicePixelRatio?
!0:!1;var b=this.baseURL,h=this._isRetina?"@2x":"",f=e(b+h+".json",{callbackParamName:"callback",responseType:"json"}).then(function(b){a._spritesData=b.data}),m=new c,l=new Image;l.crossOrigin="anonymous";l.onload=function(){l.onload=null;a.width=l.width;a.height=l.height;var b=document.createElement("canvas");b.width=l.width;b.height=l.height;b=b.getContext("2d");b.drawImage(l,0,0,l.width,l.height);b=b.getImageData(0,0,l.width,l.height);a.image=new Uint8Array(b.data);m.resolve()};b=""+b+h+".png";
(h=g.findCredential(b))&&h.token&&(b+="?token\x3d"+h.token);l.src=b;return d([f,m.promise])};return a}()})},"esri/layers/vectorTiles/identity/IdentityManager":function(){define(["require","exports","esri/IdentityManager"],function(l,f,a){f.findCredential=function(b){return a.findCredential(b)}})},"esri/layers/vectorTiles/views/vectorTiles/GlyphMosaic":function(){define("require exports dojo/promise/all dojo/Deferred ./Rect ../webgl/Texture ./RectangleBinPack".split(" "),function(l,f,a,b,c,d,e){return function(){function g(a,
b,c){this.height=this.width=0;this._dirty=!1;this._glyphIndex={};this._pixelRatio=1;this._rangePromises={};(0>=a||0>=b)&&console.error("Glyph mosaic width and height must be greater than zero!");this.width=a;this.height=b;this._glyphSource=c;this._binPack=new e(a,b);this._glyphData=new Uint8Array(a*b)}g.prototype.getGlyphItems=function(d,e,g){for(var f=this,p=[],l=this._glyphSource,q=new Set,r=1/256,s=0;s<g.length;s++)q.add(Math.floor(g[s]*r));var t=[];q.forEach(function(a){if(256>=a){var c=new b;
t.push(c.promise);var d=e+a,g=f._rangePromises[d];g?g.push(c):(f._rangePromises[d]=[c],l.getRange(e,a).then(function(){var a=f._rangePromises[d];delete f._rangePromises[d];for(var b=0;b<a.length;b++)a[b].resolve()}))}});return a(t).then(function(a){a=f._glyphIndex[e];a||(a={},f._glyphIndex[e]=a);for(var b=0;b<g.length;b++){var q=g[b],r=a[q];if(r)r.tileIDs.add(d),p[q]={rect:r.rect,metrics:r.metrics};else{var s=l.getGlyph(e,q);if(s&&s.metrics){var r=s.metrics,t=void 0;if(0===r.width)t=new c(0,0,0,0);
else{var B=r.width+6,G=r.height+6,t=f._binPack.allocate(B+(B%4?4-B%4:0),G+(G%4?4-G%4:0));0>=t.width&&(t=new c(0,0,0,0));var s=s.bitmap,D=void 0,E=void 0;if(s)for(var C=0;C<G;C++)for(var D=B*C,E=f.width*(t.y+C)+t.x,K=0;K<B;K++)f._glyphData[E+K]=s[D+K]}B=new Set;B.add(d);a[q]={rect:t,metrics:r,tileIDs:B};p[q]={rect:t,metrics:r};f._dirty=!0}}}return p})};g.prototype.removeGlyphs=function(a){for(var b in this._glyphIndex){var c=this._glyphIndex[b];if(c){var d=void 0,e;for(e in c)if(d=c[e],d.tileIDs["delete"](a),
0===d.tileIDs.size){for(var d=d.rect,g=void 0,f=void 0,l=0;l<d.height;l++){g=this.width*(d.y+l)+d.x;for(f=0;f<d.width;f++)this._glyphData[g+f]=0}delete c[e];this._dirty=!0}}}};g.prototype.bind=function(a,b,c){void 0===c&&(c=0);this._texture||(this._texture=new d(a,{pixelFormat:6406,dataType:5121,width:this.width,height:this.height},new Uint8Array(this.width*this.height)));this._texture.setSamplingMode(b);a.bindTexture(this._texture,c);this._dirty&&this._texture.updateData(0,0,0,this.width*this._pixelRatio,
this.height*this._pixelRatio,this._glyphData);this._dirty=!1};return g}()})},"esri/layers/vectorTiles/views/vectorTiles/GlyphSource":function(){define(["require","exports","../../core/promiseUtils","../../request","../../core/pbf"],function(l,f,a,b,c){var d=function(){function a(b){this._metrics=[];for(this._bitmaps=[];b.next();)switch(b.tag()){case 1:for(var c=b.getMessage();c.next();)switch(c.tag()){case 3:for(var d=c.getMessage(),e=void 0,g=void 0,f=void 0,l=void 0,r=void 0,s=void 0,t=void 0;d.next();)switch(d.tag()){case 1:e=
d.getUInt32();break;case 2:g=d.getBytes();break;case 3:f=d.getUInt32();break;case 4:l=d.getUInt32();break;case 5:r=d.getSInt32();break;case 6:s=d.getSInt32();break;case 7:t=d.getUInt32();break;default:d.skip()}e&&(this._metrics[e]={width:f,height:l,left:r,top:s,advance:t},this._bitmaps[e]=g);break;default:c.skip()}break;default:b.skip()}}a.prototype.getMetrics=function(a){return this._metrics[a]};a.prototype.getBitmap=function(a){return this._bitmaps[a]};return a}(),e=function(){function a(){this._ranges=
[]}a.prototype.getRange=function(a){return this._ranges[a]};a.prototype.addRange=function(a,b){this._ranges[a]=b};return a}();return function(){function g(a){this._glyphInfo={};this._baseURL=a}g.prototype.getRange=function(e,g){var f=this._getFontStack(e);if(f.getRange(g))return a.resolve();var n=256*g,p=n+255,n=this._baseURL.replace("{fontstack}",e).replace("{range}",n+"-"+p);return b(n,{callbackParamName:"callback",responseType:"array-buffer"}).then(function(a){f.addRange(g,new d(new c(new Uint8Array(a.data),
new DataView(a.data))))})};g.prototype.getGlyph=function(a,b){var c=this._getFontStack(a);if(c){var d=Math.floor(b/256);if(!(256<d))return c=c.getRange(d),!c?void 0:{metrics:c.getMetrics(b),bitmap:c.getBitmap(b)}}};g.prototype._getFontStack=function(a){var b=this._glyphInfo[a];b||(b=this._glyphInfo[a]=new e);return b};return g}()})},"esri/layers/vectorTiles/core/pbf":function(){define(["require","exports"],function(l,f){return function(){function a(a,c,d,e){this._tag=0;this._dataType=99;this._data=
a;this._dataView=c;this._pos=d||0;this._end=e||a.byteLength}a.prototype.clone=function(){return new a(this._data,this._dataView,this._pos,this._end)};a.prototype.next=function(a){for(;;){if(this._pos===this._end)return!1;var c=this._decodeVarint();this._tag=c>>3;this._dataType=c&7;if(!a||a===this._tag)break;this.skip()}return!0};a.prototype.empty=function(){return this._pos>=this._end};a.prototype.tag=function(){return this._tag};a.prototype.getInt32=function(){return this._decodeVarint()};a.prototype.getInt64=
function(){return this._decodeVarint()};a.prototype.getUInt32=function(){return this._decodeVarint()};a.prototype.getUInt64=function(){return this._decodeVarint()};a.prototype.getSInt32=function(){return this._decodeSVarint()};a.prototype.getSInt64=function(){return this._decodeSVarint()};a.prototype.getBool=function(){var a=0!==this._data[this._pos];this._skip(1);return a};a.prototype.getEnum=function(){return this._decodeVarint()};a.prototype.getFixed64=function(){var a=this._dataView,c=this._pos,
a=a.getUint32(c,!0)+4294967296*a.getUint32(c+4,!0);this._skip(8);return a};a.prototype.getSFixed64=function(){var a=this._dataView,c=this._pos,a=a.getUint32(c,!0)+4294967296*a.getInt32(c+4,!0);this._skip(8);return a};a.prototype.getDouble=function(){var a=this._dataView.getFloat64(this._pos,!0);this._skip(8);return a};a.prototype.getFixed32=function(){var a=this._dataView.getUint32(this._pos,!0);this._skip(4);return a};a.prototype.getSFixed32=function(){var a=this._dataView.getInt32(this._pos,!0);
this._skip(4);return a};a.prototype.getFloat=function(){var a=this._dataView.getFloat32(this._pos,!0);this._skip(4);return a};a.prototype.getString=function(){var a=this._getLength(),c=this._pos,c=this._toString(this._data,c,c+a);this._skip(a);return c};a.prototype.getBytes=function(){var a=this._getLength(),c=this._pos,c=this._toBytes(this._data,c,c+a);this._skip(a);return c};a.prototype.getMessage=function(){var b=this._getLength(),c=this._pos,c=new a(this._data,this._dataView,c,c+b);this._skip(b);
return c};a.prototype.skip=function(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!");}};a.prototype._skip=function(a){if(this._pos+a>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=a};a.prototype._decodeVarint=function(){var a=this._data,c=this._pos,d=0,e;if(10<=this._end-c){if(e=a[c++],d|=e&127,0!==(e&128)&&(e=a[c++],d|=(e&
127)<<7,0!==(e&128)&&(e=a[c++],d|=(e&127)<<14,0!==(e&128)&&(e=a[c++],d|=(e&127)<<21,0!==(e&128)&&(e=a[c++],d+=268435456*(e&127),0!==(e&128)&&(e=a[c++],d+=34359738368*(e&127),0!==(e&128)&&(e=a[c++],d+=4398046511104*(e&127),0!==(e&128)&&(e=a[c++],d+=562949953421312*(e&127),0!==(e&128)&&(e=a[c++],d+=72057594037927936*(e&127),0!==(e&128)&&(e=a[c++],d+=9223372036854775E3*(e&127),0!==(e&128)))))))))))throw Error("Varint too long!");}else{for(var g=1;c!==this._end;){e=a[c];if(0===(e&128))break;++c;d+=(e&
127)*g;g*=128}if(c===this._end)throw Error("Varint overrun!");++c;d+=e*g}this._pos=c;return d};a.prototype._decodeSVarint=function(){var a=this._decodeVarint();return a%2?-(a+1)/2:a/2};a.prototype._getLength=function(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()};a.prototype._toString=function(a,c,d){var e="",g="";for(d=Math.min(this._end,d);c<d;++c){var f=a[c];f&128?g+="%"+f.toString(16):(e+=decodeURIComponent(g)+String.fromCharCode(f),g="")}g.length&&
(e+=decodeURIComponent(g));return e};a.prototype._toBytes=function(a,c,d){d=Math.min(this._end,d);return new Uint8Array(a.buffer,c,d-c)};return a}()})},"esri/layers/vectorTiles/views/vectorTiles/VectorTileDisplayObject":function(){define("require exports ../../core/tsSupport/extendsHelper ../webgl/BufferObject ../2d/engine/DisplayObject ../../core/libs/gl-matrix/vec2 ../../core/libs/gl-matrix/mat4 ./RenderBucket".split(" "),function(l,f,a,b,c,d,e,g){return function(c){function f(a,b,g,m,l,r,s,t,u,
w,v){c.call(this);this._renderBuckets=[];this._symbolUpdateData=this._vectorTileData=null;this.topLeft=[0,0];this.bottomRight=[0,0];this.tileTransform={transform:Float32Array[16],displayCoord:Float32Array[2]};this.stencilData={mask:0,reference:0};this.key=a;this.refKey=b;this.topLeft[0]=g[0];this.topLeft[1]=g[1];this.bottomRight[0]=g[2];this.bottomRight[1]=g[3];this.widthInPixels=m;this.coordRange=l;this.rotation=r;this._vectorTileData=s;this.styleLayers=t;this._glyphsMosaic=u;this.workerID=w;this._connection=
v;this.id=a.id;this.status=3;this.tileTransform.transform=e.create();this.tileTransform.displayCoord=d.create()}a(f,c);f.prototype.updateSymbolData=function(a){a&&(this._symbolUpdateData=a,this.requestRender())};f.prototype.dispose=function(){this._connection&&6!==this.status&&this._connection.broadcast("destructTileData",{key:this.id},[])};f.prototype.attach=function(a){this.status=3;if(!this._vectorTileData)return!1;if(0===this._renderBuckets.length)for(var c=new Uint32Array(this._vectorTileData.bucketDataInfo),
d=c.length,e=0;e<d;){var f=c[e],h=c[e+1];0===h?(h=new g.BackgroundRenderBucket,h.layerID=f,this._renderBuckets.push(h),e+=2):1===h?(h=new g.FillRenderBucket,h.layerID=f,h.triangleElementStart=c[e+2],h.triangleElementCount=c[e+3],h.outlineElementStart=c[e+4],h.outlineElementCount=c[e+5],this._renderBuckets.push(h),e+=6):2===h?(h=new g.LineRenderBucket,h.layerID=f,h.triangleElementStart=c[e+2],h.triangleElementCount=c[e+3],h.joinStart=c[e+4],h.joinCount=c[e+5],this._renderBuckets.push(h),e+=6):3===
h?(h=new g.SymbolRenderBucket,h.layerID=f,h.markerElementStart=c[e+2],h.marketElementCount=c[e+3],h.textElementStart=c[e+4],h.textElementCount=c[e+5],h.isSDF=0!==c[e+6],this._renderBuckets.push(h),e+=7):console.error("Bad bucket type!")}c=a.context;a=a.budget;d=new Uint32Array(this._vectorTileData.bufferDataInfo);e=d.length;for(h=f=0;h<e;h+=2,f++){var m=d[h],l=d[h+1];if(!(0>=l||0===this._vectorTileData.bufferData[f].byteLength)){if(a.done)return!1;switch(m){case 2:this.polygonTrianglesVertexBuffer||
(this.polygonTrianglesVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[f]));break;case 6:this.polygonTrianglesIndexBuffer||(this.polygonTrianglesIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[f],0,l/4)));break;case 3:this.polygonOutlinesVertexBuffer||(this.polygonOutlinesVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[f]));break;case 7:this.polygonOutlinesIndexBuffer||(this.polygonOutlinesIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[f],
0,l/4)));break;case 0:this.lineVertexBuffer||(this.lineVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[f]));break;case 8:this.lineTrianglesIndexBuffer||(this.lineTrianglesIndexBuffer=b.createIndex(c,35044,this._vectorTileData.bufferData[f]));break;case 1:this.lineJoinVertexBuffer||(this.lineJoinVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[f]));break;case 4:this.iconVertexBuffer||(this.iconVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[f]));
break;case 9:this.iconIndexBuffer||(this.iconIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[f],0,l/4)));break;case 5:this.textVertexBuffer||(this.textVertexBuffer=b.createVertex(c,35044,this._vectorTileData.bufferData[f]));break;case 10:this.textIndexBuffer||(this.textIndexBuffer=b.createIndex(c,35044,new Uint32Array(this._vectorTileData.bufferData[f],0,l/4)))}}}this.status=4;return!0};f.prototype.detach=function(a){this.status=3;this.polygonTrianglesVertexArrayObject&&
(this.polygonTrianglesVertexArrayObject.dispose(),this.polygonTrianglesVertexArrayObject=null);this.polygonOutlineVertexArrayObject&&(this.polygonOutlineVertexArrayObject.dispose(),this.polygonOutlineVertexArrayObject=null);this.lineTrianglesVertexArrayObject&&(this.lineTrianglesVertexArrayObject.dispose(),this.lineTrianglesVertexArrayObject=null);this.lineJoinsVertexArrayObject&&(this.lineJoinsVertexArrayObject.dispose(),this.lineJoinsVertexArrayObject=null);this.iconVertexArrayObject&&(this.iconVertexArrayObject.dispose(),
this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this.polygonTrianglesVertexBuffer&&(this.polygonTrianglesVertexBuffer.dispose(),this.polygonTrianglesVertexBuffer=null);this.polygonTrianglesIndexBuffer&&(this.polygonTrianglesIndexBuffer.dispose(),this.polygonTrianglesIndexBuffer=null);this.polygonOutlinesVertexBuffer&&(this.polygonOutlinesVertexBuffer.dispose(),this.polygonOutlinesVertexBuffer=null);this.polygonOutlinesIndexBuffer&&
(this.polygonOutlinesIndexBuffer.dispose(),this.polygonOutlinesIndexBuffer=null);this.lineVertexBuffer&&(this.lineVertexBuffer.dispose(),this.lineVertexBuffer=null);this.lineTrianglesIndexBuffer&&(this.lineTrianglesIndexBuffer.dispose(),this.lineTrianglesIndexBuffer=null);this.lineJoinVertexBuffer&&(this.lineJoinVertexBuffer.dispose(),this.lineJoinVertexBuffer=null);this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),
this.iconIndexBuffer=null);this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null);this._renderBuckets=[]};f.prototype.render=function(a){if(4===this.status){var b=a.context,c=a.renderer;if(b&&c){var d=a.drawphase;this._symbolUpdateData&&this._updateSymbolData(a);b.setStencilFunction(514,this.stencilData.reference,this.stencilData.mask);var e=this.styleLayers,g,f=this._renderBuckets.length,
h=0;if(0===d)for(h=f-1;0<=h;h--)g=this._renderBuckets[h],3!==g.type&&g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,e.layers[g.layerID]);else for(h=0;h<f;h++)g=this._renderBuckets[h],g.hasData()&&c.renderBucket(b,g,a.displayLevel,a.requiredLevel,d,this,e.layers[g.layerID])}}};f.prototype._updateSymbolData=function(a){var c=new Uint32Array(this._symbolUpdateData.bucketDataInfo),d=c.length;if(0===d)return this._symbolUpdateData=null,!0;if(1>a.budget.remaining)return this.requestRender(),
!1;a=a.context;a.bindVAO(null);for(var e=new Uint32Array(this._symbolUpdateData.bufferDataInfo),f=e.length,h=0,m=0;m<f;m+=2,h++){var l=e[m],u=e[m+1];if(!(0>=u||0===this._symbolUpdateData.bufferData[h].byteLength))switch(l){case 4:this.iconVertexBuffer&&(this.iconVertexBuffer.dispose(),this.iconVertexBuffer=null);this.iconVertexBuffer=b.createVertex(a,35044,this._symbolUpdateData.bufferData[h]);break;case 9:this.iconIndexBuffer&&(this.iconIndexBuffer.dispose(),this.iconIndexBuffer=null);this.iconIndexBuffer=
b.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[h],0,u/4));break;case 5:this.textVertexBuffer&&(this.textVertexBuffer.dispose(),this.textVertexBuffer=null);this.textVertexBuffer=b.createVertex(a,35044,this._symbolUpdateData.bufferData[h]);break;case 10:this.textIndexBuffer&&(this.textIndexBuffer.dispose(),this.textIndexBuffer=null),this.textIndexBuffer=b.createIndex(a,35044,new Uint32Array(this._symbolUpdateData.bufferData[h],0,u/4))}}a=0;for(e=this._renderBuckets.length;a<
e;a++)this._renderBuckets[a]instanceof g.SymbolRenderBucket&&(f=this._renderBuckets[a],f.markerElementStart=0,f.marketElementCount=0,f.textElementStart=0,f.textElementCount=0);for(f=0;f<d;){m=c[f];h=-1;a=0;for(e=this._renderBuckets.length;a<e;a++)if(this._renderBuckets[a].layerID===m){h=a;break}-1===h&&console.log("bucket not found");if(a=this._renderBuckets[h])a.markerElementStart=c[f+2],a.marketElementCount=c[f+3],a.textElementStart=c[f+4],a.textElementCount=c[f+5];f+=7}this.iconVertexArrayObject&&
(this.iconVertexArrayObject.dispose(),this.iconVertexArrayObject=null);this.textVertexArrayObject&&(this.textVertexArrayObject.dispose(),this.textVertexArrayObject=null);this._symbolUpdateData=null;return!0};return f}(c)})},"esri/layers/vectorTiles/views/vectorTiles/RenderBucket":function(){define(["require","exports","../../core/tsSupport/extendsHelper","../../core/tsSupport/decorateHelper"],function(l,f,a,b){l=function(){return function(a){this.type=a}}();f.RenderBucket=l;b=function(b){function d(){b.call(this,
2);this.joinCount=this.joinStart=this.triangleElementCount=this.triangleElementStart=0}a(d,b);d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.joinStart};return d}(l);f.LineRenderBucket=b;b=function(b){function d(){b.call(this,1);this.outlineElementCount=this.outlineElementStart=this.triangleElementCount=this.triangleElementStart=0}a(d,b);d.prototype.hasData=function(){return 0<this.triangleElementCount||0<this.outlineElementCount};return d}(l);f.FillRenderBucket=b;b=function(b){function d(){b.call(this,
3);this.textElementCount=this.textElementStart=this.marketElementCount=this.markerElementStart=0;this.isSDF=!1}a(d,b);d.prototype.hasData=function(){return 0<this.marketElementCount||0<this.textElementCount};return d}(l);f.SymbolRenderBucket=b;l=function(b){function d(){b.call(this,0)}a(d,b);d.prototype.hasData=function(){return!0};return d}(l);f.BackgroundRenderBucket=l})},"esri/layers/vectorTiles/views/2d/engine/StageGL":function(){define("require exports ../../../core/tsSupport/extendsHelper ./Container ../../webgl/RenderingContext ../../webgl/webgl-utils".split(" "),
function(l,f,a,b,c,d){return function(b){function g(){b.apply(this,arguments)}a(g,b);g.prototype.createElement=function(){this.el||(this.el=document.createElement("canvas"),this.el.setAttribute("class","esri-display-object"));return this.el};g.prototype.attach=function(a){this._resizeCanvas(a);var g=d.setupWebGL(this.el,{alpha:!0,antialias:!1,depth:!0,stencil:!0});this._renderingContext=new c(g[0]);this.attached=!0;return b.prototype.attach.call(this,a)};g.prototype.detach=function(a){b.prototype.detach.call(this,
a);this._renderingContext=null};g.prototype.render=function(a){this._resizeCanvas(a);b.prototype.render.call(this,a)};g.prototype.prepareChildrenRenderParameters=function(a){if(!this.attached||!this._renderingContext)return null;var b=this._renderingContext.gl;this._renderingContext.setClearColor(0,0,0,0);this._renderingContext.setClearDepth(1);this._renderingContext.setClearStencil(0);this._renderingContext.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT|b.STENCIL_BUFFER_BIT);this._renderingContext.setViewport(0,
0,this.el.width,this.el.height);a.context=this._renderingContext;return a};g.prototype.attachChild=function(a,b){return a.attach(b)};g.prototype.detachChild=function(a,b){return a.detach(b)};g.prototype.renderChild=function(a,b){return a.render(b)};g.prototype._resizeCanvas=function(a){var b=this.el,c=b.style,d=a.state,e=a.devicePixelRatio;a=d.width*e;e*=d.height;if(b.width!==a||b.height!==e)b.width=a,b.height=e,c.width=d.width+"px",c.height=d.height+"px"};return g}(b)})},"esri/layers/vectorTiles/views/webgl/RenderingContext":function(){define(["require",
"exports","./enums","./Extensions"],function(l,f,a,b){return function(){function c(a,c){this.gl=null;this._extensions=void 0;this._blendEnabled=!1;this._blendColorState={r:0,g:0,b:0,a:0};this._blendFunctionState={srcRGB:1,dstRGB:0,srcAlpha:1,dstAlpha:0};this._blendEquationState={mode:32774,modeAlpha:32774};this._colorMaskState={r:!0,g:!0,b:!0,a:!0};this._polygonCullingEnabled=!1;this._cullFace=1029;this._frontFace=2305;this._scissorTestEnabled=!1;this._scissorRect={x:0,y:0,width:0,height:0};this._depthTestEnabled=
!1;this._depthFunction=513;this._clearDepth=1;this._depthWriteEnabled=!0;this._depthRange={zNear:0,zFar:1};this._viewport=null;this._polygonOffsetFillEnabled=this._stencilTestEnabled=!1;this._polygonOffset=[0,0];this._stencilFunction={face:1032,func:519,ref:0,mask:1};this._clearStencil=0;this._stencilWriteMask=1;this._stencilOperation={face:1032,fail:7680,zFail:7680,zPass:7680};this._lineWidth=1;this._clearColor={r:0,g:0,b:0,a:0};this._activeFramebuffer=this._activeIndexBuffer=this._activeVertexBuffer=
this._activeShaderProgram=null;this._activeTextureUnit=0;this._textureUnitMap={};this.gl=a;this._extensions=new b(a,c);var g=a.getParameter(a.VIEWPORT);this._viewport={x:g[0],y:g[1],width:g[2],height:g[3]};g=this.extensions.textureFilterAnisotropic;this._parameters={versionString:a.getParameter(a.VERSION),maxVertexTextureImageUnits:a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxVertexAttributes:a.getParameter(a.MAX_VERTEX_ATTRIBS),maxMaxAnisotropy:g?a.getParameter(g.MAX_TEXTURE_MAX_ANISOTROPY_EXT):
void 0,maxTextureImageUnits:a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS)};this.enforceState()}Object.defineProperty(c.prototype,"extensions",{get:function(){return this._extensions},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"contextAttributes",{get:function(){return this.gl.getContextAttributes()},enumerable:!0,configurable:!0});Object.defineProperty(c.prototype,"parameters",{get:function(){return this._parameters},enumerable:!0,configurable:!0});c.prototype.setBlendingEnabled=
function(a){this._blendEnabled!==a&&(!0===a?this.gl.enable(this.gl.BLEND):this.gl.disable(this.gl.BLEND),this._blendEnabled=a)};c.prototype.setBlendColor=function(a,b,c,f){if(a!==this._blendColorState.r||b!==this._blendColorState.g||c!==this._blendColorState.b||f!==this._blendColorState.a)this.gl.blendColor(a,b,c,f),this._blendColorState.r=a,this._blendColorState.g=b,this._blendColorState.b=c,this._blendColorState.a=f};c.prototype.setBlendFunction=function(a,b){if(a!==this._blendFunctionState.srcRGB||
b!==this._blendFunctionState.dstRGB)this.gl.blendFunc(a,b),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=a,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=b};c.prototype.setBlendFunctionSeparate=function(a,b,c,f){if(this._blendFunctionState.srcRGB!==a||this._blendFunctionState.srcAlpha!==c||this._blendFunctionState.dstRGB!==b||this._blendFunctionState.dstAlpha!==f)this.gl.blendFuncSeparate(a,b,c,f),this._blendFunctionState.srcRGB=a,this._blendFunctionState.srcAlpha=
c,this._blendFunctionState.dstRGB=b,this._blendFunctionState.dstAlpha=f};c.prototype.setBlendEquation=function(a){this._blendEquationState.mode!==a&&(this.gl.blendEquation(a),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=a)};c.prototype.setBlendEquationSeparate=function(a,b){if(this._blendEquationState.mode!==a||this._blendEquationState.modeAlpha!==b)this.gl.blendEquationSeparate(a,b),this._blendEquationState.mode=a,this._blendEquationState.modeAlpha=b};c.prototype.setColorMask=
function(a,b,c,f){if(this._colorMaskState.r!==a||this._colorMaskState.g!==b||this._colorMaskState.b!==c||this._colorMaskState.a!==f)this.gl.colorMask(a,b,c,f),this._colorMaskState.r=a,this._colorMaskState.g=b,this._colorMaskState.b=c,this._colorMaskState.a=f};c.prototype.setClearColor=function(a,b,c,f){if(this._clearColor.r!==a||this._clearColor.g!==b||this._clearColor.b!==c||this._clearColor.a!==f)this.gl.clearColor(a,b,c,f),this._clearColor.r=a,this._clearColor.g=b,this._clearColor.b=c,this._clearColor.a=
f};c.prototype.setFaceCullingEnabled=function(a){this._polygonCullingEnabled!==a&&(!0===a?this.gl.enable(this.gl.CULL_FACE):this.gl.disable(this.gl.CULL_FACE),this._polygonCullingEnabled=a)};c.prototype.setPolygonOffsetFillEnabled=function(a){this._polygonOffsetFillEnabled!==a&&(!0===a?this.gl.enable(this.gl.POLYGON_OFFSET_FILL):this.gl.disable(this.gl.POLYGON_OFFSET_FILL),this._polygonOffsetFillEnabled=a)};c.prototype.setPolygonOffset=function(a,b){if(this._polygonOffset[0]!==a||this._polygonOffset[1]!==
b)this._polygonOffset[0]=a,this._polygonOffset[1]=b,this.gl.polygonOffset(a,b)};c.prototype.setCullFace=function(a){this._cullFace!==a&&(this.gl.cullFace(a),this._cullFace=a)};c.prototype.setFrontFace=function(a){this._frontFace!==a&&(this.gl.frontFace(a),this._frontFace=a)};c.prototype.setScissorTestEnabled=function(a){this._scissorTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.SCISSOR_TEST):this.gl.disable(this.gl.SCISSOR_TEST),this._scissorTestEnabled=a)};c.prototype.setScissorRect=function(a,
b,c,f){if(this._scissorRect.x!==a||this._scissorRect.y!==b||this._scissorRect.width!==c||this._scissorRect.height!==f)this.gl.scissor(a,b,c,f),this._scissorRect.x=a,this._scissorRect.y=b,this._scissorRect.width=c,this._scissorRect.height=f};c.prototype.setDepthTestEnabled=function(a){this._depthTestEnabled!==a&&(!0===a?this.gl.enable(this.gl.DEPTH_TEST):this.gl.disable(this.gl.DEPTH_TEST),this._depthTestEnabled=a)};c.prototype.setClearDepth=function(a){this._clearDepth!==a&&(this.gl.clearDepth(a),
this._clearDepth=a)};c.prototype.setDepthFunction=function(a){this._depthFunction!==a&&(this.gl.depthFunc(a),this._depthFunction=a)};c.prototype.setDepthWriteEnabled=function(a){this._depthWriteEnabled!==a&&(this.gl.depthMask(a),this._depthWriteEnabled=a)};c.prototype.setDepthRange=function(a,b){if(this._depthRange.zNear!==a||this._depthRange.zFar!==b)this.gl.depthRange(a,b),this._depthRange.zNear=a,this._depthRange.zFar=b};c.prototype.setStencilTestEnabled=function(a){this._stencilTestEnabled!==
a&&(!0===a?this.gl.enable(this.gl.STENCIL_TEST):this.gl.disable(this.gl.STENCIL_TEST),this._stencilTestEnabled=a)};c.prototype.setClearStencil=function(a){a!==this._clearStencil&&(this.gl.clearStencil(a),this._clearStencil=a)};c.prototype.setStencilFunction=function(a,b,c){if(this._stencilFunction.func!==a||this._stencilFunction.ref!==b||this._stencilFunction.mask!==c)this.gl.stencilFunc(a,b,c),this._stencilFunction.face=1032,this._stencilFunction.func=a,this._stencilFunction.ref=b,this._stencilFunction.mask=
c};c.prototype.setStencilFunctionSeparate=function(a,b,c,f){if(this._stencilFunction.face!==a||this._stencilFunction.func!==b||this._stencilFunction.ref!==c||this._stencilFunction.mask!==f)this.gl.stencilFuncSeparate(a,b,c,f),this._stencilFunction.face=a,this._stencilFunction.func=b,this._stencilFunction.ref=c,this._stencilFunction.mask=f};c.prototype.setStencilWriteMask=function(a){this._stencilWriteMask!==a&&(this.gl.stencilMask(a),this._stencilWriteMask=a)};c.prototype.setStencilOp=function(a,
b,c){if(this._stencilOperation.fail!==a||this._stencilOperation.zFail!==b||this._stencilOperation.zPass!==c)this.gl.stencilOp(a,b,c),this._stencilOperation.face=1032,this._stencilOperation.fail=a,this._stencilOperation.zFail=b,this._stencilOperation.zPass=c};c.prototype.setStencilOpSeparate=function(a,b,c,f){if(this._stencilOperation.face!==a||this._stencilOperation.fail!==b||this._stencilOperation.zFail!==c||this._stencilOperation.zPass!==f)this.gl.stencilOpSeparate(a,b,c,f),this._stencilOperation.face=
a,this._stencilOperation.face=a,this._stencilOperation.fail=b,this._stencilOperation.zFail=c,this._stencilOperation.zPass=f};c.prototype.setLineWidth=function(a){var b=this._lineWidth;this._lineWidth!==a&&(this.gl.lineWidth(a),this._lineWidth=a);return b};c.prototype.setActiveTexture=function(b){var c=this._activeTextureUnit;0<=b&&b!==this._activeTextureUnit&&(this.gl.activeTexture(a.BASE_TEXTURE_UNIT+b),this._activeTextureUnit=b);return c};c.prototype.clear=function(a){a&&this.gl.clear(a)};c.prototype.drawArrays=
function(a,b,c){this.gl.drawArrays(a,b,c)};c.prototype.drawElements=function(a,b,c,f){5123===c?this.gl.drawElements(a,b,c,f):5125===c&&this._extensions.elementIndexUint?this.gl.drawElements(a,b,c,f):console.warn("Data type is uint however extension OES_Element_index_unit is not supported therefore this draw call cannot be made")};c.prototype.drawArraysInstanced=function(a,b,c,f){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawArraysInstancedANGLE(a,b,c,f):console.error("Extension ANGLE_instanced_arrays isn't supported!")};
c.prototype.drawElementsInstanced=function(a,b,c,f,m){this._extensions.angleInstancedArrays?this._extensions.angleInstancedArrays.drawElementsInstancedANGLE(a,b,c,f,m):console.error("Extension ANGLE_instanced_arrays isn't supported!")};c.prototype.setViewport=function(a,b,c,f){var m=this._viewport;if(m.x!==a||m.y!==b||m.width!==c||m.height!==f)m.x=a,m.y=b,m.width=c,m.height=f,this.gl.viewport(a,b,c,f)};c.prototype.getViewport=function(){return this._viewport};c.prototype.bindProgram=function(a){a?
this._activeShaderProgram!==a&&(a.initialize(),this.gl.useProgram(a.glName),this._activeShaderProgram=a):(this.gl.useProgram(null),this._activeShaderProgram=null)};c.prototype.bindTexture=function(a,b){void 0===b&&(b=0);-1===c._MAX_TEXTURE_IMAGE_UNITS&&(c._MAX_TEXTURE_IMAGE_UNITS=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS));(b>=c._MAX_TEXTURE_IMAGE_UNITS||0>b)&&console.error("Input texture unit is out of range of available units!");var f=this._textureUnitMap[b];this.setActiveTexture(b);
null==a?(null!=f&&this.gl.bindTexture(f.descriptor.target,null),this._textureUnitMap[b]=null):f&&f.id===a.id?a.applyChanges():(this.gl.bindTexture(a.descriptor.target,a.glName),a.applyChanges(),this._textureUnitMap[b]=a)};c.prototype.bindFramebuffer=function(a){a?this._activeFramebuffer!==a&&(a.initialize()||this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,a.glName),this._activeFramebuffer=a):(this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this._activeFramebuffer=null)};c.prototype.bindBuffer=function(a){a&&
(34962===a.bufferType?this._activeVertexBuffer=c._bindBuffer(this.gl,a,a.bufferType,this._activeVertexBuffer):this._activeIndexBuffer=c._bindBuffer(this.gl,a,a.bufferType,this._activeIndexBuffer))};c.prototype.unbindBuffer=function(a){34962===a?this._activeVertexBuffer=c._bindBuffer(this.gl,null,a,this._activeVertexBuffer):this._activeIndexBuffer=c._bindBuffer(this.gl,null,a,this._activeIndexBuffer)};c.prototype.bindVAO=function(a){a?this._activeVertexArrayObject&&this._activeVertexArrayObject.id===
a.id||(a.bind(),this._activeVertexArrayObject=a):this._activeVertexArrayObject&&(this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null)};c.prototype.getBoundTexture=function(a){return this._textureUnitMap[a]};c.prototype.getBoundFramebufferObject=function(){return this._activeFramebuffer};c.prototype.getBoundVAO=function(){return this._activeVertexArrayObject};c.prototype.resetState=function(){this.bindProgram(null);this.bindVAO(null);this.bindFramebuffer(null);this.unbindBuffer(34962);
this.unbindBuffer(34963);for(var a=0;a<this.parameters.maxTextureImageUnits;a++)this.bindTexture(null,a);this.setBlendingEnabled(!1);this.setBlendFunction(1,0);this.setBlendEquation(32774);this.setBlendColor(0,0,0,0);this.setFaceCullingEnabled(!1);this.setCullFace(1029);this.setFrontFace(2305);this.setPolygonOffsetFillEnabled(!1);this.setPolygonOffset(0,0);this.setScissorTestEnabled(!1);this.setScissorRect(0,0,this.gl.canvas.width,this.gl.canvas.height);this.setDepthTestEnabled(!1);this.setDepthFunction(513);
this.setDepthRange(0,1);this.setStencilTestEnabled(!1);this.setStencilFunction(519,0,0);this.setStencilOp(7680,7680,7680);this.setClearColor(0,0,0,0);this.setClearDepth(1);this.setClearStencil(0);this.setColorMask(!0,!0,!0,!0);this.setStencilWriteMask(4294967295);this.setDepthWriteEnabled(!0);this.setViewport(0,0,this.gl.canvas.width,this.gl.canvas.height)};c.prototype.enforceState=function(){var b=this.gl,c=this._extensions.vao;c&&c.bindVertexArrayOES(null);for(var f=0;f<this.parameters.maxVertexAttributes;f++)b.disableVertexAttribArray(f);
this._activeVertexBuffer?b.bindBuffer(this._activeVertexBuffer.bufferType,this._activeVertexBuffer.glName):b.bindBuffer(34962,null);this._activeIndexBuffer?b.bindBuffer(this._activeIndexBuffer.bufferType,this._activeIndexBuffer.glName):b.bindBuffer(34963,null);if(c&&this._activeVertexArrayObject){if(c=this._activeVertexArrayObject)this._activeVertexArrayObject.unbind(),this._activeVertexArrayObject=null;this.bindVAO(c)}b.bindFramebuffer(b.FRAMEBUFFER,this._activeFramebuffer?this._activeFramebuffer.glName:
null);b.useProgram(this._activeShaderProgram?this._activeShaderProgram.glName:null);b.blendColor(this._blendColorState.r,this._blendColorState.g,this._blendColorState.b,this._blendColorState.a);!0===this._blendEnabled?b.enable(this.gl.BLEND):b.disable(this.gl.BLEND);b.blendEquationSeparate(this._blendEquationState.mode,this._blendEquationState.modeAlpha);b.blendFuncSeparate(this._blendFunctionState.srcRGB,this._blendFunctionState.dstRGB,this._blendFunctionState.srcAlpha,this._blendFunctionState.dstAlpha);
b.clearColor(this._clearColor.r,this._clearColor.g,this._clearColor.b,this._clearColor.a);b.clearDepth(this._clearDepth);b.clearStencil(this._clearStencil);b.colorMask(this._colorMaskState.r,this._colorMaskState.g,this._colorMaskState.b,this._colorMaskState.a);b.cullFace(this._cullFace);b.depthFunc(this._depthFunction);b.depthRange(this._depthRange.zNear,this._depthRange.zFar);!0===this._depthTestEnabled?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST);b.depthMask(this._depthWriteEnabled);b.frontFace(this._frontFace);
b.lineWidth(this._lineWidth);!0===this._polygonCullingEnabled?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE);b.polygonOffset(this._polygonOffset[0],this._polygonOffset[1]);!0===this._polygonOffsetFillEnabled?b.enable(b.POLYGON_OFFSET_FILL):b.disable(b.POLYGON_OFFSET_FILL);b.scissor(this._scissorRect.x,this._scissorRect.y,this._scissorRect.width,this._scissorRect.height);!0===this._scissorTestEnabled?b.enable(b.SCISSOR_TEST):b.disable(b.SCISSOR_TEST);b.stencilFunc(this._stencilFunction.func,this._stencilFunction.ref,
this._stencilFunction.mask);b.stencilOpSeparate(this._stencilOperation.face,this._stencilOperation.fail,this._stencilOperation.zFail,this._stencilOperation.zPass);!0===this._stencilTestEnabled?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST);b.stencilMask(this._stencilWriteMask);for(c=0;c<this.parameters.maxTextureImageUnits;c++)b.activeTexture(a.BASE_TEXTURE_UNIT+c),b.bindTexture(3553,null),(f=this._textureUnitMap[c])&&b.bindTexture(f.descriptor.target,f.glName);b.activeTexture(a.BASE_TEXTURE_UNIT+
this._activeTextureUnit);b.viewport(this._viewport.x,this._viewport.y,this._viewport.width,this._viewport.height)};c._bindBuffer=function(a,b,c,f){if(!b)return a.bindBuffer(c,null),null;if(f===b)return f;a.bindBuffer(c,b.glName);return b};c._MAX_TEXTURE_IMAGE_UNITS=-1;return c}()})},"esri/layers/vectorTiles/views/webgl/enums":function(){define(["require","exports"],function(l,f){f.BASE_TEXTURE_UNIT=33984})},"esri/layers/vectorTiles/views/webgl/Extensions":function(){define(["require","exports"],function(l,
f){return function(){function a(a,c){this._compressedTextureS3TCInit=this._shaderTextureLODInit=this._textureFilterAnisotropicInit=this._depthTextureInit=this._elementIndexUintInit=this._standardDerivativesInit=this._angleInstancedArraysInit=this._vaoInit=!1;this._gl=a;if(c&&c.disabledExtensions){var d=c.disabledExtensions;d.vao&&(this._vao=null,this._vaoInit=!0);d.angleInstancedArrays&&(this._angleInstancedArrays=null,this._angleInstancedArraysInit=!0);d.standardDerivatives&&(this._standardDerivatives=
null,this._standardDerivativesInit=!0);d.elementIndexUint&&(this._elementIndexUint=null,this._elementIndexUintInit=!0);d.depthTexture&&(this._depthTexture=null,this._depthTextureInit=!0);d.textureFilterAnisotropic&&(this._textureFilterAnisotropic=null,this._textureFilterAnisotropicInit=!0);d.compressedTextureS3TC&&(this._compressedTextureS3TC=null,this._compressedTextureS3TCInit=!0);d.shaderTextureLOD&&(this._shaderTextureLOD=null,this._shaderTextureLODInit=!0)}}Object.defineProperty(a.prototype,
"vao",{get:function(){this._vaoInit||(this._vao=this._gl.getExtension("OES_vertex_array_object")||this._gl.getExtension("MOZ_OES_vertex_array_object")||this._gl.getExtension("WEBKIT_OES_vertex_array_object"),this._vaoInit=!0);return this._vao},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"angleInstancedArrays",{get:function(){this._angleInstancedArraysInit||(this._angleInstancedArrays=this._gl.getExtension("ANGLE_instanced_arrays"),this._angleInstancedArraysInit=!0);return this._angleInstancedArrays},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"standardDerivatives",{get:function(){this._standardDerivativesInit||(this._standardDerivatives=this._gl.getExtension("OES_standard_derivatives"),this._standardDerivativesInit=!0);return this._standardDerivatives},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"elementIndexUint",{get:function(){this._elementIndexUintInit||(this._elementIndexUint=this._gl.getExtension("OES_element_index_uint"),this._elementIndexUintInit=
!0);return this._elementIndexUint},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"depthTexture",{get:function(){this._depthTextureInit||(this._depthTexture=this._gl.getExtension("WEBGL_depth_texture")||this._gl.getExtension("MOZ_WEBGL_depth_texture")||this._gl.getExtension("WEBKIT_WEBGL_depth_texture"),this._depthTextureInit=!0);return this._depthTexture},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"textureFilterAnisotropic",{get:function(){this._textureFilterAnisotropicInit||
(this._textureFilterAnisotropic=this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this._textureFilterAnisotropicInit=!0);return this._textureFilterAnisotropic},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"shaderTextureLOD",{get:function(){this._shaderTextureLODInit||(this._shaderTextureLOD=this._gl.getExtension("EXT_shader_texture_lod"),this._shaderTextureLODInit=
!0);return this._shaderTextureLOD},enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"compressedTextureS3TC",{get:function(){this._compressedTextureS3TCInit||(this._compressedTextureS3TC=this._gl.getExtension("WEBGL_compressed_texture_s3tc"),this._compressedTextureS3TCInit=!0);return this._compressedTextureS3TC},enumerable:!0,configurable:!0});return a}()})},"esri/layers/vectorTiles/views/webgl/webgl-utils":function(){define([],function(){var l=function(a,c){for(var d=["webgl","experimental-webgl",
"webkit-3d","moz-webgl"],e=null,f=0;f<d.length;++f){try{e=a.getContext(d[f],c)}catch(h){}if(e)break}return e},f=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a,c){return window.setTimeout(a,1E3/60)}).bind(window),a=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.clearTimeout).bind(window);
return{create3DContext:l,setupWebGL:function(a,c){function d(c){var d=a.parentNode;d&&(d.innerHTML='\x3ctable style\x3d"background-color: #8CE; width: 100%; height: 100%;"\x3e\x3ctr\x3e\x3ctd align\x3d"center"\x3e\x3cdiv style\x3d"display: table-cell; vertical-align: middle;"\x3e\x3cdiv style\x3d""\x3e'+c+"\x3c/div\x3e\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e")}if(!window.WebGLRenderingContext)return d('This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'),
[null,'This page requires a browser that supports WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org"\x3eClick here to upgrade your browser.\x3c/a\x3e'];var e=l(a,c);return!e?(d('It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e'),[null,'It doesn\'t appear your computer can support WebGL.\x3cbr/\x3e\x3ca href\x3d"http://get.webgl.org/troubleshooting/"\x3eClick here for more information.\x3c/a\x3e']):
[e]},detectWebGL:function(){var a;try{a=window.WebGLRenderingContext}catch(c){a=[!1,0]}var d;try{d=l(document.createElement("canvas"))}catch(e){d=[!1,1]}return!a?[!1,0]:!d?[!1,1]:[!0,{VERSION:d.getParameter(d.VERSION),SHADING_LANGUAGE_VERSION:d.getParameter(d.SHADING_LANGUAGE_VERSION),VENDOR:d.getParameter(d.VENDOR),RENDERER:d.getParameter(d.RENDERER),EXTENSIONS:d.getSupportedExtensions(),MAX_TEXTURE_SIZE:d.getParameter(d.MAX_TEXTURE_SIZE),MAX_RENDERBUFFER_SIZE:d.getParameter(d.MAX_RENDERBUFFER_SIZE),
MAX_VERTEX_TEXTURE_IMAGE_UNITS:d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS)}]},requestAnimFrame:f,cancelAnimFrame:a}})},"esri/layers/vectorTiles/views/2d/FrameBudget":function(){define(["require","exports","../../core/now"],function(l,f,a){return function(){function b(a){void 0===a&&(a=Number.MAX_VALUE);this._budget=this._begin=0;this.enabled=!0;this.reset(a)}b.now=function(){return a()};Object.defineProperty(b.prototype,"done",{get:function(){return this.enabled&&this.elapsed>=this._budget},
enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"elapsed",{get:function(){return a()-this._begin},enumerable:!0,configurable:!0});Object.defineProperty(b.prototype,"remaining",{get:function(){return Math.max(this._budget-this.elapsed,0)},enumerable:!0,configurable:!0});b.prototype.reset=function(b){void 0===b&&(b=Number.MAX_VALUE);this._begin=a();this._budget=this.enabled?b:Number.MAX_VALUE};return b}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileInfoView":function(){define("require exports ./LODInfo ./TileKey ./TileSpan ./TileCoverage".split(" "),
function(l,f,a,b,c,d){var e=function(){function a(b,c,d,e,f,g,h,l){this.x=b;this.ymin=c;this.ymax=d;this.invM=e;this.leftAdjust=f;this.rightAdjust=g;this.leftBound=h;this.rightBound=l}a.create=function(b,c){b[1]>c[1]&&(d=[c,b],b=d[0],c=d[1]);var d=b[0],e=b[1],f=c[0],g=c[1],l=f-d,s=g-e,s=0!==s?l/s:0,t=(Math.ceil(e)-e)*s,u=(Math.floor(e)-e)*s;return new a(d,Math.floor(e),Math.ceil(g),s,0>l?t:u,0>l?u:t,0>l?f:d,0>l?d:f);var d};a.prototype.incrRow=function(){this.x+=this.invM};a.prototype.getLeftCol=function(){return Math.max(this.x+
this.leftAdjust,this.leftBound)};a.prototype.getRightCol=function(){return Math.min(this.x+this.rightAdjust,this.rightBound)};return a}(),g=[[0,0],[0,0],[0,0],[0,0]];return function(){function f(b,c){var d=this;this.scales=[];this._lodInfos=null;this._infoByScale={};this._infoByLevel={};var e=b.lods.slice();e.sort(function(a,b){return b.scale-a.scale});var g=this._lodInfos=e.map(function(d){return a.create(b,d,c)});e.forEach(function(a,b){d._infoByLevel[a.level]=g[b];d._infoByScale[a.scale]=g[b];
d.scales[b]=a.scale},this);this._wrap=b.spatialReference.isWrappable}f.prototype.getTileTopLeft=function(a,b){var c=this._infoByLevel[b.level];return!c?a:c.getTileTopLeft(a,b)};f.prototype.getTileBottomRight=function(a,b){var c=this._infoByLevel[b.level];return!c?a:c.getTileBottomRight(a,b)};f.prototype.getTileResolution=function(a){a=this._infoByLevel[a.level];return!a?-1:a.resolution};f.prototype.getTileParentId=function(a){a=b.from(a);var c=this._lodInfos.indexOf(this._infoByLevel[a.level])-1;
return 0>c?null:this.getTileIdAtParent(this._lodInfos[c],a)};f.prototype.getTileIdAtParent=function(a,c){var d=b.from(c),e=this._infoByLevel[d.level];if(a.resolution<e.resolution)throw Error("Cannot calculate parent tile. destination LOD's resolution "+a.resolution+" is not a parent resolution of "+e.resolution);return a.resolution===e.resolution?d.id:b.getId(a.level,Math.floor(d.row*e.resolution/a.resolution+0.01),Math.floor(d.col*e.resolution/a.resolution+0.01),d.world)};f.prototype.getTileCoverage=
function(a){var b=this.getClosestInfoForScale(a.scale),f=this._wrap,h;h=Infinity;var l=-Infinity,q,r,s=[];g[0][0]=g[0][1]=g[1][1]=g[3][0]=0;g[1][0]=g[2][0]=a.width;g[2][1]=g[3][1]=a.height;for(var t=g.map(function(c){a.toMap(c,c);c[0]=b.getColumnForX(c[0]);c[1]=b.getRowForY(c[1]);return c}),u=[],w=3,v=0;4>v;v++)t[v][1]!==t[w][1]&&(w=e.create(t[v],t[w]),h=Math.min(w.ymin,h),l=Math.max(w.ymax,l),void 0===u[w.ymin]&&(u[w.ymin]=[]),u[w.ymin].push(w)),w=v;if(null==h||null==l||100<l-h)return null;for(t=
[];h<l;){null!=u[h]&&(t=t.concat(u[h]));q=Infinity;r=-Infinity;for(v=t.length-1;0<=v;v--)w=t[v],q=Math.min(q,w.getLeftCol()),r=Math.max(r,w.getRightCol());q=Math.floor(q);r=Math.floor(r);if(h>=b.first[1]&&h<=b.last[1])if(f)if(b.size[0]<b.worldSize[0]){v=Math.floor(q/b.worldSize[0]);for(w=Math.floor(r/b.worldSize[0]);v<=w;v++)s.push(new c(h,Math.max(b.getFirstColumnForWorld(v),q),Math.min(b.getLastColumnForWorld(v),r)))}else s.push(new c(h,q,r));else q>b.last[0]||r<b.first[0]||(q=Math.max(q,b.first[0]),
r=Math.min(r,b.last[0]),s.push(new c(h,q,r)));h+=1;for(v=t.length-1;0<=v;v--)w=t[v],w.ymax>=h?w.incrRow():t.splice(v,1)}return new d(b,s)};f.prototype.intersects=function(a,c){var d=b.from(c),e=this._infoByLevel[d.level],f=a.lodInfo;if(f.resolution>e.resolution){var g=b.fromId(this.getTileIdAtParent(f,d)),h=f.denormalizeCol(g.col,g.world);return a.spans.some(function(a){return a.row===g.row&&a.colFrom<=h&&a.colTo>=h})}if(f.resolution<e.resolution){var l=a.spans.reduce(function(a,b){a[0]=Math.min(a[0],
b.row);a[1]=Math.max(a[1],b.row);a[2]=Math.min(a[2],b.colFrom);a[3]=Math.max(a[3],b.colTo);return a},[Infinity,-Infinity,Infinity,-Infinity]),t=l[0],u=l[1],w=l[2],l=l[3],v=e.denormalizeCol(d.col,d.world),y=f.getColumnForX(e.getXForColumn(v)),A=f.getRowForY(e.getYForRow(d.row)),v=f.getColumnForX(e.getXForColumn(v+1))-1,e=f.getRowForY(e.getYForRow(d.row+1))-1;return!(y>l||v<w||A>u||e<t)}var z=f.denormalizeCol(d.col,d.world);return a.spans.some(function(a){return a.row===d.row&&a.colFrom<=z&&a.colTo>=
z})};f.prototype.getClosestInfoForScale=function(a){var b=this.scales;this._infoByScale[a]||(a=b.reduce(function(b,c,d,e){return Math.abs(c-a)<Math.abs(b-a)?c:b},b[0]));return this._infoByScale[a]};return f}()})},"esri/layers/vectorTiles/views/2d/layers/support/LODInfo":function(){define(["require","exports","./TileKey"],function(l,f,a){function b(a,b,e){a[0]=b;a[1]=e;return a}return function(){function c(a,b,c,f,l,k,n,p,x,q,r){this.level=a;this.resolution=b;this.origin=c;this.first=f;this.last=l;
this.size=k;this.norm=n;this.worldStart=p;this.worldEnd=x;this.worldSize=q;this.wrap=r}c.create=function(a,e,f){var h=a.spatialReference._getInfo(),l=[a.origin.x,a.origin.y],k=[a.size[0]*e.resolution,a.size[1]*e.resolution],n=[-Infinity,-Infinity],p=[Infinity,Infinity],x=[Infinity,Infinity];f&&(b(n,Math.max(0,Math.floor((f.xmin-l[0])/k[0])),Math.max(0,Math.floor((l[1]-f.ymax)/k[1]))),b(p,Math.max(0,Math.floor((f.xmax-l[0])/k[0])),Math.max(0,Math.floor((l[1]-f.ymin)/k[1]))),b(x,p[0]-n[0]+1,p[1]-n[1]+
1));var q;h?(a=[Math.ceil(Math.round(2*h.origin[1]/e.resolution)/a.size[0]),x[1]],h=[Math.floor((h.origin[0]-l[0])/k[0]),n[1]],f=[a[0]-h[0]-1,p[1]],q=!0):(h=n,f=p,a=x,q=!1);return new c(e.level,e.resolution,l,n,p,x,k,h,f,a,q)};c.prototype.normalizeCol=function(a){if(!this.wrap)return a;var b=this.worldSize[0];return 0>a?b-1-Math.abs((a+1)%b):a%b};c.prototype.denormalizeCol=function(a,b){return!this.wrap?a:this.worldSize[0]*b+a};c.prototype.getWorldForColumn=function(a){return!this.wrap?0:Math.floor(a/
this.worldSize[0])};c.prototype.getFirstColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]};c.prototype.getLastColumnForWorld=function(a){return a*this.worldSize[0]+this.first[0]+this.size[0]-1};c.prototype.getColumnForX=function(a){return(a-this.origin[0])/this.norm[0]};c.prototype.getXForColumn=function(a){return this.origin[0]+a*this.norm[0]};c.prototype.getRowForY=function(a){return(this.origin[1]-a)/this.norm[1]};c.prototype.getYForRow=function(a){return this.origin[1]-a*this.norm[1]};
c.prototype.getTileTopLeft=function(c,e){var f=a.from(e);return b(c,this.getXForColumn(this.denormalizeCol(f.col,f.world)),this.getYForRow(f.row))};c.prototype.getTileBottomRight=function(c,e){var f=a.from(e);return b(c,this.getXForColumn(this.denormalizeCol(f.col,f.world)+1),this.getYForRow(f.row+1))};return c}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileSpan":function(){define(["require","exports"],function(l,f){return function(){return function(a,b,c){this.row=a;this.colFrom=b;this.colTo=
c}}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileCoverage":function(){define(["require","exports"],function(l,f){return function(){return function(a,b){this.lodInfo=a;this.spans=b}}()})},"esri/layers/vectorTiles/views/2d/layers/support/TileStrategy":function(){define(["require","exports","../../../../core/LRUCache","../../layers/support/TileKey"],function(l,f,a,b){function c(a,b){a["delete"](b)}var d=[],e=[],g=[null,null],h=[];return function(){function f(b,c,d,e){this.container=b;this.tileInfoView=
c;this.requestUpdate=d;this.fetchTile=e;this._tilesToRender=new Map;this._requests=new Map;this._updates=new Map;this._loadedTiles=new Map;this._newTilesToRender=new Map;this._lru=new a(30);this._prevResolution=Number.POSITIVE_INFINITY;this._isStationary=!1}f.prototype.destroy=function(){this._requests&&(this._requests.forEach(function(a){a.isFulfilled()||a.cancel()}),this._loadedTiles=this._tilesToRender=this._requests=null)};f.prototype.update=function(a){var e=this,g=this.tileInfoView.getTileCoverage(a.state);
if(g){var l=g.lodInfo.level,q=a.state.resolution;if(1.5>a.budget.remaining)this.requestUpdate(),this._prevResolution=q;else{var r=q>this._prevResolution;this._prevResolution=q;f._createCoverageList(d,g);for(var s=0,t,u=0;u<d.length;u++)if(q=d[u],this._tilesToRender.has(q))t=this._tilesToRender.get(q),t.visible=!0,this._newTilesToRender.set(q,t),s++,t.attached||r||this._addParentTile(q,this._newTilesToRender);else if(this._loadedTiles.has(q))this._newTilesToRender.set(q,this._loadedTiles.get(q)),s++,
c(this._loadedTiles,q),r||this._addParentTile(q,this._newTilesToRender);else if(this._lru.has(q))t=this._lru.use(q),t.visible=!0,this._newTilesToRender.set(q,t),s++,!t.attached&&!r&&this._addParentTile(q,this._newTilesToRender);else{if(t=this._requests.get(q)){if(t.isCanceled()||t.isRejected())c(this._requests,q),this._getTile(q,a)}else this._getTile(q,a);r||this._addParentTile(q,this._newTilesToRender)}!this._isStationary&&a.stationary&&this.requestUpdate();this._isStationary=a.stationary;var w=
s===d.length,q=this._tilesToRender,v;q.forEach(function(a,d){v=b.from(d);e._newTilesToRender.has(d)||(0===v.level||v.level<l&&e.tileInfoView.intersects(g,v)?(a.visible=!1,e._newTilesToRender.set(d,a)):(r||!w)&&e.tileInfoView.intersects(g,v)?(a.visible=!0,e._newTilesToRender.set(d,a)):(e._updates.has(d)&&(e._updates.get(d).cancel(d),c(e._updates,d)),a.visible=!0,e._lru.insert(d,a)))});q.clear();this._tilesToRender=this._newTilesToRender;this._newTilesToRender=q;this.container.removeAllChildren();this._tilesToRender.forEach(function(a){return e.container.addChild(a)},
this);this._loadedTiles.forEach(function(a){return a.dispose()});this._loadedTiles.clear();this._requests.forEach(function(c,d){if(a.budget.done)e.requestUpdate();else if(c.isFulfilled())h.push(d);else if(v=b.from(d),v.level>l||!e.tileInfoView.intersects(g,v))c.cancel(),h.push(d)});for(s=0;s<h.length;s++)q=h[s],c(this._requests,q);h.length=0}}};f.prototype.updateTiles=function(a,b){var d=this;this._tilesToRender.forEach(function(e,f){if(e.visible&&e.attached){var g=a(e,b);g&&(d._updates.has(f)&&(d._updates.get(f).cancel(),
c(d._updates,f)),g.then(function(a){c(d._updates,f);d._tilesToRender.set(f,a)}),d._updates.set(f,g))}})};f.prototype._addParentTile=function(a,b){this._getAvailableParentTile(g,a);g[0]&&!b.has(g[0])&&(g[1].visible=!0,b.set(g[0],g[1]))};f.prototype._getTile=function(a,d){var e=this;if(!this._requests.has(a)){var f=this.fetchTile(a,d);f.then(function(d){var f=b.fromId(a);e.tileInfoView.getTileTopLeft(d.topLeft,f);e.tileInfoView.getTileBottomRight(d.bottomRight,f);d.resolution=e.tileInfoView.getTileResolution(f);
e._loadedTiles.set(a,d);c(e._requests,a);e.requestUpdate()}).otherwise(function(b){c(e._requests,a)});this._requests.set(a,f)}};f.prototype._getAvailableParentTile=function(a,b){a[0]=null;a[1]=null;for(var c=b;c=this.tileInfoView.getTileParentId(c);){if(this._tilesToRender.has(c)){a[0]=c;a[1]=this._tilesToRender.get(c);break}if(this._lru.has(c)){var d=this._lru.use(c);if(d.attached){a[0]=c;a[1]=d;break}}}return a};f._createCoverageList=function(a,c){a.length=0;e.length=0;var d=c.spans;if(0!==d.length){for(var f=
0,g=0,h=Infinity,l=-Infinity,f=d[0].row,g=d[d.length-1].row,m=0;m<d.length;m++)for(var u=d[m],w=u.colFrom,u=u.colTo;w<=u;w++)h=Math.min(h,w),l=Math.max(l,w);var m=c.lodInfo,w=m.level,g=f+Math.floor((g-f)/2),h=h+Math.floor((l-h)/2),v,u=g-f;0<=u&&u<d.length&&(v=b.from(w,g,m.normalizeCol(h),m.getWorldForColumn(h)),e.push({dist:0,id:v.id}));for(var y,l=0;l<d.length;l++){u=d[l];f=u.row;w=u.colFrom;for(u=u.colTo;w<=u;w++)y=Math.abs(w-h)+Math.abs(f-g),0!==y&&(v.row=f,v.col=m.normalizeCol(w),v.world=m.getWorldForColumn(w),
e.push({dist:y,id:v.id}))}e.sort(function(a,b){return a.dist-b.dist});for(d=0;d<e.length;d++)a.push(e[d].id)}};return f}()})},"esri/layers/vectorTiles/core/LRUCache":function(){define(["require","exports"],function(l,f){return function(){function a(a){this._cache={};this._lruQueue=[];if(0>=a)throw Error("LRU cache size must be bigger than zero!");this._maxSize=a}a.prototype.has=function(a){return void 0!==this._cache[a]};a.prototype.insert=function(a,c){null!==this.use(a)?this._cache[a]=c:(this._collect(),
this._cache[a]=c,this._lruQueue.unshift(a))};a.prototype.use=function(a){var c=this._cache[a];if(!c)return null;this._lruQueue.splice(this._lruQueue.indexOf(a),1);this._lruQueue.unshift(a);return c};a.prototype.print=function(){for(var a=0,c=this._lruQueue;a<c.length;a++){var d=c[a];console.log("key: "+d+", value: "+this._cache[d])}};a.prototype._collect=function(){if(!(this._lruQueue.length<this._maxSize)){var a=this._lruQueue.pop(),c=this._cache[a];c&&c.dispose();delete this._cache[a]}};return a}()})},
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/background.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_coord_range;\r\nuniform mediump float u_depth;\r\n\r\nvoid main() {\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(u_coord_range * a_pos, 0.0, 1.0);\r\n}\r\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/background.fs.glsl":"uniform lowp vec4 u_color;\r\nvoid main() {\r\n  gl_FragColor \x3d u_color;\r\n}",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternFillShader.vs.glsl":"uniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump mat3 u_pattern_matrix; // can we use meduim precision??\r\n\r\nattribute vec2 a_pos;\r\n\r\nvarying mediump vec2 v_tileTextureCoord;\r\n\r\nvoid main()\r\n{\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\r\n  // calculate the texture coordinates of the current vertex. It will of course get interpolated.\r\n  // The pattern matrix is a 3x3 scale matrix which 'tiles' the texture inside the tile, translating from tile coordinates\r\n  // (-4k to 8k -1) to texture coordinates.\r\n  v_tileTextureCoord \x3d (u_pattern_matrix * vec3(a_pos, 1.0)).xy;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/patternFillShader.fs.glsl":"uniform lowp float u_opacity;\r\nuniform mediump vec2 u_pattern_tl;\r\nuniform mediump vec2 u_pattern_br;\r\nuniform sampler2D u_texture;\r\n\r\nvarying mediump vec2 v_tileTextureCoord;\r\n\r\nvoid main()\r\n{\r\n  // normalize the calculated texture coordinate such that it fits in the range of 0 to 1.\r\n  mediump vec2 normalizedTextureCoord \x3d mod(v_tileTextureCoord, 1.0);\r\n  // interpolate the image coordinate between the top-left and the bottom right to get the actual position to sample.\r\n  // after normalizing the position, we get a value ranging between 0 and 1 which refers to the entire texture, however\r\n  // we need to only sample from area that has our sprite in the mosaic.\r\n  mediump vec2 samplePos \x3d mix(u_pattern_tl, u_pattern_br, normalizedTextureCoord);\r\n  // sample the sprite mosaic\r\n  lowp vec4 color \x3d texture2D(u_texture, samplePos);\r\n\r\n  // 'un-premultiply' the color\r\n  lowp float inv_alpha \x3d (1.0 / clamp(color.a, 0.00390625, 1.0));\r\n  gl_FragColor \x3d color * vec4(inv_alpha, inv_alpha, inv_alpha, u_opacity);\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineShader.vs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\r\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\r\n*/\r\n\r\nattribute vec2 a_pos;\r\nattribute vec2 a_offset;\r\nattribute float a_accumulatedDistance;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the inset and outset of the line\r\nuniform mediump float u_lineHalfWidth;\r\n// the interpolated normal to the line. the information is packed into the LSB of the vertex coordinate\r\nvarying mediump vec2 v_normal;\r\n// the accumulated distance along the line. We need this information in order to render the dashes.\r\nvarying highp float v_accumulatedDistance;\r\n\r\nconst float scale \x3d 1.0 / 31.0;\r\n\r\nvoid main()\r\n{\r\n  // extract the normal from the list significat bit. It has a value of 0 or 1, but we need it to be either -1 or 1 therefore\r\n  // we need to change 0 to -1.\r\n  lowp vec2 normal \x3d mod(a_pos, 2.0);\r\n  normal.y \x3d normal.y \x3d\x3d 0.0 ? -1.0 : 1.0;\r\n  v_normal \x3d normal;\r\n\r\n  // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n  // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  lowp vec2 dist \x3d u_lineHalfWidth * a_offset * scale;\r\n\r\n  // transform the vertex\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(floor(a_pos * 0.5), 0.0, 1.0) + u_extrudeMatrix * vec4(dist, 0.0, 0.0);\r\n\r\n  // the accumulated distance will be used to calculate the dashes (or the no-data...)\r\n  v_accumulatedDistance \x3d a_accumulatedDistance;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineShader.fs.glsl":"/* The implementation of the renderer is based on the article and implementation of MB described here:\r\n* https://www.mapbox.com/blog/drawing-antialiased-lines/\r\n*/\r\n\r\nuniform mediump float u_lineHalfWidth;\r\nuniform lowp vec4 u_color;\r\nuniform mediump vec2 u_dasharray;\r\nuniform lowp float u_blur;\r\n\r\nvarying mediump vec2 v_normal;\r\nvarying highp float v_accumulatedDistance;\r\n\r\nvoid main()\r\n{\r\n  // dist represent the distance of the fragment from the line. 1.0 or -1.0 will be the values on the edge of the line,\r\n  // and any value in between will be inside the line (the sign represent the direction - right or left).\r\n  // since u_linewidth.s (half line width) is represented in pixels, dist is also given in pixels\r\n  mediump float fragDist \x3d length(v_normal) * u_lineHalfWidth;\r\n\r\n  // calculate the alpha given the difference between the line-width and the distance of the fragment from the center-line.\r\n  // We need to count for both sides of the line.\r\n  lowp float alpha \x3d clamp( min(fragDist + u_blur + 1.0, u_lineHalfWidth - fragDist) / u_blur, 0.0, 1.0);\r\n\r\n  // now calculate the dashes given the accumulated distance of the line:\r\n  // start with calculating a normalized position along the line\r\n  lowp float dashPos \x3d  mod(v_accumulatedDistance, u_dasharray.x + u_dasharray.y);\r\n\r\n  // calculate the contribution to the alpha of the dash part. It is provided by the shortest portion of the position along the dash.\r\n  // we must clamp since the value might be bigger than 1 or smaller than zero (when over a dash).\r\n  //   | \x3c--- pos along the dash part\r\n  // -------_______-------_______\r\n  // when the dashPos is over the 'gap' part of the dash u_dasharray.x - dashPos is negative and therefore the alpha will\r\n  // get clamped to zero.\r\n  // when u_dasharray.x - dashPos is positive, or when dashPos is smaller than 1.0, it gives us a soft edge to each dash part.\r\n  // along the direction of the line.\r\n  lowp float dashAlpha \x3d clamp( min(dashPos, u_dasharray.x - dashPos), 0.0, 1.0);\r\n\r\n  // if we don't have a no-data part to the dash then it is a solid line\r\n  dashAlpha \x3d max(sign(-u_dasharray.y), dashAlpha); //sign(-u_dasharray.y) \x3e 0.0 ? 1.0 : dashAlpha;\r\n  // finally multiply the fragment's alpha by the calculated dash-alpha\r\n  alpha *\x3d dashAlpha;\r\n\r\n  // output the fragment color\r\n  gl_FragColor \x3d vec4(u_color.rgb, alpha * u_color.a);\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinShader.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform highp float u_depth;\r\nuniform highp vec2 u_screen;\r\nuniform mediump float u_size;\r\nuniform mediump float u_pixelRatio;\r\n\r\nvarying mediump vec2 v_vertexPosition;\r\n\r\nvoid main()\r\n{\r\n  gl_PointSize \x3d u_pixelRatio * u_size;\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0);\r\n\r\n  // calculate the vertex position in pixels (we need to add one in order to shift the origin from the center of the viewport)\r\n  v_vertexPosition \x3d (gl_Position.xy + 1.0) * u_screen;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/lineJoinShader.fs.glsl":"uniform lowp vec4 u_color;\r\nuniform mediump float u_lineHalfWidth;\r\nuniform mediump float u_oneOverPixelRatio;\r\n\r\nvarying mediump vec2 v_vertexPosition;\r\n\r\nvoid main()\r\n{\r\n  // get the distance of the current fragment from the actual vertex\r\n  mediump float fragDist \x3d length(v_vertexPosition - u_oneOverPixelRatio * gl_FragCoord.xy);\r\n\r\n  // rounding the quare: calculate the alpha given the difference between the line-width and the distance of the fragment\r\n  // from the center-line. We will end up with a nice round circle with a soft edge.\r\n  lowp float alpha \x3d clamp(u_lineHalfWidth - fragDist, 0.0, 1.0);\r\n\r\n  // finally output the fragment color\r\n  gl_FragColor \x3d vec4(u_color.rgb, alpha * u_color.a);\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/solidFillShader.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\n\r\nvoid main()\r\n{\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0, 1.0);\r\n}\r\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/solidFillShader.fs.glsl":"uniform lowp vec4 u_color;\r\nvoid main()\r\n{\r\n  gl_FragColor \x3d u_color;\r\n}",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/fillOutlineShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_offset;\r\nattribute vec2 a_xnormal;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform highp mat4 u_extrudeMatrix;\r\nuniform highp vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump float u_outline_width;\r\n\r\nvarying lowp vec2 v_normal;\r\n\r\nconst float scale \x3d 1.0 / 15.0;\r\n\r\nvoid main()\r\n{\r\n  v_normal \x3d a_xnormal;\r\n\r\n   // calculate the relative distance from the centerline to the edge of the line. Since offset is given in integers (for the\r\n    // sake of using less attribute memory, we need to scale it back to the original range of ~ 0: 1)\r\n  mediump vec4 dist \x3d vec4(u_outline_width * a_offset * scale, 0.0, 0.0);\r\n\r\n  // Remove the texture normal bit of the position before scaling it with the\r\n  // model/view matrix. Add the extrusion vector *after* the model/view matrix\r\n  // because we're extruding the line in pixel space, regardless of the current\r\n  // tile's zoom level.\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * dist;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/fillOutlineShader.fs.glsl":"uniform lowp vec4 u_color;\r\nvarying mediump vec2 v_normal;\r\n\r\nvoid main()\r\n{\r\n  // Calculate the distance of the pixel from the line in pixels.\r\n  lowp float dist \x3d abs(v_normal.y);\r\n\r\n  lowp float alpha \x3d smoothstep(1.0, 0.0, dist);\r\n  gl_FragColor \x3d vec4(u_color.rgb, u_color.a * alpha);\r\n}\r\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/iconShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_vertexOffset;\r\nattribute vec4 a_tex;\r\nattribute vec4 a_levelInfo;\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the size of the mosaic given in pixels\r\nuniform vec2 u_mosaicSize;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the map's rotation from the north\r\nuniform mediump float u_mapRotation;\r\nuniform mediump float u_level;\r\n// indicate whether the current set of iconst should be kept upright when the map is rotated\r\nuniform lowp float u_keepUpright;\r\n// the rate of the change in the opacity (fade) of the icons\r\nuniform mediump float u_fadeSpeed;\r\n// the low level we transition (to/from)\r\nuniform mediump float u_minfadeLevel;\r\n// the high level we transition (to/from)\r\nuniform mediump float u_maxfadeLevel;\r\n// the amount of fade given teh current time past the last recorded level\r\nuniform mediump float u_fadeChange;\r\n// the opacity of the layer given by the painter\r\nuniform mediump float u_opacity;\r\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\nvarying lowp vec2 v_tex;\r\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n// opacity of the layer given by the painter\r\nvarying lowp float v_transparency;\r\n\r\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n// by 16 and then at the shader devide by the same number\r\nconst float offsetPrecision \x3d 1.0 / 32.0;\r\n\r\nvoid main()\r\n{\r\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\r\n  mediump float a_angle        \x3d a_levelInfo[1];\r\n  mediump float a_minLevel    \x3d a_levelInfo[2];\r\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\r\n\r\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\r\n  mediump float delta_z \x3d 0.0;\r\n\r\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\r\n  delta_z +\x3d (1.0 - step(u_keepUpright,0.0)) * step(65.0,rotated) * (1.0 - step(193.0,rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\r\n\r\n  // u_level is the current service level adjusted for the change in font size\r\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\r\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\r\n\r\n  // calculate the alpha given the change in the fade and the fade-speed\r\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\r\n\r\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\r\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\r\n\r\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\r\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 0.0;\r\n  }\r\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 1.0;\r\n  }\r\n\r\n  // if label had been faded out, clip it\r\n  delta_z +\x3d step(v_transparency, 0.0);\r\n\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\r\n  v_tex \x3d a_tex.xy / u_mosaicSize;\r\n\r\n  v_transparency *\x3d u_opacity;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/iconShader.fs.glsl":"uniform lowp sampler2D u_texture;\r\nvarying lowp vec2 v_tex;\r\nvarying lowp float v_transparency;\r\n\r\nvoid main()\r\n{\r\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n  gl_FragColor \x3d vec4(color.rgb, v_transparency * color.a);\r\n}\r\n","url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/sdfShader.vs.glsl":"attribute vec2 a_pos;\r\nattribute vec2 a_vertexOffset;\r\nattribute vec4 a_tex;\r\nattribute vec4 a_levelInfo;\r\n\r\n// attribute bool a_visible; // --\x3e a one bit controlling the visibility of the vertex\r\n\r\n// the relative transformation of a vertex given in tile coordinates to a relative normalized coordinate\r\n// relative to the tile's upper left corner\r\n// the extrusion vector.\r\nuniform highp mat4 u_transformMatrix;\r\n// the extrude matrix which is responsible for the 'anti-zoom' as well as the rotation\r\nuniform highp mat4 u_extrudeMatrix;\r\n// u_normalized_origin is the tile's upper left corner given in normalized coordinates\r\nuniform highp vec2 u_normalized_origin;\r\n// the size of the mosaic given in pixels\r\nuniform vec2 u_mosaicSize;\r\n// the z of the layer. Given by the order of the layers in the style\r\nuniform mediump float u_depth;\r\n// the map's rotation from the north\r\nuniform mediump float u_mapRotation;\r\nuniform mediump float u_level;\r\n// indicate whether the current set of iconst should be kept upright when the map is rotated\r\nuniform lowp float u_keepUpright;\r\n// the rate of the change in the opacity (fade) of the icons\r\nuniform mediump float u_fadeSpeed;\r\n// the low level we transition (to/from)\r\nuniform mediump float u_minfadeLevel;\r\n// the high level we transition (to/from)\r\nuniform mediump float u_maxfadeLevel;\r\n// the amount of fade given teh current time past the last recorded level\r\nuniform mediump float u_fadeChange;\r\n// the opacity of the layer given by the painter\r\nuniform mediump float u_opacity;\r\n// the interpolated texture coordinate value to be used by the fragment shader in order to sample the sprite texture\r\nvarying lowp vec2 v_tex;\r\n// the calculated transparency to be applied by the fragment shader. It is incorporating both the fade as well as the\r\n// opacity of the layer given by the painter\r\nvarying lowp float v_transparency;\r\n\r\n// the vertex offsets are given in integers, therefore in order to maintain a reasonable precission we multiply the values\r\n// by 16 and then at the shader devide by the same number\r\nconst float offsetPrecision \x3d 1.0 / 32.0;\r\n\r\nvoid main()\r\n{\r\n  mediump float a_labelMinLevel \x3d a_levelInfo[0];\r\n  mediump float a_angle        \x3d a_levelInfo[1];\r\n  mediump float a_minLevel    \x3d a_levelInfo[2];\r\n  mediump float a_maxLevel    \x3d a_levelInfo[3];\r\n\r\n  // if the given vertex should not be visible simply clip it by adding it a value that will push it outside the clipping plane\r\n  mediump float delta_z \x3d 0.0;\r\n\r\n  // TODO: force clipping the vertex in case that the vertex isn't visible\r\n  //delta_z +\x3d a_visible ? 0.0 : 1.0;\r\n\r\n  // If the label rotates with the map, and if the rotated label is upside down, hide it\r\n  mediump float rotated \x3d mod(a_angle - u_mapRotation, 256.0);\r\n  delta_z +\x3d (1.0 - step(u_keepUpright, 0.0)) * step(65.0, rotated) * (1.0 - step(193.0, rotated)); //ie. z +\x3d (flip \x3e 0) \x26\x26 (65 \x3c\x3d rotated) \x26\x26 (rotated \x3c 193)\r\n\r\n  // u_level is the current service level adjusted for the change in font size\r\n  delta_z +\x3d 1.0 - step(a_minLevel, u_level); // Test if (level \x3c minLevel)\r\n  delta_z +\x3d step(a_maxLevel, u_level); // Test if (maxLevel \x3c\x3d level)\r\n\r\n  // calculate the alpha given the change in the fade and the fade-speed\r\n  lowp float alpha \x3d clamp((u_fadeChange - a_labelMinLevel) / u_fadeSpeed, 0.0, 1.0);\r\n\r\n  // if the speed is positive we are zooming in and therefore we need to 'fade-in'. Else we need to 'fade-out'\r\n  v_transparency \x3d (u_fadeSpeed \x3e\x3d 0.0 ? alpha : 1.0 - alpha);\r\n\r\n  // now deal with the min/max fade-levels. If we exceeded the level we simply snap to 0 or 1\r\n  if (u_maxfadeLevel \x3c a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 0.0;\r\n  }\r\n  if (u_minfadeLevel \x3e\x3d a_labelMinLevel)\r\n  {\r\n      v_transparency \x3d 1.0;\r\n  }\r\n\r\n  // if label has been faded out, clip it\r\n  delta_z +\x3d step(v_transparency, 0.0);\r\n\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(a_pos, 0.0, 1.0) + u_extrudeMatrix * vec4(offsetPrecision * a_vertexOffset, delta_z, 0.0);\r\n  v_tex \x3d a_tex.xy / u_mosaicSize;\r\n\r\n  v_transparency *\x3d u_opacity;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/sdfShader.fs.glsl":"uniform lowp sampler2D u_texture;\r\nuniform lowp vec4 u_color;\r\nuniform mediump float u_edgeDistance;\r\nuniform mediump float u_edgeWidth;\r\n\r\nvarying lowp vec2 v_tex;\r\nvarying lowp float v_transparency;\r\n\r\n// this is taken from http://www.valvesoftware.com/publications/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\r\n// and https://www.mapbox.com/blog/text-signed-distance-fields/\r\n// http://metalbyexample.com/rendering-text-in-metal-with-signed-distance-fields/\r\n\r\nvoid main()\r\n{\r\n  // read the distance from the SDF texture\r\n  lowp float dist \x3d texture2D(u_texture, v_tex).a;\r\n  // use a smooth-step in order to calculate the geometry of the shape given by the distance field\r\n  mediump float alpha \x3d smoothstep(u_edgeDistance - u_edgeWidth, u_edgeDistance + u_edgeWidth, dist) * v_transparency;\r\n\r\n  gl_FragColor \x3d vec4(u_color.rgb, alpha* u_color.a);\r\n\r\n// YF: this code allow having both a fill and an outline colors combined in a single pass\r\n//  lowp float geometryAlpha \x3d smoothstep(0.75 - 0.21, 0.75 + 0.21, dist) * v_transparency;\r\n//  lowp vec4 geometryColor \x3d vec4(u_color.rgb, geometryAlpha * u_color.a);\r\n//\r\n//  if (true) {\r\n//    lowp float haloAlpha \x3d smoothstep(0.0 - 0.1, 0.0 + 0.1, dist) * v_transparency;\r\n//    lowp vec4 haloColor \x3d vec4(1.0, 1.0, 1.0, 1.0);\r\n//    haloColor \x3d vec4(haloColor.rgb, haloAlpha);\r\n//\r\n//    // calculate the composite color\r\n//    lowp float compositeAlpha \x3d geometryColor.a + haloColor.a * (1.0 - geometryColor.a);\r\n//    lowp vec3 compositeColor \x3d vec3(geometryColor) * geometryColor.a + vec3(haloColor) * haloColor.a * (1.0 - geometryColor.a);\r\n//    compositeColor /\x3d compositeAlpha;\r\n//    gl_FragColor \x3d vec4(compositeColor, compositeAlpha);\r\n//  }\r\n//  else {\r\n//    gl_FragColor \x3d geometryColor;\r\n//  }\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/tileInfo.vs.glsl":"attribute vec2 a_pos;\r\n\r\nuniform highp mat4 u_transformMatrix;\r\nuniform mediump vec2 u_normalized_origin;\r\nuniform mediump float u_depth;\r\nuniform mediump float u_coord_ratio;\r\nuniform mediump vec2 u_delta; // in tile coordinates\r\nuniform mediump vec2 u_dimensions; // in tile coordinates\r\n\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main() {\r\n  mediump vec2 offests \x3d u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\r\n  gl_Position \x3d vec4(u_normalized_origin, u_depth, 0.0) + u_transformMatrix * vec4(offests, 0.0, 1.0);\r\n\r\n  v_tex \x3d a_pos;\r\n}\r\n",
"url:esri/layers/vectorTiles/views/vectorTiles/renderers/shaders/tileInfo.fs.glsl":"uniform mediump sampler2D u_texture;\r\nvarying mediump vec2 v_tex;\r\n\r\nvoid main(void) {\r\n  lowp vec4 color \x3d texture2D(u_texture, v_tex);\r\n  gl_FragColor \x3d vec4(color.rgb, color.a * 0.75);\r\n}\r\n","*noref":1}});
define("esri/layers/VectorTileLayerImpl","dojo/_base/lang dojo/has dojo/dom-construct dojo/dom-style dojo/io-query ../geometry/Extent ../geometry/screenUtils ../geometry/scaleUtils ../SpatialReference ../config ../lang ../domUtils ../urlUtils ../kernel ./layer ./TileInfo ./unitBezier ./vectorTiles/request ./vectorTiles/core/promiseUtils ./vectorTiles/core/urlUtils ./vectorTiles/layers/support/vectorTileLayerLoader ./vectorTiles/views/vectorTiles/style/StyleRepository ./vectorTiles/views/vectorTiles/VectorTileContainer ./vectorTiles/views/vectorTiles/TileHandler ./vectorTiles/views/2d/engine/StageGL ./vectorTiles/views/2d/FrameBudget ./vectorTiles/views/2d/layers/support/TileInfoView ./vectorTiles/views/2d/layers/support/TileStrategy ./vectorTiles/views/2d/layers/support/TileKey ./vectorTiles/views/webgl/webgl-utils".split(" "),function(l,
f,a,b,c,d,e,g,h,m,k,n,p,x,q,r,s,t,u,w,v,y,A,z,B,G,D,E,C,K){var J=s.ease;e=q.createSubclass({declaredClass:"esri.layers.VectorTileLayer",_mapsWithAttribution:["World_Basemap"],_eventMap:{"style-change":["style"]},constructor:function(a,b){this._frame=this._frame.bind(this);this._params=b||{};b&&(b.tileServers&&b.tileServers.length)&&(this.tileServers=b.tileServers=b.tileServers.map(function(a){return p.getAbsoluteUrl(a)},this));this._viewState={scale:0,width:0,height:0,rotation:0,resolution:1,center:[0,
0],toScreen:function(a,b){var c=this.center[1]+0.5*this.resolution*this.height;a[0]=(b[0]-(this.center[0]-0.5*this.resolution*this.width))/this.resolution;a[1]=(c-b[1])/this.resolution;return a},toMap:function(a,b){var c=this.center[1]+0.5*this.resolution*this.height;a[0]=this.center[0]-0.5*this.resolution*this.width+b[0]*this.resolution;a[1]=c-b[1]*this.resolution;return a}};this._budget=new G(6);this._renderParameters={budget:this._budget,state:this._viewState,devicePixelRatio:window.devicePixelRatio,
stationary:!0};this._updateParameters={budget:this._budget,state:this._viewState,devicePixelRatio:window.devicePixelRatio,stationary:!0};this.setStyle(a);this.registerConnectEvents()},setStyle:function(a){return this.loadStyle(a)},getStyle:function(){return this.currentStyleInfo&&this.currentStyleInfo.style||null},opacity:1,setOpacity:function(a){if(this.opacity!=a)this.onOpacityChange(this.opacity=a)},onOpacityChange:function(){},_pinching:!1,_refreshTS:null,_reCheckTS:/[\?\&]_ts=/ig,_reReplaceTS:/([\?\&]_ts=)[0-9]+/ig,
addTimestampToURL:function(a){var b=this._refreshTS;b&&(a=this._reCheckTS.test(a)?a.replace(this._reReplaceTS,"$$$1"+b):a+((-1===a.indexOf("?")?"?":"\x26")+"_ts\x3d"+b));return a},getTileUrl:function(a,b,d){var e=this._getToken(),f=this._url.query,g=this.tileServers[b%this.tileServers.length],g=g.replace(/\{z\}/gi,a.toString()).replace(/\{level\}/gi,a.toString()).replace(/\{y\}/gi,b.toString()).replace(/\{row\}/gi,b.toString()).replace(/\{x\}/gi,d.toString()).replace(/\{col\}/gi,d.toString());f&&
(g+="?"+c.objectToQuery(f));if(e&&(!f||!f.token))g+=(-1===g.indexOf("?")?"?":"\x26")+"token\x3d"+e;g=this.addTimestampToURL(g);return p.addProxy(g)},loadStyle:function(a){if(this._loadingPromise&&"string"===typeof a&&this.url===a)return this._loadingPromise;this._stopDisplay();var b=this._loadingPromise;this._loadingPromise=v.loadMetadata(a).then(function(a){this.url=a.url;this._url=a.parsedUrl;this.currentStyleInfo={serviceUrl:a.serviceUrl,styleUrl:a.styleUrl,style:a.style,layerDefinition:a.layerDefinition};
this.styleRepository=new y(a.style,a.styleUrl);this._read(a.layerDefinition);this.onStyleChange(this.getStyle())}.bind(this)).then(function(){this.loaded||(this.loaded=!0,this.onLoad(this));!this.suspended&&!this._tileHandler&&this._startDisplay()}.bind(this)).otherwise(function(a){this._errorHandler(a);throw a;}.bind(this));b&&!b.isFulfilled()&&b.cancel();return this._loadingPromise},refresh:function(){this.suspended||(this._refreshTS=Date.now(),this._onExtentChangeHandler(this._map.extent,null,
!0,this._map.__LOD))},_setMap:function(c,d,e){this.inherited(arguments);this._map=c;var f=this._div=a.create("div",null,d);b.set(f,{position:"absolute",width:c.width+"px",height:c.height+"px",overflow:"visible",opacity:this.opacity});this._onResizeHandle=c.on("resize",l.hitch(this,this._onResizeHandler));this._onOpacityHandle=this.on("opacity-change",l.hitch(this,this._opacityChangeHandler));this._onScaleVisHandle=this.on("scale-visibility-change",l.hitch(this,function(){}));this._onVisibilityHandle=
this.on("visibility-change",l.hitch(this,function(){}));this._stageGL=new B;this._div.appendChild(this._stageGL.createElement());this._stageGL.parent={requestChildRender:this._scheduleRender.bind(this)};this._stageGL.attach(this._renderParameters);this._startDisplay();this.evaluateSuspension();if(this.suspended&&!c.loaded)var g=c.on("load",l.hitch(this,function(){g.remove();this.evaluateSuspension()}));return f},_unsetMap:function(b,c){this._map=null;this.suspended||this._stopDisplay();this._stageGL.detach(this._renderParameters);
this._stageGL=null;a.destroy(this._div);this._div=null;this._handles&&this._handles.forEach(function(a){a.remove()});this._handles=null;this._onResizeHandle=this._onResizeHandle&&this._onResizeHandle.remove()&&null;this._onOpacityHandle=this._onOpacityHandle&&this._onOpacityHandle.remove()&&null;this._onScaleVisHandle=this._onScaleVisHandle&&this._onScaleVisHandle.remove()&&null;this._onVisibilityHandle=this._onVisibilityHandle&&this._onVisibilityHandle.remove()&&null;this.inherited(arguments)},_read:function(a){this.version=
a.currentVersion||a.version;this.fullExtent=new d(a.fullExtent);this.initialExtent=new d(a.initialExtent);this.spatialReference=this.fullExtent.spatialReference;this.tileInfo=new r(a.tileInfo);this.tileInfo.size=[this.tileInfo.cols,this.tileInfo.height];this.tileInfo.spatialReference.isWrappable=this.tileInfo.spatialReference._isWrappable();this.tileInfo.scales=this.tileInfo.lods.map(function(a){return a.scale});this.tileInfo.scaleToZoom=function(a){for(var b=this.scales,c=b.length-1,d=0;d<c;d++){var e=
b[d],f=b[d+1];if(e<=a)break;if(f===a)return d+1;if(e>a&&f<a)return d+1-(a-f)/(e-f)}return d};this._hasMin||this.setMinScale(a.minScale);this._hasMax||this.setMaxScale(a.maxScale);a.tileMap&&(this.tileIndexUrl=w.join(this.currentStyleInfo.serviceUrl,a.tileMap));this._params.tileServers||(this.tileServers=a.tiles.map(function(a,b,c){return w.join(this.currentStyleInfo.serviceUrl,a)},this));a=null;this.currentStyleInfo.serviceUrl&&(a=w.urlToObject(this.currentStyleInfo.serviceUrl),a=this._getDefaultAttribution(a.path));
a?(this.attributionDataUrl=a,this.hasAttributionData=!0):(this.attributionDataUrl=null,this.hasAttributionData=!1)},_getDefaultAttribution:function(a){var b=a.match(/^https?:\/\/(basemaps|basemapsbeta)\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i);if(b&&(a=b[3])){var b=b[2]||"",c;a=a.toLowerCase();for(var d=0,e=this._mapsWithAttribution.length;d<e;d++)if(c=this._mapsWithAttribution[d],-1<c.toLowerCase().indexOf(a))return a=window.location.protocol,("http:"===
a||"https:"===a?a:"https:")+"//static.arcgis.com/attribution/Vector"+b+"/"+c}},_startDisplay:function(){var a={styleRepository:this.styleRepository,tileIndexUrl:this.tileIndexUrl,tileInfo:this.tileInfo,fullExtent:{width:this.fullExtent.getWidth()},getTileUrl:this.getTileUrl.bind(this)};this._renderParameters.devicePixelRatio=this._updateParameters.devicePixelRatio=window.devicePixelRatio;this._vectorTileContainer=new A;this._stageGL.addChild(this._vectorTileContainer);this._tileHandler=new z(a,this._scheduleUpdate.bind(this));
this._tileInfoView=new D(this.tileInfo,this.fullExtent);this._tileStrategy=new E(this._vectorTileContainer,this._tileInfoView,this._scheduleUpdate.bind(this),function(a,b){return this._tileHandler.getVectorTile(C.fromId(a),b)}.bind(this));this._tileHandler.updateTile.bind(this._tileHandler);this._tileHandler.start().then(function(){this._vectorTileContainer.initialize(this._tileHandler.spriteMosaic,this._tileHandler.glyphMosaic,this.tileInfo,this._tileInfoView);this._scheduleUpdate()}.bind(this))},
_stopDisplay:function(){this._tileStrategy&&(this._frameRequested=this._updateRequested=this._renderRequested=!1,this._animation&&(this._animation.stop(),this._animation=null),this._vectorTileContainer.removeAllChildren(),this._stageGL.removeChild(this._vectorTileContainer),this._vectorTileContainer=null,this._tileHandler.stop(),this._tileHandler.destroy(),this._tileStrategy.destroy(),this._tileInfoView=this._tileHandler=this._tileStrategy=null)},_scheduleRender:function(){this._map&&(this._renderRequested=
!0,this._scheduleFrame())},_scheduleUpdate:function(){this._map&&(this._updateRequested=!0,this._scheduleFrame())},_scheduleFrame:function(){this._map&&!this._frameRequested&&(this._frameRequested=!0,I(this._frame))},_frame:function(){if(this._frameRequested){this._frameRequested=!1;this._renderParameters.devicePixelRatio!==window.devicePixelRatio&&(this._renderParameters.devicePixelRatio=this._updateParameters.devicePixelRatio=window.devicePixelRatio,this._stopDisplay(),this._startDisplay());this._animation&&
(this._animation.step(),this._animation.running||(this._animation=null));this._updateParameters.stationary=this._renderParameters.stationary=!this._animation&&!this._pinching&&!this._panning;this._budget.reset();this._viewState.resolution=this._viewState.scale/(96*39.37*g.getUnitValueForSR(this.spatialReference));this._renderRequested&&(this._renderRequested=!1,this._stageGL.render(this._renderParameters));if(this._updateRequested){this._updateRequested=!1;var a=this._tileHandler.updateTile.bind(this._tileHandler);
this._tileStrategy.updateTiles(a,this._updateParameters);this._tileStrategy.update(this._updateParameters)}this._animation&&(this._scheduleRender(),this._scheduleUpdate())}},_setViewState:function(a){a=l.mixin(this._viewState,a);a.center.type&&(a.center=[a.center.x,a.center.y]);this._scheduleRender();this._scheduleUpdate()},_animateViewState:function(a,b){var c=b.immediate||0===m.defaults.map.zoomDuration;this._animation=null;if(c)this._setViewState(a);else{var c=this._viewState,d=m.defaults.map.zoomDuration,
e=H()+16,f=c.center[0],g=c.center[1],h=c.scale,k=Array.isArray(a.center)?a.center[0]:a.center.x,l=Array.isArray(a.center)?a.center[1]:a.center.y,n=a.scale||c.scale,p=this;this._animation={running:!0,stop:function(){this.running=!1},step:function(){if(this.running){var a=(H()+16-e)/d;1<=a&&(a=1,this.running=!1);a=J(a);p._setViewState({center:[f+(k-f)*a,g+(l-g)*a],scale:h+(n-h)*a})}}};this._scheduleRender();this._scheduleUpdate()}},onStyleChange:function(a){},_opacityChangeHandler:function(a){this._div&&
(this._div.style.opacity=a.opacity)},_onResizeHandler:function(a){var b=this._div&&this._div.style;b&&(b.width=a.width+"px",b.height=a.height+"px",this._setViewState({center:a.extent.getCenter(),width:a.width,height:a.height}))},onResume:function(){var a=this._map;this.inherited(arguments);n.show(this._div);this._setViewState({center:a.extent.getCenter(),scale:a.getScale(),width:a.width,height:a.height});this._handles=[a.on("pan-end",l.hitch(this,function(){this._panning=!1})),a.on("pan",l.hitch(this,
this._onPanExtentChangeHandler)),a.on("extent-change",l.hitch(this,this._onExtentChangeHandler)),a.on("scale",l.hitch(this,this._onScaleHandler))]},onSuspend:function(){this.inherited(arguments);n.hide(this._div);this._handles.forEach(function(a){a.remove()});this._handles=null},_onPanExtentChangeHandler:function(a){this._panning=!0;this._animation&&(this._animation.stop(),this._animation=null);this._setViewState({center:a.extent.getCenter(),scale:this._map.getScale()})},_onExtentChangeHandler:function(a){var b=
this._pinching||a.immediate;this._animateViewState({center:a.extent.getCenter(),scale:a.lod.scale},{immediate:b});this._pinching=!1},_onScaleHandler:function(a){this._animation&&(this._animation.stop(),this._animation=null);var b=this._map;if(b._zoomAnimDiv.extent)this._pinching=this._panning=!1,this._animateViewState({center:b._zoomAnimDiv.extent.getCenter(),scale:b._zoomAnimDiv.newLod.scale},{immediate:a.immediate});else{var c=b.navigationManager,d=c._dragOrigin;a=b.extent.getCenter();var e=d.x-
0.5*b.width,d=d.y-0.5*b.height,f=b.extent.getWidth()/b.width,g;c._pinchScale?(this._pinching=!0,c=c._pinchScale,g=f/c,a.x-=e*(g-f),a.y+=d*(g-f),b=b.__LOD.scale/c,this._setViewState({center:a,scale:b})):c._zoomEndExtent&&(this._pinching=!1,c=b.getScale()/b.navigationManager._zoomEndLod.scale,g=f/c,a.x-=e*(g-f),a.y+=d*(g-f),b=b.navigationManager._zoomEndLod.scale,this._animateViewState({center:a,scale:b},{immediate:!1}))}}});e.ACCESS_TOKEN=null;e.supported=function(){return K.detectWebGL()[0]};var H=
function(){var a,b=window.performance||{},c=b.now||b.webkitNow||b.msNow||b.oNow||b.mozNow;if(void 0!==c)return function(){return c.call(b)};a=window.performance&&window.performance.timing&&window.performance.timing.navigationStart?window.performance.timing.navigationStart:(new Date).getTime();return function(){return(new Date).getTime()-a}}();h=f("ff");k=f("ie");x=f("webkit");f=f("opera");var F=(new Date).getTime(),I=window.requestAnimationFrame;I||(I=window[(x&&"webkit"||h&&"moz"||f&&"o"||k&&"ms")+
"RequestAnimationFrame"])||(I=function(a){var b=H(),c=Math.max(0,16-(b-F)),d=window.setTimeout(function(){a(H())},c);F=b+c;return d});return e});